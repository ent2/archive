!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/builds/",r(r.s=1356)}({1086:function(e,t){var r=r||function(){var e={fadeSpeed:100,filter:function(e){},above:"auto",preventDoubleContext:!0,compress:!1};return{init:function(t){e=$.extend({},e,t),$(document).on("click","html",(function(){$(".dropdown-context").hide()})),e.preventDoubleContext&&$(document).on("contextmenu",".dropdown-context",(function(e){e.preventDefault()})),$(document).on("mouseenter",".dropdown-submenu",(function(){var e=$(this).find(".dropdown-context-sub:first");e.width()+e.offset().left>window.innerWidth&&e.addClass("drop-left")}))},settings:function(t){e=$.extend({},e,t)},attach:function(t,r){var n=(new Date).getTime(),o=function t(r,n,o){for(var a=o?" dropdown-context-sub":"",i=e.compress?" compressed-context":"",s=$('<ul class="dropdown-menu dropdown-context'+a+i+'" id="dropdown-'+n+'"></ul>'),c=0,u="";c<r.length;c++){if(void 0!==r[c].divider)s.append('<li class="divider"></li>');else if(void 0!==r[c].header)s.append('<li class="nav-header">'+r[c].header+"</li>");else{if(void 0===r[c].href&&(r[c].href="#"),void 0!==r[c].target&&(u=' target="'+r[c].target+'"'),void 0!==r[c].subMenu?$sub='<li class="dropdown-submenu"><a tabindex="-1" >'+r[c].text+"</a></li>":$sub=$('<li><a tabindex="-1" '+u+">"+r[c].text+"</a></li>"),void 0!==r[c].action){var p="event-"+(new Date).getTime()*Math.floor(1e5*Math.random()),l=r[c].action;$sub.find("a").attr("id",p),$("#"+p).addClass("context-event"),$sub.click(l)}if(s.append($sub),void 0!==r[c].subMenu){var d=t(r[c].subMenu,n,!0);s.find("li:last").append(d)}}"function"==typeof e.filter&&e.filter(s.find("li:last"))}return s}(r,n);$("body").append(o),$(document).on("contextmenu",t,(function(t){if(t.preventDefault(),t.stopPropagation(),$(".dropdown-context:not(.dropdown-context-sub)").hide(),$dd=$("#dropdown-"+n),"boolean"==typeof e.above&&e.above)$dd.addClass("dropdown-context-up").css({top:t.pageY-20-$("#dropdown-"+n).height(),left:t.pageX-13}).fadeIn(e.fadeSpeed);else if("string"==typeof e.above&&"auto"==e.above){$dd.removeClass("dropdown-context-up");var r=$dd.height()+12;t.pageY+r>$("html").height()?$dd.addClass("dropdown-context-up").css({top:t.pageY-20-r,left:t.pageX-13}).fadeIn(e.fadeSpeed):$dd.css({top:t.pageY+10,left:t.pageX-13}).fadeIn(e.fadeSpeed)}}))},destroy:function(e){$(document).off("contextmenu",e).off("click",".context-event")}}}()},1087:function(e,t){Entry.Language={},Entry.Language.MOVING="움직임",Entry.Language.LOOKS="생김새",Entry.Language.BRUSH="붓",Entry.Language.TEXT="글상자",Entry.Language.SOUND="소리",Entry.Language.START="시작",Entry.Language.FLOW="흐름",Entry.Language.JUDGEMENT="판단",Entry.Language.CALC="계산",Entry.Language.VARIABLE="변수",Entry.Language.SCENE="장면",Entry.Language.ARDUINO="아두이노",Entry.Language.PROJECTDEFAULTNAME=["멋진","재밌는","착한","큰","대단한","잘생긴","행운의"],Entry.Language.ko="한국어",Entry.Language.en="영어",Entry.Language.vn="베트남어",Entry.Blocks={},Entry.Blocks.when_run_button_click="실행하기 버튼을 클릭했을 때",Entry.Blocks.press_some_key_1="",Entry.Blocks.press_some_key_2="키를 눌렀을 때",Entry.Blocks.press_some_key_up="위 화살표",Entry.Blocks.press_some_key_down="아래 화살표",Entry.Blocks.press_some_key_left="왼쪽 화살표",Entry.Blocks.press_some_key_right="오른쪽 화살표",Entry.Blocks.press_some_key_enter="엔터",Entry.Blocks.press_some_key_space="스페이스",Entry.Blocks.mouse_clicked="마우스를 클릭했을 때",Entry.Blocks.mouse_click_cancled="마우스 클릭을 해제했을 때"},1088:function(e,t,r){"use strict";r.r(t);var n=r(6),o=r.n(n);function a(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}angular.module("mean.arts.all").controller("ArtsHomeController",["$scope","$routeParams","$location","$uibModal","$log","$http","Global","Projects","myProject","$timeout","$cookies",function(e,t,n,i,s,c,u,p,l,d,g){function f(t){e.isSearching=!1;var r=e.currentGroup&&e.currentGroup._id;r&&(t.data||[]).forEach((function(e){function t(t,n){e[n]=0,(t||[]).forEach((function(t){(t&&t.group)==r&&(e[n]=t.count)}))}t(e.commentGroup,"currentCommentGroup"),t(e.likeCntGroup,"currentLikeCntGroup"),t(e.visitGroup,"currentVisitGroup")})),e.projectCount=Number(t.count);var o=12*(e.currentPage-1)-Number(t.skip),a=o+12;e.projectList=t.data.filter((function(e,t){return t>=o&&t<a})),n.search(m())}e.global=u,e.isTeacher=u.isTeacher(),e.isMember=u.isMember(),e.isStudent=u.isStudent(),e.title=Lang.Menus.gnb_share+" > "+Lang.Menus.group_project_share,e.user=u.user,e.searchWord="",e.users=[],e.categoryOptions=EntryStatic.categoryProjectOption,e.sortOptions=EntryStatic.searchProjectOption,e.periodOptions=EntryStatic.artPeriodOptions,e.analysisMode=!0,e.isSearching=!1,e.headerMode=n.url().indexOf("groupId")>0?"group":"personal",e.groupListLen=0,e.projectCount=!1,e.status={isGroupListOpen:!1,isCategoryOpen:!1,isSortOpen:!1},e.shareGuide=!0,e.updateUsers=function(t){var r=$("#projectSearchInput").val();r&&r.length>2?c.get("/api/users/find/"+r).success((function(t,r){e.users=t;var n=$(".dropdown-autocomplete"),o=416,a=e.users.length;n.css("overflow","auto"),a<10&&(o=41*a+6,n.css("overflow","hidden")),n.css("height",o+"px")})).error((function(t,r){e.users=[]})):(e.users=[],r||e.search())},e.setprojectAnalysys=function(e){return e?"yes":"no"},e.getOption=function(t){return _.find(e.conditions,{name:t})},e.conditions=[{name:"sort",value:"updated"},{name:"period",value:""},{name:"rows",value:12},{name:"page",value:1},{name:"name",value:""},{name:"groupId",value:""},{name:"category",value:"전체"},{name:"role",value:""}],e.groupList=[],e.init=function(){if(c.get("/api/project/count/total").success((function(t){e.total_count=u.formatNumber(t.count)})).error((function(t){e.total_count=0})),"group"!=e.headerMode||window.user){e.cachedResult={},e.currentPage=1;var r=e.global.user;$(document).on("touchend",(function(e){$(e.target).closest(".dropdown").length||$("body").click()}));var o=n.search();if(!$.isEmptyObject(o))for(var a in o){var i=decodeURIComponent(o[a]);e.setOptionForQuery({name:a,value:i}),"name"==a?e.searchWord=i:"page"==a&&(e.currentPage=o[a])}r&&e.setOptionForQuery({name:"role",value:r.role}),r&&r._id?c.get("/api/getGroupList").success((function(o){if(e.hasGroups=o.length,o.length<=0||"/"==n.path())e.currentView="all",e.find();else{e.groupList=o,e.currentView="group",e.groupListCount=o.length;var a=e.groupList.map((function(e){return e._id}));if((t.groupId||r.primaryGroup)&&_.includes(a,r.primaryGroup)){var i=!0,s=0;for(var c in o)o[c]&&t.groupId===o[c]._id&&(i=!1,e.setCurrentGroup(c)),o[c]._id===r.primaryGroup&&(s=c);i&&e.setCurrentGroup(s)}else e.setCurrentGroup(0)}})):e.find()}else window.location.href=window.location.origin+"/all#!/?sort=updated&rows=12&page=1"},e.find=function(t){e.isSearching=!0;var r={};t?e.currentPage=Number(e.getOption("page").value):r=e.cachedResult;var n=12*(e.currentPage-1)+1;if(!r.data||n>r.data.length+r.skip){var i=m(),s="/api/project/find?blamed=false&",u=null,p={Accept:"application/json"};"group"==e.currentView?u=s+"option=list&"+i:(p["x-clous"]=!0,u=s+"isopen=true&option=list&"+i),c({method:"GET",url:u,headers:p}).success(function(){var t=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){a(i,n,o,s,c,"next",e)}function c(e){a(i,n,o,s,c,"throw",e)}s(void 0)}))}}(o.a.mark((function t(r,n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.cachedResult=r,f(e.cachedResult);case 2:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()).error((function(t,n){e.status=n,f(r)}))}else f(r)},e.setOption=function(t,r){var n=e.getOption(t.name);n&&(n.value=t.value),!0===r&&(n=e.getOption("page"))&&(n.value=1),$.each(e.status,(function(t,r){e.status[t]=!1})),e.find(r)},e.setCurrentGroup=function(t){e.currentGroup=e.groupList[t],e.cachedResult={},$("#projectSearchInput").val(""),e.isGroupOwner=u.isGroupOwner(e.currentGroup),e.setOptionForQuery({name:"name",value:""},!0),e.setOption({name:"groupId",value:e.currentGroup._id})},e.setOptionForQuery=function(t){var r=_.find(e.conditions,{name:t.name});r&&(r.value=t.value)};var m=function(){var t=[],r=e.getOption("category").value;return r&&"전체"!==r||t.push("category"),_.reduce(e.conditions,(function(e,r){var n=r.name;if(_.includes(t,n))return e;var o=r.value;return o&&e.push(n+"="+encodeURIComponent(o)),e}),[]).join("&")};function h(t){var r="/api/project/group/add/"+t._id+"/"+e.currentGroup._id;c.post(r,null,{headers:{"csrf-token":u.csrfToken()}}).success((function(t,r){e.find(!0)})).error((function(t,r){e.status=r}))}e.search=_.throttle((function(t){e.searchWord=t||$("#projectSearchInput").val(),e.cachedResult={},e.currentPage=1,e.users=[],e.setOption({name:"name",value:e.searchWord},!0)}),1e3),e.prevPageGroup=function(){var t=Number(e.getOption("page").value);if(t||(t=1),!(t>10))return!1;e.currentPage-=10,e.setOption({name:"page",value:e.currentPage}),$("html,body").animate({scrollTop:$(".allListProjectsList").eq(0).position().top},700)},e.nextPageGroup=function(){var t=Number(e.getOption("page").value);t||(t=1);var r=Math.ceil(e.projectCount/Number(e.getOption("rows").value));if(!(e.pageList[0]+9<r))return!1;e.currentPage+=10,e.setOption({name:"page",value:e.currentPage}),$("html,body").animate({scrollTop:$(".allListProjectsList").eq(0).position().top},700)},e.isLang=function(e){return(g.get("lang")||"ko")===e},e.setPage=function(t){var r=t<e.currentPage;e.conditions[3].value=t,e.currentPage=t,$("html,body").animate({scrollTop:$(".allListProjectsList").eq(0).position().top},700),e.find(r)},e.addExhibition=function(t){var r;null!==e.projectList&&void 0!==e.projectList||(e.projectList=[]),_.find(e.projectList,{_id:t._id})?entrylms.alert("이미 등록된 프로젝트 입니다."):"group"===e.currentView?e.isStudent||e.isGroupOwner?h(t):c.get("/api/student/groupsByUser/"+window.user._id).success((function(r){var n=[];(n=r.map((function(e){return e.group._id}))).length>0&&n.indexOf(e.currentGroup._id)>-1?h(t):entrylms.alert(Lang.Menus.discuss_no_project_permission).on("hide",(function(){window.location.href="/out"}))})):(t.isopen=!0,r="/api/project/openProject/"+t._id,c.put(r,t,{headers:{"csrf-token":u.csrfToken()}}).success((function(t,r){e.find(!0)})).error((function(t,r){e.status=r})))},e.exhibitProjectModal=function(t){i.open({templateUrl:"/views/arts/exhibitModal.html",controller:"ExhibitModalController",resolve:{type:function(){return t}},backdrop:!1,keyboard:!1}).result.then((function(t){t&&t.selectedItem&&e.addExhibition(t.selectedItem)}))},e.makeClass=function(){window.location.href="/"+e.user.username+"#!/group"},e.openLecturesModal=function(){i.open({templateUrl:"/views/arts/exhibitModal.html",controller:"ExhibitModalController",resolve:{type:function(){return"all"}},backdrop:!1,keyboard:!1}).result.then((function(t){t&&t.selectedItem&&e.addProject(t.selectedItem)}))},e.addProject=function(t){"group"===e.currentView&&_.find(e.projectList,{_id:t._id})?entrylms.alert("이미 등록된 프로젝트 입니다."):lectures.forEach((function(t){e.selectedLectures.push(t),e.currentLecture||e.setCurrentLecture(0)}))},e.showShareGuide=function(){var e=r(294);"ko"!=g.get("lang")&&(e=r(295)),e=e.replace(/<\/span>/g,"</span><br/>").replace(/<\/div>/g,"</div><br/>").replace(/style=/g,"styleNone="),entrylms.alertTextarea({outerHTML:e},Lang.SharePolicy.title)}}])},1089:function(e,t,r){"use strict";r.r(t);var n=r(6),o=r.n(n);function a(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}angular.module("mean.arts.list").controller("ArtsListController",["$scope","$route","$routeParams","$location","$uibModal","$q","Global","$http","Projects","$timeout","$cookies",function(e,t,r,n,i,s,c,u,p,l,d){var g="/img/assets/study/curriculum/",f={e_1:g+"e1.png",e_2:g+"e1.png",e_3:g+"e3.png",e_4:g+"e3.png",e_5:g+"e5.png",e_6:g+"e5.png",general:g+"general.png",m_1:g+"m1.png",m_2:g+"m1.png",m_3:g+"m1.png"},m=Lang.Menus,h=["isOwner","user","visitorGroups"],v=["category","sort","period"];function y(t){e.projectList=[],e.dataCount=Number(t.count);var r=Number(t.skip),n=15*(e.currentPage-1)-r,o=n+15;t.data&&t.data.map((function(t,r){r>=n&&r<o&&(t.name=c.htmldecode(t.name),e.projectList.push(t))})),e.generatePageList()}function _(e){if(!e)return f("general");if(1===e.length)return f[e];var t=EntryStatic.lectureGrades;return e.sort((function(e,r){return t.indexOf(e)-t.indexOf(r)})),f[e[e.length-1]]}function b(e){for(var t in e)if(e[t].quiz)return!0;return!1}function w(){var t=[];for(var r in e.condition){var n=e.condition[r];"project"===e.tab&&"category"===r&&(n=Lang.EntryStatic[n])&&(n=n.replace(/ /gi,"")),n&&""!=n&&t.push(r+"="+encodeURIComponent(n))}return t.join("&")}function L(){var t={};for(var r in e.condition){var n=e.condition[r];n&&-1===h.indexOf(r)&&(t[r]=n)}return t}function j(t,r){var n=e.conditionLang;switch(t){case"category":n.category=r?Lang.EntryStatic[r]:Lang.EntryStatic.category_all;break;case"sort":switch(r){case"updated":"project"===e.tab?n.sort=Lang.Menus.search_updated:n.sort=Lang.Menus.latest;break;case"recent":n.sort=Lang.Menus.search_recent;break;case"complexity":n.sort=Lang.Menus.search_complexity;break;case"staffPicked":n.sort=Lang.Menus.search_staffPicked;break;case"childCnt":n.sort=Lang.Menus.search_childCnt;break;case"recentLikeCnt":n.sort=Lang.Menus.search_likeCnt;break;case"visit":n.sort=Lang.Menus.viewer;break;case"likeCnt":n.sort=Lang.Menus.like;break;case"comment":n.sort=Lang.Menus.comment}break;case"period":switch(r){case"1":n.period=Lang.Menus.today;break;case"7":n.period=Lang.Menus.latest_week;break;case"30":n.period=Lang.Menus.latest_month;break;case"90":n.period=Lang.Menus.latest_three_month;break;default:n.period=Lang.Menus.entire_period}}}function E(t){for(var r in $.extend(e.condition,t),t)v.indexOf(r)>-1&&j(r,t[r])}function k(t){e.condition[t]=void 0}function T(e){E(e);var t="/"+e.tab;n.path(t).search(L()).replace()}function P(t){return"my_project"!==r.tab&&"marked_project"!==r.tab&&"markedGroup_project"!==r.tab||(t=t.filter((function(e){return"studying"!=e}))),e.isOwner&&e.primaryGroup||window.user&&window.user.primaryGroup?t.splice(t.length,0,"markedGroup"):t.filter((function(e){return"markedGroup"!=e})),e.subTabList=t,e.subTabList}function S(t){var r=e.subTabList.indexOf(t);return r>=0&&e.subTabList.splice(r,1),e.subTabList}e.projectList=[],e.groupList=[],e.user=c.user,e.isOwner=!(!c.user||c.user.username!==owner),e.username=c.user?c.user.username:"",e.timestamp=(new Date).getTime(),e.sortOptions=EntryStatic.searchProjectOption,e.categories=EntryStatic.categoryList,e.isTeacher=!!c.isTeacher(),e.sharedSpace=["public","group","private"],e.searching=!1,e.global=c,e.eachGroup=!1,e.langType=d.get("lang")?d.get("lang"):window.lang,e.status={isProjectCategoryOpen:!1,isCategoryOpen:!1,isLectureSortOpen:!1,isLecturePeriodOpen:!1,isCurriculumSortOpen:!1,isCurriculumPeriodOpen:!1},e.staticGroupList=[],e.tempSharedGroupList=[],e.sharedAreaObj={public:!1,group:!1,private:!1},e.basicSharedAreaObj=["public","group","private"],e.popUpMode={lectureDelete:{enable:!1},curriculumDelete:{enable:!1},shareLecture:{enable:!1},shareLectureCancel:{enable:!1}},e.condition={category:"",sort:"updated",period:"",rows:15,page:1,name:"",title:"",isOwner:e.isOwner,visitorGroups:null},e.conditionLang={category:Lang.EntryStatic.category_all,sort:"",period:Lang.Menus.entire_period},e.noContents={my_project:{text1:e.isOwner?m.no_project_1:m.empty_project_1,text2:e.isOwner?m.no_project_2:"",button:m.make_project,link:"/ws#!/"},marked_project:{text1:m.no_marked_project_1,text2:e.isOwner?m.no_marked_project_2:"",button:m.view_project_all,link:"/all#!/"},markedGroup_project:{text1:e.isOwner?m.no_marked_project_1:m.no_marked_group_project_1,text2:e.isOwner?m.no_markedGroup_project_2:"",button:m.view_project_all,link:window.user&&window.user.primaryGroup?"/all#!/group/":"/all#!/"},markedGroup_lecture:{text1:e.isOwner?m.no_marked_lecture_1:m.no_marked_group_lecture_1,text2:e.isOwner?m.find_interesting_lesson:"",button:m.view_lecture,link:"tt#!/group/lecture/list"},markedGroup_curriculum:{text1:e.isOwner?m.no_marked_lecture_collect_1:m.no_marked_lecture_group_collect_1,text2:e.isOwner?m.find_interesting_course:"",button:m.view_lecture_collection,link:"tt#!/group/curriculum/list"},my_lecture:{text1:e.isOwner?m.no_lecture_1:m.empty_lecture_1,text2:e.isOwner?m.no_lecture_2:"",button:m.lecture_build,link:"/tt#!/custom/lecture/build/lecture"},marked_lecture:{text1:m.no_marked_lecture_1,text2:e.isOwner?m.no_marked_lecture_2:"",button:m.view_lecture,link:"/tt#!/custom/lecture/list/1?sort=updated&rows=12&page=1"},studying_lecture:{text1:m.no_studying_lecture_1,text2:e.isOwner?m.no_studying_lecture_2:"",button:m.view_lecture,link:"/tt#!/custom/lecture/list/1?sort=created&rows=12&page=1"},my_curriculum:{text1:e.isOwner?m.no_lecture_collect_1:m.empty_lecture_collect_1,text2:e.isOwner?m.no_lecture_2:"",button:m.make_lecture_collection,link:"/tt#!/custom/curriculum/build"},marked_curriculum:{text1:m.no_marked_lecture_collect_1,text2:e.isOwner?m.no_marked_lecture_collect_2:"",button:m.view_lecture_collection,link:"/tt#!/custom/curriculum/list/1?sort=created&rows=12&page=1"},studying_curriculum:{text1:m.no_studying_lecture_collect_1,text2:e.isOwner?m.no_studying_lecture_collect_2:"",button:m.view_lecture_collection,link:"/tt#!/custom/curriculum/list/1?sort=created&rows=12&page=1"}},e.tabList=["project","lecture","curriculum"],e.subTabList=[],e.blogImagesThumb=["/img/assets/mypage/thumbnail_1.png","/img/assets/mypage/thumbnail_2.png","/img/assets/mypage/thumbnail_3.png","/img/assets/mypage/thumbnail_4.png","/img/assets/mypage/thumbnail_5.png","/img/assets/mypage/thumbnail_6.png","/img/assets/mypage/thumbnail_7.png"],e.blogImages=["/img/assets/mypage/banner_1.png","/img/assets/mypage/banner_2.png","/img/assets/mypage/banner_3.png","/img/assets/mypage/banner_4.png","/img/assets/mypage/banner_5.png","/img/assets/mypage/banner_6.png","/img/assets/mypage/banner_7.png"],e.personalAgree={open:!1,use:!1,edit:!1,all:!1},e.init=function(){if(c.user,r.tab,document.title=Lang.Menus.my_page_entry+" "+Lang.Menus.my_page_title+" - "+Lang.Menus.my_space_area,e.cachedResult={},c.subTabList?P(c.subTabList):P(["my","marked","studying"]),$(document).on("touchend",(function(e){$(e.target).closest(".dropdown").length||$("body").click()})),$(".dropdown-menu").on("click",(function(e){$(this).parent().toggleClass("open"),e.stopPropagation()})),e.generateSharedList(),e.projectList=[],r.tab){var t=r.tab.split("_");e.tabSub=t[0],e.tab=t[1],r.type?(E(r),e.currentPage=r.page,e.searching="true"===r.searching,e.searchWord=r.name||r.title,e.initView()):T({tab:r.tab,type:e.tab})}else T({tab:"my_project",type:"project"})},e.initView=function(){u.get("/api/getUserByUsername/"+owner).success((function(t,r){e.pageOwner=t;var n,o=e.pageOwner.description;o&&o.match(/\&[gl]t;/g)&&(o=o.replace(/\&gt;/g,">").replace(/\&lt;/g,"<"),e.pageOwner.description=o),E({user:t._id,type:e.tab}),c.user&&String(c.user._id)!==String(e.pageOwner._id)?n=!0:(k("visitorGroups"),n=!1),e.generateView(n)}))},e.generateView=function(t){e.applyImages(),e.executeSearchList()},e.getVisitorGroups=function(t){"student"===e.pageOwner.role&&S("marked"),window.user&&window.user._id?u({method:"GET",url:"/api/getGroupList"}).success((function(r,n){e.groupList=r,t&&t()})).error((function(e,r){t&&t()})):t&&t()},e.getGroups=function(t){var r=e.pageOwner._id;if(r){var n=e.pageOwner.role,o="/api/student/groups/"+r+"?all=true&rows=999&status=true",a="teacher"===n;i(a?"/api/group/groups/"+r:o).success((function(e,r){a&&!e.length?i(o).success((function(e,r){s(e,t)})).error((function(e,r){c(t)})):s(e,t)})).error((function(e,r){c(t)}))}function i(e){return u({method:"GET",url:e})}function s(t,o){e.user&&e.user._id==e.pageOwner._id&&(t.length||"student"===e.pageOwner.role)&&function(t){-1===e.subTabList.indexOf(t)&&e.subTabList.push(t),e.subTabList}("markedGroup"),"student"===e.pageOwner.role&&S("marked");var a=$.Deferred();if("teacher"===n)u({method:"GET",url:"/api/group/findByMember/"+r+"?page=1&rows=999"}).success((function(r,n){r&&r.length>0&&(t=t.concat(r)),e.groupList=t,a.resolve()})).error((function(){e.groupList=t,a.resolve()}));else{for(var i in t)t[i].group&&e.groupList.push(t[i].group);a.resolve()}a.then((function(){o&&o()}))}function c(t){e.status=status,e.groupList=[],t&&t()}},e.showProjectTitle=function(t){e.projectList[t].name.length>10&&(e.projectList[t].titleShow=!0)},e.hideLectureTitle=function(t){e.projectList[t].titleShow=!1},e.getFullTab=function(e,t){return e+"_"+t},e.isLang=function(e){return d.get("lang")==e},e.currentTabCheck=function(t){return e.tab===t},e.my_project=function(){var t=e.cachedResult,r=15*(e.currentPage-1)+1;if(!t||!t.data||r>t.data.length+t.skip){var n="/api/project/find?option=list&"+w();e.isOwner||(n+="&blamed=false"),u({method:"GET",url:n}).success(function(){var t=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){a(i,n,o,s,c,"next",e)}function c(e){a(i,n,o,s,c,"throw",e)}s(void 0)}))}}(o.a.mark((function t(r,n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.cachedResult=r,y(e.cachedResult);case 2:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()).error((function(r,n){e.status=n,y(t)}))}else y(t)},e.marked_project=function(){var t="/api/user/favorites/"+e.pageOwner._id+"?"+w();u({methos:"GET",url:t,params:{targetType:"individual",targetSubject:"project"}}).success((function(t){e.projectList=t})).error((function(t,r){e.status=r,e.projectList=[]})),e.countMarkedProject()},e.marked_lecture=function(){var t="/api/user/favorites/"+e.pageOwner._id+"?full=y&"+w();u({method:"GET",url:t,params:{targetType:"individual",targetSubject:"lecture"}}).success((function(t){e.initTitle(),e.projectList=t})).error((function(t,r){e.status=r,e.projectList=[]})),e.countMarkedLecture()},e.marked_curriculum=function(){var t="/api/user/favorites/"+e.pageOwner._id+"?full=y&"+w();u({methos:"GET",url:t,params:{targetType:"individual",targetSubject:"curriculum"}}).success((function(t){e.initTitle(),e.projectList=t;for(var r=0;r<e.projectList.length;r++){var n=e.projectList[r];e.projectList[r].gradeImage=_(n.grade),e.projectList[r].quiz=b(n.lectures)}})).error((function(t,r){e.status=r,e.projectList=[]})),e.countMarkedCurriculum()},e.markedGroup_project=function(){var t="/api/user/favorites/"+e.pageOwner._id+"?full=y&"+w();u({method:"GET",url:t,params:{targetType:"group",targetSubject:"project"}}).success((function(t){e.projectList=[],e.projectList=t,e.projectList.map((function(e,t){var r=e.favoriteGroup,n=e.commentGroup;e.currentCommentGroup=0,n&&n.map((function(t,n){null!=t&&t&&t.group==r&&(e.currentCommentGroup=t.count)}));var o=e.likeCntGroup;e.currentLikeCntGroup=0,o&&o.map((function(t,n){null!=t!=null&&t&&t.group==r&&(e.currentLikeCntGroup=t.count)}));var a=e.visitGroup;e.currentVisitGroup=0,a&&a.map((function(t,n){null!=t&&t&&t.group==r&&(e.currentVisitGroup=t.count)}))})),e.countGroupFavorite()})).error((function(t,r){e.status=r,e.projectList=[],e.dataCount=0}))},e.countGroupFavorite=function(){var t="/api/user/favoritesCount/"+e.pageOwner._id+"?"+w();u({method:"GET",url:t,params:{targetType:"group",targetSubject:"project"}}).success((function(t,r){t.count>0?(e.dataCount=t.count,e.generatePageList()):e.dataCount=0})).error((function(t,r){e.status=r}))},e.countMarkedLecture=function(){var t="/api/user/favoritesCount/"+e.pageOwner._id+"?"+w();u({metho:"GET",url:t,params:{targetType:"individual",targetSubject:"lecture"}}).success((function(t,r){e.dataCount=t.count,!e.markedLectureSearch&&e.dataCount>0&&(e.markedLectureSearch=!0),e.generatePageList()})).error((function(t,r){e.status=r}))},e.countMarkedCurriculum=function(){var t="/api/user/favoritesCount/"+e.pageOwner._id+"?"+w();u({methos:"GET",url:t,params:{targetType:"individual",targetSubject:"curriculum"}}).success((function(t,r){e.dataCount=t.count,!e.markedCurriculumSearch&&t.count>0&&(e.markedCurriculumSearch=!0),e.generatePageList()})).error((function(t,r){e.status=r}))},e.my_lecture=function(){var t="/api/lecture/find?isOpen=false&parent=null&"+w();e.isOwner||(t="/api/lecture/find?isOpen=true&"+w()),u({method:"GET",url:t}).success((function(t,r){e.initTitle(),e.projectList=t})).error((function(t,r){e.status=r,e.projectList=[]})),e.countMyLecture()},e.studying_lecture=function(){e.addOption({name:"user",value:""}),e.addOption({name:"isOwner",value:e.isOwner});var t=e.pageOwner.studyLecture?e.pageOwner.studyLecture:[],r=[];for(var n in t)r.push(t[n].lecture);if(t.length>0){var o="/api/lecture/find?option=list&studyLectures="+r+"&"+w();u.get(o).success((function(t,r){e.initTitle(),e.projectList=t})).error((function(t,r){e.status=r,e.projectList=[]}))}else e.projectList=[],e.dataCount=0;e.countStudyingLecture()},e.studying_curriculum=function(){e.addOption({name:"user",value:""}),e.addOption({name:"isOwner",value:e.isOwner});var t=e.pageOwner.studyCurriculum,r=[];for(var n in t)r.push(t[n].curriculum);if(t.length>0){var o="/api/curriculum/find?option=list&studyCurriculums="+r+"&"+w();u.get(o).success((function(t,r){e.projectList=t,e.initTitle();for(var n=0;n<e.projectList.length;n++){var o=e.projectList[n];e.projectList[n].gradeImage=_(o.grade),e.projectList[n].quiz=b(o.lectures)}})).error((function(t,r){e.status=r,e.projectList=[]}))}else e.projectList=[],e.dataCount=0;e.countStudyingCurriculum()},e.my_curriculum=function(){var t="/api/curriculum/find?option=list&target=mine&isOpen=false&parent=null&"+w();e.isOwner||(t="/api/curriculum/find?isOpen=true&"+w()),u({method:"GET",url:t}).success((function(t,r){e.projectList=t,e.myCurriculumList=t,e.initTitle();for(var n=0;n<e.projectList.length;n++){var o=e.projectList[n];e.projectList[n].gradeImage=_(o.grade),e.projectList[n].quiz=b(o.lectures)}})).error((function(t,r){e.status=r,e.projectList=[]})),e.countMyCurriculum()},e.countMyLecture=function(){var t="/api/lecture/count?isOpen=false&parent=null&"+w();e.isOwner||(t="/api/lecture/count?isOpen=true&"+w()),u({method:"GET",url:t}).success((function(t,r){e.dataCount=t.count,e.generatePageList()})).error((function(t,r){e.status=r}))},e.countMyCurriculum=function(){var t="/api/curriculum/count?option=list&target=mine&isOpen=true&parent=null&"+w();e.isOwner||(t="/api/lecture/count?isOpen=true&"+w()),u({method:"GET",url:t}).success((function(t,r){!e.myCurriculumSearch&&t.count>0&&(e.myCurriculumSearch=!0),e.dataCount=t.count,e.generatePageList()})).error((function(t,r){e.status=r}))},e.countMarkedProject=function(){var t="/api/user/favoritesCount/"+e.pageOwner._id+"?"+w();u({method:"GET",url:t,params:{targetType:"individual",targetSubject:"project"}}).success((function(t,r){e.dataCount=t.count,e.generatePageList()})).error((function(t,r){e.status=r}))},e.countStudyingLecture=function(){e.addOption({name:"user",value:""}),e.addOption({name:"isOwner",value:e.isOwner});var t=e.pageOwner.studyLecture?e.pageOwner.studyLecture:[],r=[];for(var n in t)r.push(t[n].lecture);if(r.length>0){var o="/api/lecture/count?option=list&studyLectures="+r+"&"+w();u.get(o).success((function(t,r){!e.studyingLectureSearch&&t.count>0&&(e.studyingLectureSearch=!0),e.dataCount=t.count,e.generatePageList()})).error((function(t,r){e.status=r}))}else e.hideSearchBar=!0},e.countStudyingCurriculum=function(){var t=e.pageOwner.studyCurriculum,r=[];for(var n in t)r.push(t[n].curriculum);if(r.length>0){var o="/api/curriculum/count?option=list&studyCurriculums="+r+"&"+w();u.get(o).success((function(t,r){!e.studyingCurriculumSearch&&t.count>0&&(e.studyingCurriculumSearch=!0),e.dataCount=t.count,e.generatePageList()})).error((function(t,r){e.status=r,e.dataCount=0}))}},e.setOption=function(t,r,o){e.addOption(t,r);var a="false";o&&(a="true"),E({searching:a}),$.each(e.status,(function(t,r){e.status[t]=!1}));var i="/"+e.tabSub+"_"+e.tab;n.path(i).search(L())},e.executeSearchList=function(){"function"==typeof e[e.tabSub+"_"+e.tab]&&(e.projectList=[],e[e.tabSub+"_"+e.tab]())},e.getSubMenuPos=function(){var t=e.tab;return"project"===t?"left":"lecture"===t?"center":"right"},e.addOption=function(t,r){t&&t.name&&(e.condition[t.name]=t.value),r&&(e.cachedResult={},e.condition.page=1)},e.getOption=function(t){return e.condition[t]},e.getOptionLabel=function(t){return e.conditionLang[t]},e.search=function(t){if(t)r=t;else if(document.getElementById("searchInput")){var r=document.getElementById("searchInput").value,o={searching:"true"};"project"===e.tab?o.name=r:o.title=r,"studying"===e.tabSub?o.user="":"my"===e.tabSub&&(o.user=e.pageOwner._id),E(o);var a="/"+e.tabSub+"_"+e.tab;n.path(a).search(L()),setTimeout((function(){e.$apply()}))}},e.prevPage=function(){if(1===e.currentPage)entrylms.alert(Lang.Menus.first_page);else{var t=e.currentPage-1;e.setPage(t),$("html,body").animate({scrollTop:$(".psListWrapper").eq(0).position().top},700)}},e.nextPage=function(){if(e.currentPage===e.lastPage)entrylms.alert(Lang.Menus.last_page);else{var t=e.currentPage+1;e.setPage(t),$("html,body").animate({scrollTop:$(".psListWrapper").eq(0).position().top},700)}},e.projectDetail=function(t){t.isopen||e.user&&String(e.user._id)==String(e.pageOwner._id)?t.isopen||String(t.user._id)===String(e.pageOwner._id)?window.location.href="/"+t.user.username+"/"+t._id+"?returnUrl="+c.getEncodeURI(location.href):entrylms.alert(Lang.Menus.private_project):t.group&&t.group.length>0?u.get("/api/getGroupList").success((function(e){if(e&&e.length>0){var r=t.group.filter((function(t){for(var r=0;r<e.length;r++)if(String(t)==String(e[r]._id))return!0}));r.length>0?window.location.href="/"+t.user.username+"/"+t._id+"/"+r[0]+"?returnUrl="+c.getEncodeURI(location.href):entrylms.alert(Lang.Menus.no_permission)}else entrylms.alert(Lang.Menus.no_permission)})):String(t.user._id)===String(e.pageOwner._id)?entrylms.alert(Lang.Menus.private_project):entrylms.alert(Lang.Menus.no_permission)},e.projectCodeView=function(t,r){t.stopPropagation();var n=r.isPracticalCourse?"practical_course":"workspace";String(r.user._id)===String(e.user._id)?window.location.href="/ws/"+r._id+"?type="+n:r.isopen?window.location.href="/ws/"+r._id+"?type="+n:entrylms.alert(Lang.Menus.private_project)},e.uploadAvatar=function(){var t=new FormData,r=document.getElementById("uploadAvatar").files[0];if(t.append("uploadAvatar",r),!r)return!1;var n=/^image\//.test(r.type),o=/^image\/gif/.test(r.type);return!n||o?(entrylms.alert(Lang.Workspace.upload_not_supported_file_msg),!1):r.size>10485760?(entrylms.alert(Lang.Menus.file_upload_max_size),!1):($("#thumbXButtons").attr("src","/img/assets/mypage/x_btn.png"),void e.uploadAvatarFile(t))},e.uploadAvatarFile=function(t){var r=e.pageOwner._id;$.ajax({url:"/rest/picture/avatar/"+r+"/upload",data:t,cache:!1,contentType:!1,processData:!1,type:"POST",headers:{"csrf-token":c.csrfToken()},success:function(t){e.$apply((function(){e.avatarChanged=!0,e.pageOwner.avatarImage=!0,e.avatarDeleted=!1})),$(".psListInfoProfileThumb").css("backgroundImage","url('"+t.url+"?v="+(new Date).getTime()+"')"),$(".projectUserThumb.myproject").attr("src",t.url+"?v="+(new Date).getTime()),$(".psListTopThumb").attr("src",t.url+"?v="+(new Date).getTime()),$(".user_thumbnail").attr("src",t.url+"?v="+(new Date).getTime())},error:function(e,t){entrylms.alert(Lang.Msgs.upload_error_content,Lang.Msgs.upload_error_title)}})},e.removeAvatar=function(){e.avatarDeleted=!0,e.pageOwner.avatarImage=!1;var t="/img/assets/avatar_img.png";$(".psListInfoProfileThumb").css("backgroundImage","url('"+t+"')"),$(".projectUserThumb.myproject").attr("src",t),$(".psListTopThumb").attr("src",t),$(".user_thumbnail").attr("src",t),document.getElementById("uploadAvatar").value=""},e.uploadBlog=function(){var t=new FormData,r=document.getElementById("uploadBlog").files[0];if(t.append("uploadBlog",r),e.blogImage=!1,e.userUploadImage=!0,!r)return!1;var n=/^image\//.test(r.type),o=/^image\/gif/.test(r.type);return!n||o?(entrylms.alert(Lang.Menus.image_file_only),!1):r.size>10485760?(entrylms.alert(Lang.Menus.file_upload_max_size),!1):void e.uploadBlogFile(t)},e.uploadBlogFile=function(t){var r=e.pageOwner._id;$.ajax({url:"/rest/picture/blog/"+r+"/upload",data:t,cache:!1,contentType:!1,processData:!1,type:"POST",headers:{"csrf-token":c.csrfToken()},success:function(t){e.$apply((function(){e.uploadBlogImage=!0,e.blogChanged=!0,e.blogDeleted=!1,e.pageOwner.blogImage=t.url})),$(".imageUploadBox").css("backgroundImage","url('"+t.url+"?v="+(new Date).getTime()+"')"),$(".imageUploadBox").css("background-position","inherit"),$(".imageUploadBox").css("background-size","70px 70px"),$(".imageBox").removeClass("selected"),$(".imageUploadBox").addClass("selected"),$(".psListTopWrapper").css("backgroundImage","url('"+t.url+"?v="+(new Date).getTime()+"')")},error:function(e,t){entrylms.alert(Lang.Msgs.upload_error_content,Lang.Msgs.upload_error_title)}})},e.removeBlog=function(){e.blogDeleted=!0,e.pageOwner.blogImage=!1,e.uploadBlogImage=!1,$(".psListTopWrapper").css("backgroundImage","url('/img/assets/mypage/banner_0.png'), url('/img/assets/mypage/banner_1.png')"),$(".imageUploadBox").css("backgroundImage","url('/img/assets/art/upload_icon.png')"),$(".imageUploadBox").css("background-size","initial"),$(".imageUploadBox").css("background-position","center"),e.currentBlogThumb=e.blogImagesThumb[0],e.basicBlogImage=!0,$(".imageUploadBox").removeClass("selected")},e.cancel=function(){var t=e.pageOwner._id;u.delete("/api/picture/temp/"+t+"/remove",{headers:{"csrf-token":c.csrfToken()}}).success((function(t){u.get("/api/getUserByUsername/"+owner).success((function(t,r){e.pageOwner=t,e.applyImages(),e.popupClose("editProfilePopupWrapper")}))}))},e.confirm=function(){var t=e.pageOwner._id;if(jQuery(".psListInfoTextArea").val().length>50)return entrylms.alert(Lang.Menus.text_limit_50),!1;e.avatarDeleted&&u.delete("/api/picture/avatar/"+t+"/remove",{headers:{"csrf-token":c.csrfToken()}}).success((function(e,t){})),e.blogDeleted&&u.delete("/api/picture/blog/"+t+"/remove",{headers:{"csrf-token":c.csrfToken()}}).success((function(e,t){})),e.blogImage&&(e.pageOwner.blogImage=e.blogImage),e.pageOwner.description||(e.pageOwner.description=""),u.post("/rest/picture/upload_confirm",{description:e.pageOwner.description,avatarImage:e.pageOwner.avatarImage,blogImage:e.pageOwner.blogImage},{headers:{"csrf-token":c.csrfToken()}}).success((function(t,r){u.post("/api/users/updateBlogImage",{blogImage:e.pageOwner.blogImage},{headers:{"csrf-token":c.csrfToken()}}).success((function(t,r){e.applyImages(),e.popupClose("editProfilePopupWrapper"),e.popupOpen("editProfileConfirmPopupWrapper")}))})).error((function(e,t){console.log(e)}))},e.popupOpen=function(e){var t=$("#"+e),r=$("body").eq(0);t.css("top",r.scrollTop()+"px"),t.css("display","block")},e.popupClose=function(e){var t=$("#"+e);$("body").eq(0),t.css("display","none"),$.event.trigger({type:"hidePopup"})},e.applyImages=function(){var t=e.pageOwner._id;if(r=e.pageOwner.blogImage)if($(".psListTopWrapper").css("backgroundImage","url('/img/assets/mypage/banner_0.png'), url('"+r+"')"),e.basicBlogImage=-1!=r.indexOf("/img/assets"),e.basicBlogImage)e.currentBlogThumb=r;else{e.uploadBlogImage=!0;var r="/uploads/profile/"+t.substring(0,2)+"/"+t.substring(2,4)+"/blog_"+t+".png?v="+(new Date).getTime();$(".imageUploadBox").css("backgroundImage","url('"+r+"')"),$(".imageUploadBox").css("background-position","inherit"),$(".imageUploadBox").css("background-size","70px 70px"),$(".imageUploadBox").addClass("selected"),$(".psListTopWrapper").css("backgroundImage","url('/img/assets/mypage/banner_0.png'), url('"+r+"')")}else $(".psListTopWrapper").css("backgroundImage","url('/img/assets/mypage/banner_0.png'), url('/img/assets/mypage/banner_1.png')");var n="/img/assets/avatar_img.png";e.pageOwner.avatarImage&&(n="/uploads/profile/"+t.substring(0,2)+"/"+t.substring(2,4)+"/avatar_"+t+".png?v="+(new Date).getTime()),$(".psListInfoProfileThumb").css("backgroundImage","url('"+n+"')"),$(".projectUserThumb.myproject").attr("src",n),$(".psListTopThumb").attr("src",n),$(".user_thumbnail").attr("src",n),document.getElementById("uploadAvatar").value=""},e.setUrl=function(t){var r="";if(e.pageOwner){if("teacher"==e.pageOwner.role||"project"==t)r="#!/my_"+t;else{var n="";e.subTabList.some((function(e){if("my"!==e)return n=e+"_",!0})),r="#!/"+n+t}window.location.hash.indexOf(r)>-1?window.location.reload():window.location.hash=r}},e.setSubUrl=function(e,t){if(e&&t){k("name"),k("title"),k("searching"),k("category"),k("period"),E({page:1,sort:"updated",tab:e+"_"+t,type:t});var r="/"+e+"_"+t;n.path(r).search(L())}},e.reloadUrl=function(){$state.reload()},e.showPopup=function(t,r,n){e.popupMode={},e.popupMode.show=t,e.popupMode.hide=r,e.popupMode.params=n},e.confirmPopup=function(t){var r=e.popupMode.params;e.popupMode.hide&&e[e.popupMode.hide](r),t||(e.popupMode={})},e.hidePopup=function(){e.popupMode={},e.cancelShare()},e.setBlogImage=function(t,r){e.removeBlog(),e.currentBlogThumb=t,e.blogImage=e.blogImages[r],$(".psListTopWrapper").css("backgroundImage","url('"+e.blogImage+"')")},e.generatePageList=function(){e.lastPage=Math.ceil(e.dataCount/Number(e.getOption("rows").value))},e.setPage=function(t){t<e.currentPage&&(e.cachedResult={}),e.currentPage=t,e.setOption({name:"page",value:t})},e.isLang=function(e){var t=d.get("lang");return null==t&&(t="ko"),t===e},e.lectureDetail=function(e){if(e.favoriteGroup)window.location.href="tt?returnUrl="+c.getEncodeURI(location.href)+"#!/group/lecture/view/"+e._id+"/"+e.favoriteGroup;else{var t=null;u.get("/api/getGroupList?lectures=true").success((function(r){var n=r.filter((function(t){return t.lectures.filter((function(t){return String(t)==String(e._id)})).length>0}));n.length>0&&(t=n[0]._id),window.location.href=null==t?"tt?returnUrl="+c.getEncodeURI(location.href)+"#!/custom/lecture/view/"+e._id:"tt?returnUrl="+c.getEncodeURI(location.href)+"#!/group/lecture/view/"+e._id+"/"+t}))}},e.isLang=function(e){var t=d.get("lang");return null==t&&(t="ko"),t===e},e.curriculumDetail=function(e){if(e.favoriteGroup)window.location.href="tt?returnUrl="+c.getEncodeURI(location.href)+"#!/group/curriculum/view/"+e._id+"/"+e.favoriteGroup;else{var t=null;u.get("/api/getGroupList?curriculums=true").success((function(r){var n=r.filter((function(t){return t.curriculums.filter((function(t){return String(t)==String(e._id)})).length>0}));n.length>0&&(t=n[0]._id),window.location.href=null==t?"tt?returnUrl="+c.getEncodeURI(location.href)+"#!/custom/curriculum/view/"+e._id:"tt?returnUrl="+c.getEncodeURI(location.href)+"#!/group/curriculum/view/"+e._id+"/"+t}))}},e.showThumbnail=function(e){return e.isForCourse&&(e=function(e){return c.isLectureStaticThumb(e)&&(e.staticThumb=!0),e}(e)),e.staticThumb?c.staticLectureThumbnail(e,"M"):"done"===e.preview&&e.doneProject?{"background-image":"url('"+e.doneProject.thumb+"')"}:"video"===e.preview&&e.youtubeHash?{"background-image":"url('https://img.youtube.com/vi/"+e.youtubeHash+"/mqdefault.jpg')"}:e.basicProject&&e.basicProject.thumb?{"background-image":"url('"+e.basicProject.thumb+"')"}:{}},e.lectureDelete=function(t){var r=e.pageOwner._id;u.post("/api/users/studyLecture/"+r,{user:r,studyLectureId:t._id},{headers:{"csrf-token":c.csrfToken()}}).success((function(t){e.pageOwner=t,e.studying_lecture(),e.hidePopup()}))},e.curriculumDelete=function(t){var r=e.pageOwner._id;u.post("/api/users/studyCurriculum/"+r,{user:r,studyCurriculumId:t._id},{headers:{"csrf-token":c.csrfToken()}}).success((function(t){e.pageOwner=t,e.studying_curriculum(),e.hidePopup()}))},e.initTitle=function(){var t=e.dataCount;e.hoverTitle=[];for(var r=0;r<t;r++)e.hoverTitle.push(!1)},e.showTitleAll=function(t){e.hoverTitle[t]=!0},e.hideTitleAll=function(t){e.hoverTitle[t]=!1},e.countOver=function(e){return!!e.title&&e.title.length>=11},e.agreeLectureTerm=function(t){e.projectList[t].isOpen=!e.projectList[t].isOpen,u.put("/api/lecture/isOpen/"+e.projectList[t]._id,{isOpen:e.projectList[t].isOpen},{headers:{"csrf-token":c.csrfToken()}}).success((function(){}))},e.checkFavCurriculum=function(e){var t=window.user.studyCurriculum;if(t.length<=0)return!1;for(var r=0;r<t.length;r++)if(t[r].curriculum==e)return!0;return!1},e.markedGroup_lecture=function(){var t="/api/user/favorites/"+e.pageOwner._id+"?full=y&"+w();e.initTitle(),u({method:"GET",url:t,params:{targetType:"group",targetSubject:"lecture"}}).success((function(t){e.projectList=t,e.projectList.map((function(e,t){var r=e.favoriteGroup,n=e.commentGroup;e.currentCommentGroup=0,n&&n.map((function(t,n){null!=t&&t&&t.group==r&&(e.currentCommentGroup=t.count)}));var o=e.likeCntGroup;e.currentLikeCntGroup=0,o&&o.map((function(t,n){null!=t!=null&&t&&t.group==r&&(e.currentLikeCntGroup=t.count)}));var a=e.visitGroup;e.currentVisitGroup=0,a&&a.map((function(t,n){null!=t&&t&&t.group==r&&(e.currentVisitGroup=t.count)}))})),e.countGroupLectureFavorite()})).error((function(t,r){e.status=r,e.projectList=[],e.dataCount=0}))},e.countGroupLectureFavorite=function(){var t;t="/api/user/favoritesCount/"+e.pageOwner._id+"?full=y&"+w(),u({method:"GET",url:t,params:{targetType:"group",targetSubject:"lecture"}}).success((function(t,r){t.count>0?(e.dataCount=t.count,e.generatePageList()):e.dataCount=0})).error((function(t,r){e.status=r}))},e.markedGroup_curriculum=function(){var t="/api/user/favorites/"+e.pageOwner._id+"?full=y&"+w();e.initTitle(),u({method:"GET",url:t,params:{targetType:"group",targetSubject:"curriculum"}}).success((function(t){e.projectList=[],e.projectList=t,e.projectList.map((function(e,t){var r=e.favoriteGroup,n=e.grade;e.gradeImage=_(n),e.quiz=b(e.lectures);var o=e.commentGroup;e.currentCommentGroup=0,o&&o.map((function(t,n){null!=t&&t&&t.group==r&&(e.currentCommentGroup=t.count)}));var a=e.likeCntGroup;e.currentLikeCntGroup=0,a&&a.map((function(t,n){null!=t!=null&&t&&t.group==r&&(e.currentLikeCntGroup=t.count)}));var i=e.visitGroup;e.currentVisitGroup=0,i&&i.map((function(t,n){null!=t&&t&&t.group==r&&(e.currentVisitGroup=t.count)}))})),e.countGroupCurriculumFavorite()})).error((function(t,r){e.status=r,e.projectList=[],e.dataCount=0}))},e.countGroupCurriculumFavorite=function(){var t="/api/user/favoritesCount/"+e.pageOwner._id+"?"+w();u({method:"GET",url:t,params:{targetType:"group",targetSubject:"curriculum"}}).success((function(t,r){t.count>0?(e.dataCount=t.count,e.generatePageList()):e.dataCount=0})).error((function(t,r){e.status=r}))},e.shareToggleProject=function(e){return!!(e.isopen||e.group&&e.group.length>0)},e.shareToggle=function(e){return!!(e.openArea&&e.openArea.groupList&&e.openArea.groupList.length>0||e.isOpen)},e.initSharePopup=function(t){var r;c.user&&String(c.user._id)!==String(e.pageOwner._id)?r=!0:(k("visitorGroups"),r=!1),(r?e.getVisitorGroups:e.getGroups)((function(){var r=e.groupList;e.tempSharedGroupList=r,e.visitorGroups=r;var n=[];r.length>0&&r.map((function(e){n.push(e._id)})),E({visitorGroups:n}),c.subTabList=e.subTabList,"project"===e.tab&&(e.lecture=t,e.showPopup("shareLecture","shareLecture",t)),e.selectShared("private")}))},e.toggleProjectOpen=function(t){var r=e.projectList[t];r.isopen=!1,r.group=[],u.put("/api/project/openProject/"+r._id,r,{headers:{"csrf-token":c.csrfToken()}}).then((function(r){e.projectList[t].isopen=!1,e.projectList[t].group=[],e.hidePopup()}),(function(e){entrylms.alert(Lang.Msgs.error_occured)}))},e.selectShared=function(t){e.sharedAreaObj[t]=!e.sharedAreaObj[t];var r=e.tempSharedGroupList;if("private"==t){e.sharedAreaObj.private||(e.sharedAreaObj.private=!0),e.sharedAreaObj.public=!1,e.sharedAreaObj.group=!1;for(var n=0;n<r.length;n++)e.sharedAreaObj[r[n]]=!1}else if("public"==t)e.sharedAreaObj.private=!1;else if("group"==t)for(e.sharedAreaObj.private=!1,n=0;n<r.length;n++)e.sharedAreaObj[r[n]._id]=e.sharedAreaObj.group;else{var o=!1,a=r.map((function(e){return e._id})).indexOf(t);if(a<=-1)e.tempSharedGroupList.push(t),e.sharedAreaObj[t]=!0,e.sharedAreaObj.private=!1;else if(e.sharedAreaObj[t])e.sharedAreaObj[t]=!0,e.sharedAreaObj.private=!1;else{var i=r.map((function(e){return e._id})).splice(a,1);e.staticGroupList.map((function(e){return e._id})),i.length>0&&e.staticGroupList.push(i[0]),e.sharedAreaObj[t]=!1,e.sharedAreaObj.group=!1}for(n=0;n<e.staticGroupList.length;n++){var s=e.staticGroupList[n];!0!==e.sharedAreaObj[s]&&(o=!0)}e.sharedAreaObj.group=!o}var c=!0;for(var s in e.sharedAreaObj)if("private"!=s&&e.sharedAreaObj[s])return void(c=!1);c&&(e.sharedAreaObj.private=!0)},e.generateSharedList=function(){var t=[],r=e.sharedAreaObj;r.public&&t.push(Lang.EntryStatic.publicProject);var n=e.groupList.filter((function(e){return!e.student||!e.student.user||"confirmed"==e.student.status}));if(e.tempSharedGroupList=n,e.sharedGroupList=n,n.length>0)for(var o in n){var a=n[o];r[a._id]&&t.push(a.name)}return r.private&&t.push(Lang.EntryStatic.private),t.length?t.join(", "):Lang.Menus.select_share_area},e.togglePersonal=function(t){if("all"==t&&0==e.personalAgree.all)for(var r in e.personalAgree)e.personalAgree[r]=!0;else if("all"==t&&1==e.personalAgree.all)for(var r in e.personalAgree)e.personalAgree[r]=!1;if("all"!=t){e.personalAgree[t]=!e.personalAgree[t];var n=e.personalAgree;n.open&&n.use&&n.edit&&(e.personalAgree.all=!0)}1==e.personalAgree.all&&(e.personalAgree[t]||(e.personalAgree.all=!1))},e.isSharedChecked=function(t){return e.sharedAreaObj[t]},e.shareLecture=function(){if(e.sharedAreaObj.private)return e.openAreaQuestion=!0,e.isAgreeProjectTermAll=!1,void(e.isAgreeProjectTerm=!1);if(e.openAreaQuestion=!1,"project"==e.tab){if(!e.personalAgree.all){for(var t in e.personalAgree)e.personalAgree[t]&&(e.isAgreeProjectTerm=!1,e.isAgreeProjectTermAll=!0);e.isAgreeProjectTermAll=!1,e.isAgreeProjectTerm=!0}e.personalAgree.all&&(e.isAgreeProjectTerm=!1,e.isAgreeProjectTermAll=!1,e.shareLectureAgree(),e.hidePopup())}else e.isAgreeProjectTerm=!1,e.isAgreeProjectTermAll=!1,e.shareLectureAgree(),e.hidePopup()},e.shareLectureAgree=function(){if("my_project"==e.tabSub+"_"+e.tab){e.project=e.popupMode.params,e.isSharedChecked("public")?e.project.isopen=!0:e.isSharedChecked("private")&&(e.project.isopen=!1),e.project.group=[];for(var t=e.tempSharedGroupList,r=0;r<t.length;r++){var n=t[r]._id;e.sharedAreaObj[n]&&e.project.group.push(n)}u.put("/api/project/openProject/"+e.project._id,e.project,{headers:{"csrf-token":c.csrfToken()}}).success((function(t){e.hidePopup(),e.shareToggle(t),e.initShareSelected()})).error((function(t,r){509===r&&(e.project.isopen=!1,e.shareToggleProject(e.project),entrylms.alert(Lang.Menus.contents_abuse_detected)),e.hidePopup()}))}},e.initShareSelected=function(){var t=e.tempSharedGroupList;for(var r in e.sharedAreaObj.private=!1,e.sharedAreaObj.public=!1,e.sharedAreaObj.group=!1,e.personalAgree)e.personalAgree[r]=!1;for(var n=0;n<t.length;n++)e.sharedAreaObj[t[n]._id]=!1},e.cancelShare=function(){e.initShareSelected(),e.isAgreeProjectTerm=!1,e.isAgreeProjectTermAll=!1,e.openAreaQuestion=!1},e.shareLectureCancel=function(){e.initShareSelected(),e.selectShared("private"),e.isAgreeProjectTerm=!1,e.isAgreeProjectTermAll=!1,e.shareLectureAgree()},e.multiLineEllipsis=function(e,t){if(t){var r=$("#"+e),n=$("#"+e+"> pre > span"),o=r.css("min-height");o=+o.split("px")[0],(t=t.replace(/\n/g,"")).length>210&&(t=t.substring(0,210));for(var a=n.height();a>o;)t=t.substring(0,t.length-1).trim(),n.text((function(e){return t+"..."})),a=n.height();return t}}}])},1090:function(e,t,r){"use strict";r.r(t);var n=r(6),o=r.n(n),a=r(505),i=r.n(a);function s(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){s(a,n,o,i,c,"next",e)}function c(e){s(a,n,o,i,c,"throw",e)}i(void 0)}))}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}angular.module("mean.arts.groupView").controller("ArtsGroupViewController",["$scope","Global","$http","$routeParams","$uibModal","$sce","Projects","myProject","Comments","Users","Feedback","$cookies","CloudCache","$timeout",function(e,t,r,n,a,s,p,l,d,g,f,m,h,v){e.currentSocial="like",e.global=t,e.isAuth=t.authenticated,e.isStudent=t.isStudent(),e.currentPage=1,e.isEntryStop=!0,e.commentText="",e.currentUser=window.user,e.isAdmin=t.isAdmin(),e.isEditing=!1,e.report={},e.beforeUpdateProject=[],e.toggle=!1,e.isOpenButton=!1,e.nonePerson=Lang.Menus.none_person,e.likeShown=10,e.interestShown=10,e.groupId=window.location.pathname.split("/")[3],e.type="group",e.sharedSpace=["publicProject","group","private"],e.isAgreeProjectTermAll=!1,e.isAgreeProjectTerm=!1,e.status={isCategoryOpen:!1},e.sharedgroupList=[],e.sharedAreaObj={},e.sharedSelected=!0,e.personalAgree={open:!1,use:!1,edit:!1,all:!1},e.commentOption={rows:5,page:1},e.isLang=function(e){return m.get("lang")==e};var y=function(){entrylms.alert(Lang.Menus.private_project).on("hide",(function(){e.list()}))};e.isPrivate=!1;var _=window.useWebGL;function b(n){r.post("/api/comment",{_csrf:t.csrfToken(),content:n,target:e.project._id,targetSubject:"project",targetType:e.type,group:e.groupId},{headers:{"limit-type":"group_individual"}}).success((function(t,r){e.commentOption.page=1,$(".commentText").eq(0).val(""),e.getComment()})).error((function(t,r){var n=r||0;"abuse"===t||429===n?entrylms.alert(Lang.Menus.discuss_write_abuse_detected):403==n&&"pwmerror"===t.msg?entrylms.alert(Lang.Menus.fword_alert_1):510===r?(entrylms.alert(Lang.Menus.discuss_write_abuse_warn),e.commentOption.page=1,$(".commentText").eq(0).val(""),e.getComment()):509===r?entrylms.alert(Lang.Menus.discuss_write_abuse_detected):entrylms.alert(Lang.Menus.no_permission)}))}function w(e){r.put("/api/comment/".concat(e._id),{_csrf:t.csrfToken(),content:e.content}).success((function(t){e.editing=!1}))}e.glModeName=_?"ON":"OFF",e.toggleWebGL=function(){m.put("use_webgl",_?"0":"1"),document.location.reload()},e.init=function(){var t="";e.isAdmin?(t="/api/group/".concat(e.groupId),r({method:"GET",url:t}).success((function(t,r){e.groupList=[t],e.load()})).error((function(e,t){}))):r({method:"GET",url:"/api/getGroupList"}).success((function(t,r){e.groupList=t,t&&t.length>0&&-1!=t.map((function(e){return String(e._id)})).indexOf(e.groupId)?e.load():y()})).error((function(e,t){y()}))},e.load=function(){e.isEntryStop=!1,e.generateSharedList(),r({method:"GET",url:"/api/project/".concat(projectId,"?like=true")}).success((function(t,n){if(delete t.like,e.project=t,t.isopen)e.isPrivate=!0,e.isEntryStop=!0;else if(e.isAdmin)e.isEntryStop=!0,e.isPrivate=!0;else if(e.isAdmin||String(e.project.user._id)!==String(e.global.user._id)){var o=e.sharedgroupList.map((function(t){return e.project.group.map((function(r,n){if(String(t._id)===String(r))return e.isPrivate=!0,!0}))})),a=new Promise((function(t,r){if(!e.isPrivate)return e.isPrivate=!1,entrylms.alert(Lang.Menus.private_project),void y();e.isEntryStop=!0,e.isPrivate=!0}));e.project.group&&e.project.group.length>0&&Promise.all([o,a]).then((function(){resolve(!0)})).catch((function(){e.isPrivate=!1,entrylms.alert(Lang.Menus.private_project),y()}))}else e.isEntryStop=!0,e.isPrivate=!0;var i=t.commentGroup;e.project.currentCommentGroup=0,i&&i.map((function(t,r){null!=t&&t&&t.group==e.groupId&&(e.project.currentCommentGroup=t.count)}));var s=t.likeCntGroup;t.currentLikeCntGroup=0,s&&s.map((function(t,r){null!=t&&t&&t.group==e.groupId&&(e.project.currentLikeCntGroup=t.count)}));var c=t.visitGroup;t.currentVisitGroup=0,c&&c.map((function(t,r){null!=t&&t&&t.group==e.groupId&&(e.project.currentVisitGroup=t.count)}));var u=t.shortenUrlGroup;t.currentShortenUrlGroup="",u&&u.map((function(t,r){null!=t&&t&&t.group==e.groupId&&(e.project.currentShortenUrlGroup=t.url,e.shortenUrl=t.url)})),e.injectProject();var p="/api/project/likes/".concat(e.project._id),l={targetSubject:"project",targetType:e.type,group:e.groupId};r({method:"GET",url:p,params:l}).then((function(t){if(200===t.status){if(t.data){var r=[];t.data.map((function(e){r.push(e.user)})),e.project.like=r,e.project.currentLikeCntGroup=r.length}}else entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)})),p="/api/project/isfavorite/".concat(t._id),l={targetSubject:"project",targetType:e.type,group:e.groupId},r({method:"GET",url:p,params:l}).success((function(t,r){e.isInterestThis=t.exists})).error((function(t,r){e.status=r,e.isInterestThis=!1})),l={targetSubject:"project",targetType:e.type,group:e.groupId,rows:e.interestShown},r.get("/api/project/favorites/".concat(t._id),{params:l}).success((function(t,r){e.project.currentFavoriteCntGroup=t.total,e.project.interest=t.favorites}))})),r({method:"GET",url:"/api/project/".concat(projectId)}).success((function(t,n){e.beforeUpdateProject=t,e.beforeUpdateProject.parent&&r({method:"GET",url:"/api/project/".concat(e.beforeUpdateProject.parent)}).success((function(t,r){"object"==u(t)?(e.originPrj=t,e.isParentAlive=!0,e.parentProjectName=t.name||Lang.Menus.basic_project,e.parentUserName=t.user.username):e.isParentAlive=!1})),e.initSharedList(t),$("[data-toggle='dropdown']").parent().on("hidden.bs.dropdown",(function(t){e.sharedSelected&&($(".projectBuildDropdown").addClass("open"),e.sharedSelected=!1)}))})),e.getComment()},e.initSharedList=function(t){var n,o=window.user?window.user.role:null;e.currentUser&&t.user._id===e.currentUser._id&&(n="teacher"===o?"/api/group/groups/".concat(window.user._id):"/api/student/groups/".concat(window.user._id,"?all=true&page=1&rows=999"),r.get(n).success((function(n){"teacher"==o?r({method:"GET",url:"/api/group/findByMember/".concat(window.user._id,"?page=1&rows=999")}).success((function(r,o){r&&r.length>0&&(n=n.concat(r)),e.groupList=n,e.setSharedList(t,n)})):(e.groupList=n,e.setSharedList(t,n))})))},e.setSharedList=function(t,r){var n=window.user.role;if(r.forEach((function(t){var r=t;t.group&&(r=t.group),r.student&&r.student.user?"confirmed"==r.student.status&&e.sharedgroupList.push(r):"confirmed"==t.status&&e.sharedgroupList.push(r)})),e.sharedAreaObj.group=!0,t.group&&r)if("teacher"===n)for(var o in r){for(var a=0;a<t.group.length;a++)(s=t.group[a])==r[o]._id&&(e.sharedAreaObj[s]=!0,e.sharedAreaObj.private=!1);e.sharedAreaObj[r[o]._id]||(e.sharedAreaObj[r[o]._id]=!1,e.sharedAreaObj.group=!1)}else for(var a in r){for(var i in t.group){var s;(s=t.group[i])===r[a].group._id&&"confirmed"===r[a].status&&s&&(e.sharedAreaObj[s]=!0)}e.sharedAreaObj[r[a].group._id]||(e.sharedAreaObj[r[a].group._id]=!1,e.sharedAreaObj.group=!1)}e.sharedAreaObj.publicProject=t.isopen,e.sharedAreaObj.private=!t.isopen&&e.getEnableGroupId()},e.getEnableGroupId=function(){var t=["publicProject","private","group"];for(var r in e.sharedAreaObj){var n=e.sharedAreaObj[r];if(!(t.indexOf(r)>-1)&&n)return!1}return!0},e.isSharedChecked=function(t){return e.sharedAreaObj[t]},e.getComment=function(){r({method:"GET",url:"/api/comment/project/list/".concat(projectId,"/").concat(e.commentOption.page),params:{targetType:e.type,group:e.groupId}}).success((function(t,r){e.comments=t,e.getCommentCount(),e.project&&(e.project.currentCommentGroup=t.length)}))},e.getCommentCount=function(){r({method:"GET",url:"/api/comment/project/count/".concat(projectId),params:{targetType:e.type,group:e.groupId}}).success((function(t,r){e.commentCount=t,e.totalPages=Math.ceil(t/e.commentOption.rows);var n=Math.ceil(t/e.commentOption.rows),o=Math.ceil(e.currentPage/10),a=1===o?1:10*o-9;e.currentPage>5&&e.currentPage+5<n&&(a=e.currentPage-4),n>a+9&&(n=a+9),e.lastPage=n,e.pageList=[];for(var i=a;i<=n;i++)e.pageList.push(i)}))},e.setPage=function(t){return!(t<1)&&!(t>e.staticPageList)&&(e.beforePage=e.commentOption.page,e.commentOption.page=t,e.currentPage=t,e.beforePage!=t&&void e.getComment())},e.prevPageGroup=function(){var t=e.currentPage;if(t||(t=1),!(t>10))return!1;e.currentPage-=10,e.setPage(e.currentPage)},e.nextPageGroup=function(){var t=e.currentPage;t||(t=1);var r=Math.ceil(e.commentCount/e.commentOption.rows);if(!(e.pageList[0]+9<r))return!1;e.currentPage+=10,e.setPage(e.currentPage)},e.getLikes=function(){var t="/api/project/likes/".concat(e.project._id),n={targetSubject:"project",targetType:e.type,rows:e.likeShown,group:e.groupId};r({method:"GET",url:t,params:n}).then((function(t){if(200===t.status){if(t.data){var r=[];t.data.map((function(e){r.push(e.user)})),e.project.like=r,e.project.currentLikeCntGroup=r.length}}else entrylms.alert(Lang.Msgs.error_occured)}),(function(e){!locationWillChange&&entrylms.alert(Lang.Msgs.error_occured)}))},e.hoverSocial=function(t){e.currentSocial=t},e.getCVServer=function(){var e=c(o.a.mark((function e(t){var r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i()({method:"GET",url:"/api/cloudVariable/".concat(t)});case 3:return r=e.sent,n=r.data,e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),console.warn(e.t0);case 11:return e.abrupt("return",{});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),e.injectProject=c(o.a.mark((function t(){var n,a,i,s,c,u,p,l,d,g,f,h,y,_;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="/api/project/mylike/".concat(e.project._id),a={targetSubject:"project",targetType:e.type,group:e.groupId},r({method:"GET",url:n,params:a}).then((function(t){200===t.status?t.data&&(e.isLikeThis=!0):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)})),i=document.getElementById("entryProjectView"),(s=document.createElement("div")).className="modal",s.style.position="absolute",s.style.zIndex=101,s.style.overflow="hidden",i.appendChild(s),c=new EntryTool.ModalProgress({container:s,isShow:!1,theme:"entry"}),t.prev=11,Entry.init(i,{type:"minimize",fonts:EntryStatic.fonts,libDir:"/lib",useWebGL:window.useWebGL}),t.next=15,e.getCVServer(e.project._id);case 15:if(u=t.sent,Entry.cloudVariable.setServerInfo(u),!e.project.hasRealTimeVariable){t.next=21;break}return Entry.cloudVariable.setDefaultData(e.project.realTimeVariable),t.next=21,Entry.cloudVariable.connect(u);case 21:(p=Entry.addEventListener.bind(Entry))("showVideoLoadingScreen",(function(){c.show({type:"loading",mode:"minimize",title:Lang.Msgs.ai_utilize_video_loading})})),p("hideLoadingScreen",(function(){c.hide()})),t.next=29;break;case 26:t.prev=26,t.t0=t.catch(11),"webgl not supported"==t.t0.message?entrylms.alert(Lang.Menus.gl_not_supported).on("hide",(function(){m.put("use_webgl","0"),document.location.reload()})):console.warn(t.t0);case 29:for(h in Entry.loadProject(e.project),l=Entry.container.objects_,d=0,g=0,f=0,l)y=l[h],d+=y.pictures.length,g+=y.sounds.length,f+=y.script.getBlockList(!0).length;v((function(){e.numberOfPictures=d,e.numberOfSounds=g,e.numberOfBlocks=f})),_=Entry.Utils.getUsedFonts(e.project),Entry.Utils.waitForWebfonts(_,(function(){window.fontloaded=!0,Entry.dispatchEvent("fontLoaded"),Entry.stage.updateForce()})),Entry.addEventListener("run",(function(){e.toggleEntryStop(!1)})),Entry.addEventListener("stop",(function(){e.toggleEntryStop(!0)})),Entry.addEventListener("dispatchEventDidToggleStop",e.handleSaveVariable),e.numberOfBlocks=0,e.numberOfPictures=0,e.numberOfSounds=0;case 44:case"end":return t.stop()}}),t,null,[[11,26]])}))),e.handleSaveVariable=function(){var n=e.project._id;if(n){var o=Entry.exportProject().variables;r({method:"POST",url:"/api/project/variable/".concat(n),headers:{"csrf-token":t.csrfToken()},data:{variables:o.filter((function(e){return e.isCloud}))}})}},e.openProject=function(){var t="workspace";e.project.isPracticalCourse&&(t="practical_course"),location.href="/ws?type=".concat(t,"#!/").concat(e.project._id,"/").concat(e.groupId)},e.keydownPrevent=function(e){e.stopPropagation()},e.toggleEntryStop=function(t){e.$apply((function(){e.isEntryStop=t}))},e.likeProject=function(){if(e.currentUser&&!e.isEditLike)if(e.isEditLike=!0,e.isLikeThis){var n="/api/project/unlike/".concat(e.project._id),o={targetSubject:"project",targetType:e.type,group:e.groupId};r({method:"DELETE",url:n,params:o,headers:{"csrf-token":t.csrfToken}}).then((function(t){200===t.status?(e.isLikeThis=!1,e.isEditLike=!1,e.project.currentLikeCntGroup>0&&(e.project.currentLikeCntGroup-=1),e.project.like=[],e.getLikes()):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)}))}else n="/api/project/like/".concat(e.project._id),o={targetSubject:"project",targetType:e.type,group:e.groupId,_csrf:t.csrfToken()},r({method:"POST",url:n,data:o}).then((function(t){200===t.status?(e.project.like||(e.project.like=[]),e.project.like=[],e.getLikes(),e.isLikeThis=!0,e.isEditLike=!1,e.project.currentLikeCntGroup++):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)}))},e.interestProject=function(){if(e.currentUser&&!e.isEditInterest&&!e.isEditInterest){e.isEditInterest=!0;var n="/api/project/favorite/".concat(e.project._id),o={targetSubject:"project",targetType:e.type,group:e.groupId,rows:e.interestShown};e.isInterestThis?r({method:"DELETE",url:n,params:o,headers:{"csrf-token":t.csrfToken()}}).then((function(t){200===t.status?(e.isInterestThis=!1,e.isEditInterest=!1,r.get("/api/project/favorites/".concat(e.project._id),{params:o}).success((function(t,r){e.project.currentFavoriteCntGroup=t.total,e.project.interest=t.favorites}))):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)})):r({method:"POST",url:n,data:o,headers:{"csrf-token":t.csrfToken()}}).then((function(t){200===t.status?(e.isInterestThis=!0,e.isEditInterest=!1,r.get("/api/project/favorites/".concat(e.project._id),{params:o}).success((function(t,r){e.project.currentFavoriteCntGroup=t.total,e.project.interest=t.favorites}))):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)}))}},e.commentUpload=function(){var e=$(".commentText").eq(0).val().trim();if(""===e)return entrylms.alert("내용을 입력하세요."),!1;r.post("/api/user/checkfiltercontent",{_csrf:t.csrfToken(),content:e}).success((function(r){r.ok?b(e):t.setBadUser((function(){b(t.getRandomReplaceWord())}))})).error((function(t){b(e)}))},e.editedCommentUpload=function(e){""!==e.content.trim()?r.post("/api/user/checkfiltercontent",{_csrf:t.csrfToken(),content:e.content}).success((function(r){r.ok?w(e):t.setBadUser((function(){e.content=t.getRandomReplaceWord(),w(e)}))})).error((function(t){w(e)})):entrylms.alert("내용을 입력해 주세요.")},e.editComment=function(e){e.editing=!0},e.deleteComment=function(n){var o={target:e.project._id,targetSubject:"project",targetType:e.type,group:e.groupId,_csrf:t.csrfToken()};r.delete("/api/comment/".concat(n._id),{params:o}).success((function(){for(var t in e.comments)e.comments[t]._id===n._id&&e.comments.splice(t,1),t++;e.getComment()}))},e.shareFB=function(){var t="http://www.facebook.com/sharer/sharer.php?s=100&p[url]=".concat(e.shortenUrl,"&p[images][0]=https://playentry.org").concat(e.project.thumb,"&p[summary]=엔트리 ").concat(e.project.name);window.open(t,"fb","width=600px, height=450px")},e.shareTW=function(){var t=encodeURIComponent(e.project.name),r=encodeURIComponent("엔트리"),n="".concat("https://twitter.com/intent/tweet","?hashtags=").concat(r,"&original_referer=").concat(encodeURIComponent("https://playentry.org"),"&source=tweetbutton&text=").concat(t,"&url=").concat(e.shortenUrl);window.open(n,"tweet","width=600px, height=250px")},e.popupReport=function(t,r,n){var o={};o.project=e.project,o.type=t,o.discuss=r,o.comment=n,o.group=e.groupId,$.event.trigger($.Event("popupReport",{info:o}))},e.getProjectCategory=function(e){switch(e){case"애니메이션":return Lang.EntryStatic.category_animation;case"게임":return Lang.EntryStatic.category_game;case"미디어아트":return Lang.EntryStatic.category_media_art;case"피지컬":return Lang.EntryStatic.category_physical;default:return Lang.EntryStatic.category_etc}},e.agreeConfirm=function(){!e.isEditing||e.sharedAreaObj.private?e.setEditing(!1):function(){for(var t in e.personalAgree){if(1!=e.personalAgree[t])return e.isAgreeProjectTermAll=!0,void(e.isAgreeProjectTerm=!1);e.isAgreeProjectTermAll=!1,e.isAgreeProjectTerm=!0}e.setEditing(!1)}()},e.setEditing=function(n){for(var o in 1==e.sharedAreaObj.publicProject?e.project.isopen=!0:e.project.isopen=!1,e.project.group=[],e.sharedAreaObj){var a=e.sharedAreaObj[o];"publicProject"!=o&&"private"!=o&&"group"!=o&&a&&e.project.group.push(o)}for(var o in e.isEditing=n,e.personalAgree)e.personalAgree[o]=!1;n||r.put("/api/project/".concat(e.project._id),{_csrf:t.csrfToken(),category:e.project.category,name:e.project.name,isopen:e.project.isopen,description:e.project.description,group:e.project.group}).then((function(t){200===t.status&&t.data?(e.project=t.data,e.setBeforeProject(e.project),r.get("/api/group/search/".concat(e.project.group)).then((function(e){console.log("successfully inserted")}))):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)})),e.getProjectCategory(e.project.category),e.setBeforeShared(e.project)},e.cancelEditing=function(){!function(t,r){t.category=r.category,t.description=r.description,t.isopen=r.isopen,t.name=r.name,t.group=r.group,e.setSharedList(t,e.groupList)}(e.project,e.beforeUpdateProject),e.sharedAreaObj=e.deepSharedArea,e.isEditing=!1},e.toggleProjectOpen=function(){e.project.isopen=!e.project.isopen},e.setCategory=function(t){e.project.category=t,$.each(e.status,(function(t,r){e.status[t]=!1}))},e.removeProject=function(){entrylms.confirm(Lang.Menus.remove_project).then((function(n){!0===n&&r.post("/api/project/group/remove",{_csrf:t.csrfToken(),project_id:e.project._id,idx:e.groupId}).then((function(e){window.history.back()}),(function(e){entrylms.alert(Lang.Msgs.error_occured)}))}))},e.setIsopen=function(t){e.project.isopen=t,e.setIsOpenButton()},e.showLockImg=function(){return null!=e.global&&null!=e.project&&e.project.user.username==e.global.user.username},e.setIsOpenButton=function(){e.isOpenButton=!e.isOpenButton},e.hasMore=function(t){var r=e.project;return!!r&&!!r.like&&("like"==t?r.like.length>e.likeShown:"interest"==t&&r.interest?r.interest.length>e.interestShown:void 0)},e.seeMore=function(t){return"like"==t?e.likeShown+=10:"interest"==t?e.interestShown+=10:void 0},e.toggleOpen=function(){e.toggle=!e.toggle},e.togglePersonal=function(t){if("all"==t&&0==e.personalAgree.all)for(var r in e.isAgreeProjectTerm=!1,e.isAgreeProjectTermAll=!1,e.personalAgree)e.personalAgree[r]=!0;else if("all"==t&&1==e.personalAgree.all)for(var r in e.personalAgree)e.personalAgree[r]=!1;if("all"!=t){e.personalAgree[t]=!e.personalAgree[t];var n=e.personalAgree;n.open&&n.use&&n.edit&&(e.personalAgree.all=!0)}1==e.personalAgree.all&&(e.personalAgree[t]||(e.personalAgree.all=!1))},e.viewHelp=function(){window.open("/#!/terms/project","_blank")},e.generateSharedList=function(){var t=[],r=e.sharedAreaObj;r.publicProject&&t.push(Lang.EntryStatic.publicProject);var n=e.groupList.filter((function(e){return!e.student||!e.student.user||"confirmed"==e.student.status}));if(e.sharedgroupList=n,n.length>0)for(var o in n){var a=n[o];r[a._id]&&t.push(a.name)}return r.private&&t.push(Lang.EntryStatic.private),t.length?t.join(", "):Lang.Menus.select_share_area},e.selectShared=function(t){switch(e.sharedSelected=!0,e.sharedAreaObj[t]=!e.sharedAreaObj[t],t){case"private":if(e.sharedAreaObj[t]){for(var r in e.sharedAreaObj)e.sharedAreaObj[r]=!1;for(var n in e.sharedAreaObj.private=!0,e.personalAgree)e.personalAgree[n]=!1}break;case"publicProject":e.sharedAreaObj[t]&&(e.sharedAreaObj.private=!1);break;case"group":for(var r in e.sharedAreaObj)"publicProject"!=r&&"private"!==r&&(e.sharedAreaObj[r]=e.sharedAreaObj.group);e.sharedAreaObj[t]||e.sharedAreaObj.publicProject?e.sharedAreaObj.private=!1:e.sharedAreaObj.private=!0;break;default:var o=!1;if(e.sharedAreaObj[t]){e.sharedAreaObj.private=!1;var a=["publicProject","private","group"];for(var n in e.sharedAreaObj){var i=e.sharedAreaObj[n];if(!(a.indexOf(n)>-1||i)){o=!0;break}}e.sharedAreaObj.group=!o}else e.sharedAreaObj.group=!1}!e.sharedAreaObj.publicProject&&e.getEnableGroupId()&&(e.sharedAreaObj.private=!0)},e.setBeforeProject=function(t){e.beforeUpdateProject=JSON.parse(JSON.stringify(t))},e.setBeforeShared=function(t){e.deepSharedArea=JSON.parse(JSON.stringify(e.sharedAreaObj))},e.list=function(){returnUrl&&"undefined"!=returnUrl?location.href=decodeURIComponent(returnUrl):location.href="/all#!/group?groupId=".concat(e.groupId)}}])},1091:function(e,t){angular.module("mean.arts.all").controller("ArtsAnalysisController",["$scope","$routeParams","$location","$uibModal","$log","$http","Global","Projects","myProject","$timeout",function(e,t,r,n,o,a,i,s,c,u){e.blocksInfo={},EntryStatic.blockInfo;var p=0;getProject=function(t){t?a({method:"GET",url:"/all/analysis/"+t}).success((function(t,r){e.blocksInfo=t,p=Object.keys(t.projectBlocks).length,l(e.blocksInfo),drawBlocks()})):entrylms.alert("프로젝트 아이디를 입력 하세요 .")},e.searchProject=function(e){e=$("#analysisSearchName").val(),getProject(e)},drawBlocks=function(){var t=l(e.blocksInfo);if(p<=0)entrylms.alert("프로젝트 블록의 개수가 0 입니다.");else{var r=google.visualization.arrayToDataTable(t),n={title:"number of blocks in this project",vAxis:{title:"Number of blocks"},hAxis:{ticks:[0,Math.ceil(e.hArea/3),Math.ceil(e.hArea/1.5),e.hArea]},seriesType:"bars",bar:{groupWidth:"100%"}};new google.visualization.ComboChart(document.getElementById("chart_div")).draw(r,n)}};var l=function(t){var r=[],n=t.categoryBlocks;return delete(t=t.projectBlocks).undefined,r[0]=Object.keys(t).map((function(e){return e})),r[1]=Object.keys(t).map((function(e){return t[e]})),setCategoryTotal(n),r[0].unshift("name"),r[1].unshift("Blocks"),e.hArea=name.length,r};setCategoryTotal=function(e){var t=[];return t[0]=Object.keys(e).map((function(e){return e})),t[1]=Object.keys(e).map((function(t){return e[t]})),t[0].unshift("Blocks"),t[1].unshift("Category"),drawCategoryBlocks(t),t},drawCategoryBlocks=function(e){var t=e[0].length;if(t<=0)entrylms.alert("프로젝트 블록의 개수가 0 입니다.");else{var r=google.visualization.arrayToDataTable(e),n={title:"number of Category blocks in this project",vAxis:{title:"number of Category"},hAxis:{ticks:[0,Math.ceil(t/3),Math.ceil(t/1.5),t]},seriesType:"bars",bar:{groupWidth:"100%"}};new google.visualization.ComboChart(document.getElementById("chart_div_2")).draw(r,n)}}}])},1092:function(e,t,r){"use strict";angular.module("mean.arts.all").controller("ExhibitModalController",["$scope","$uibModalInstance","Global","$http","$sce","type",function(e,t,r,n,o,a){function i(t){e.projectList=[],e.projectCount=Number(t.count);var r=Number(t.skip),n=6*(e.page-1)-r,o=n+6;t.data.map((function(t,r){r>=n&&r<o&&e.projectList.push(t)})),e.generatePageList()}e.global=r,e.type=a,e.userId=r.user._id,e.selectedVideo="",e.inputYoutubeUrl="",e.projectList=[],e.global=r,e.timestamp=(new Date).getTime(),e.isAgreeProjectTermAll=!1,e.isAgreeProjectTerm=!1,e.selectedView="myProject",e.artCategories=EntryStatic.artCategories,e.sortOptions=EntryStatic.artSortOptions,e.periodOptions=EntryStatic.artPeriodOptions,e.status={isCategoryOpen:!1,isSortOpen:!1,isPeriodOpen:!1},e.conditions=[{name:"category",value:"",label:"모든주제"},{name:"sort",value:"updated",label:"최신순"},{name:"period",value:"",label:"전체"},{name:"rows",value:6},{name:"page",value:1},{name:"name",value:""}],e.personalAgree={open:!1,use:!1,edit:!1,all:!1},e.init=function(){e.selectedVideo="",e.conditions.push({name:"user",value:e.userId}),e.cachedResult={},e.page=1,e.setOption({page:1},!0),e.applyImages()},e.find=function(){var t=e.cachedResult,r=6*(e.page-1)+1;if(!t.data||r>t.data.length+t.skip){var o=s();o="all"!==e.type&&e.type?"/api/project/find?blamed=false&option=list&notGroupId="+e.type+"&"+s():"/api/project/find?blamed=false&option=list&isopen=false&"+s(),n({method:"GET",url:o}).success((function(t,r){e.cachedResult=t,i(e.cachedResult)})).error((function(t,r){e.status=r,i(e.cachedResult)}))}else i(t)},e.generatePageList=function(){var t;t="myProject"==e.selectedView?e.projectCount:e.favoriteCount,e.page=e.getOption("page").value;var r=Math.ceil(t/6),n=Math.ceil(e.page/10),o=1===n?1:10*n-9;r>o+9&&(r=o+9),e.lastPage=r,e.pageList=[];for(var a=o;a<=r;a++)e.pageList.push(a)},e.setLastPage=function(){var t;t="myProject"==e.selectedView?e.projectCount:e.favoriteCount;var r=Math.ceil(t/6);e.setPage(r)},e.setPage=function(t){t<e.page&&(e.cachedResult={}),e.page=t,e.setOption({name:"page",value:t})},e.setOption=function(t,r){for(var n in"category"!==t.name&&"name"!==t.name||(t.value=encodeURIComponent(t.value)),e.conditions){var o=e.conditions[n];o.name===t.name&&(o.value=t.value,o.label=t.label),r&&"page"===o.name&&(e.cachedResult={},o.value=1)}e.find(),$.each(e.status,(function(t,r){e.status[t]=!1}))},e.getOption=function(t){for(var r=0,n=e.conditions.length;r<n;r++)if(e.conditions[r].name===t)return e.conditions[r]},e.getLang=function(t){var r,n,o=e.getOption(t),a=decodeURI(o.value);for(var i in"category"==t?n=e.artCategories:"sort"==t?n=e.sortOptions:"period"==t&&(n=e.periodOptions),n)if(n[i].key=="art_"+o.name+"_"+a){r=n[i];break}return r.lang};var s=function(){for(var t="",r=0,n=e.conditions.length;r<n;r++){var o=e.conditions[r];o.value&&""!=o.value&&(t+=o.name+"="+o.value,r<n-1&&(t+="&"))}return t};e.searchWord="",e.search=function(){e.isSearch=!0;var t=$("#MprojectSearchInput").val();e.setOption({name:"name",value:t},!0)},e.prevPage=function(){var t=e.page;t||(t=1),t>1?e.setPage(t-1):entrylms.alert("처음 입니다.")},e.nextPage=function(){var t=e.page;t||(t=1),("myProject"===e.selectedView?Math.ceil(e.projectCount/Number(e.getOption("rows").value)):Math.ceil(e.favoriteCount/Number(e.getOption("rows").value)))>t?e.setPage(t+1):entrylms.alert("마지막 페이지 입니다.")},e.hasPrevPage=function(){var t=Number(e.getOption("page").value);return t||(t=1),"projectNavigationPre"},e.hasNextPage=function(){var t=Number(e.getOption("page").value);return t||(t=1),"myProject"===e.selectedView?Math.ceil(e.projectCount/Number(e.getOption("rows").value)):Math.ceil(e.favoriteCount/Number(e.getOption("rows").value)),"projectNavigationNext"},e.applyImages=function(){var t=e.userId;if(e.global.user.blogImage){var r="/uploads/profile/"+t.substring(0,2)+"/"+t.substring(2,4)+"/blog_"+t+".png?"+(new Date).getTime();$(".psListTopWrapper").css("background-image","url('"+r+"')")}else $(".psListTopWrapper").css("background-image","url('/img/assets/art/blog_basic_1.png')");if(e.global.user.avatarImage){var n="/uploads/profile/"+t.substring(0,2)+"/"+t.substring(2,4)+"/avatar_"+t+".png?"+(new Date).getTime();$(".psListInfoProfileThumb").attr("src",n),$(".psListTopThumb").attr("src",n)}else $(".psListInfoProfileThumb").attr("src","/img/assets/profile_basic.png"),$(".psListTopThumb").attr("src","/img/assets/profile_basic.png")},e.urlChange=function(){var t=document.getElementById("videoLink").value;if(t){var r=t.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);r&&11==r[7].length?e.video=r[7]:e.video=null}},e.trustUrl=function(e){return o.trustAsResourceUrl(e)},e.selectProject=function(t){e.selectedProject===t?e.selectedProject=null:e.selectedProject=t},e.cancel=function(){t.dismiss("cancel")},e.ok=function(r){if("project"==r){if(!e.selectedProject)return void entrylms.alert("작품을 선택해 주세요.");if(!e.personalAgree.all){for(var n in e.personalAgree)if(e.personalAgree[n])return e.isAgreeProjectTerm=!1,void(e.isAgreeProjectTermAll=!0);return e.isAgreeProjectTermAll=!1,void(e.isAgreeProjectTerm=!0)}e.selectedVideo=null,t.close({selectedItem:e.selectedProject})}else"video"==r&&(function(){var t=document.getElementById("videoLink").value;e.selectedVideo=t}(),e.selectedProject=null,t.close({selectedItem:e.selectedVideo}))},e.goToMakeWs=function(){t.dismiss("cancel"),window.location.href="/ws"},e.togglePersonal=function(t){if("all"==t&&0==e.personalAgree.all)for(var r in e.personalAgree)e.personalAgree[r]=!0;else if("all"==t&&1==e.personalAgree.all)for(var r in e.personalAgree)e.personalAgree[r]=!1;if("all"!=t){e.personalAgree[t]=!e.personalAgree[t];var n=e.personalAgree;n.open&&n.use&&n.edit&&(e.personalAgree.all=!0)}1==e.personalAgree.all&&(e.personalAgree[t]||(e.personalAgree.all=!1))}}])},1356:function(e,t,r){r(1086),r(501),r(268),r(322),r(292),r(1087),r(1088),r(1089),r(1357),r(1358),r(1359),r(1090),r(1091),r(269),r(293),r(1092),r(502),r(503),r(504),r(663),r(664),r(659)},1357:function(e,t,r){"use strict";r.r(t);var n=r(6),o=r.n(n),a=r(505),i=r.n(a);function s(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){s(a,n,o,i,c,"next",e)}function c(e){s(a,n,o,i,c,"throw",e)}i(void 0)}))}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}angular.module("mean.arts.individualView").controller("ArtsViewController",["$scope","Global","$http","$routeParams","$uibModal","$sce","Projects","myProject","Comments","Users","Feedback","$cookies","$rootScope","UnloadEmitter","CloudCache","$timeout",function(e,t,r,n,a,s,p,l,d,g,f,m,h,v,y,b){e.currentPage=1,e.currentSocial="like",e.global=t,e.isAuth=t.authenticated,e.isStudent=t.isStudent(),e.isEntryStop=!0,e.commentText="",e.currentUser=window.user,e.shortenUrl=window.shortUrl,e.isEditing=!1,e.report={},e.toggle=!1,e.beforeUpdateProject={},e.isOpenButton=!1,e.nonePerson=Lang.Menus.none_person,e.likeShown=10,e.interestShown=10,e.type="individual",e.sharedSpace=["publicProject","group","private"],e.isAgreeProjectTermAll=!1,e.isAgreeProjectTerm=!1,e.status={isCategoryOpen:!1},e.adminList=t.getAdminUserList()||[];var w=!1;h.$on("pageLeave",(function(){w=!0})),e.global.user||(e.global.user={}),e.sharedgroupList=[],e.sharedAreaObj={},e.sharedSelected=!0,e.personalAgree={open:!1,use:!1,edit:!1,all:!1},e.commentOption={rows:5,page:1},e.isLang=function(e){return(m.get("lang")||"ko")===e},e.available=!1;var L=window.useWebGL;function j(n){r.post("/api/comment",{headers:{"limit-type":"email"},content:n,target:e.project._id,targetSubject:"project",targetType:e.type},{headers:{"csrf-token":t.csrfToken(),"limit-type":"individual"}}).success((function(t,r){"warnAbuse"===t&&entrylms.alert(Lang.Menus.discuss_write_abuse_warn),e.commentOption.page=1,e.commentText="",e.getComment()})).error((function(t,r){var n=r||0;"abuse"===t||429===n?entrylms.alert(Lang.Menus.discuss_write_abuse_detected):403==n&&"pwmerror"===t.msg?entrylms.alert(Lang.Menus.fword_alert_1):510===r?(entrylms.alert(Lang.Menus.discuss_write_abuse_warn),e.commentOption.page=1,e.commentText="",e.getComment()):509===r?entrylms.alert(Lang.Menus.discuss_write_abuse_detected):entrylms.alert(Lang.Menus.no_permission)}))}function E(e){r.put("/api/comment/".concat(e._id),{content:e.content},{headers:{"csrf-token":t.csrfToken()}}).success((function(t){e.editing=!1}))}function k(t){var r=e.personalAgree;_.each(r,(function(e,n){r[n]=t}))}e.glModeName=L?"ON":"OFF",e.toggleWebGL=function(){m.put("use_webgl",L?"0":"1"),document.location.reload()},e.getLikes=function(){var t="/api/project/likes/".concat(e.project._id),n={targetSubject:"project",targetType:e.type,rows:e.likeShown};r({method:"GET",url:t,params:n}).then((function(t){if(200===t.status){if(t.data){var r=t.data.map((function(e){return e.user}));e.project.like=r}}else entrylms.alert(Lang.Msgs.error_occured)}),(function(e){!w&&entrylms.alert(Lang.Msgs.error_occured)}))},e.getInterests=function(){var t="/api/project/isfavorite/".concat(e.project._id),n={targetSubject:"project",targetType:e.type};r({method:"GET",url:t,params:n}).success((function(t,r){e.isInterestThis=t.exists})).error((function(t,r){e.status=r,e.isInterestThis=!1})),n={targetSubject:"project",targetType:e.type,rows:e.interestShown},r.get("/api/project/favorites/".concat(e.project._id),{params:n}).success((function(t,r){e.project.interestCnt=t.total,e.project.interest=t.favorites}))},e.init=function(){$("body").on("keydown","input, textarea",(function(e){e.stopPropagation&&e.stopPropagation()})),w=!1,window.user&&window.user.role,r({method:"GET",url:"/api/project/".concat(projectId,"?like=true")}).success((function(n,o){delete n.like,n.name=t.htmldecode(n.name),e.project=n,!n.isopen&&_.isEmpty(n.group)||k(!0),function(t){var r=!t.isopen,n=t.user._id,o=e.global.user;r&&n!==o._id&&"admin"!==o.role?entrylms.alert(Lang.Menus.private_project).on("hide",(function(){e.list()})):e.available=!0}(n),n.parent&&r({method:"GET",url:"/api/project/".concat(n.parent)}).success((function(t,r){"object"==u(t)?(e.originPrj=t,e.isParentAlive=!0,e.parentProjectName=t.name||Lang.Menus.basic_project,e.parentUserName=t.user.username):e.isParentAlive=!1})),e.getLikes(),e.getInterests(),e.initSharedList(n),e.setBeforeProject(n),e.injectProject(),$("[data-toggle='dropdown']").parent().on("hidden.bs.dropdown",(function(t){e.sharedSelected&&($(".projectBuildDropdown").addClass("open"),e.sharedSelected=!1)})),e.getComment()})).error((function(t){entrylms.alert(Lang.Menus.no_permission).on("hide",(function(){e.list()}))}))},e.initSharedList=function(t){var n,o=window.user?window.user.role:null;e.currentUser&&t.user._id===e.currentUser._id&&(n="teacher"===o?"/api/group/groups/".concat(window.user._id):"/api/student/groups/".concat(window.user._id,"?all=true&page=1&rows=999"),r.get(n).success((function(n){"teacher"==o?r({method:"GET",url:"/api/group/findByMember/".concat(window.user._id,"?page=1&rows=999")}).success((function(r,o){r&&r.length>0&&(n=n.concat(r)),e.groupList=n,e.setSharedList(t,n)})):(e.groupList=n.map((function(e){return e.group})),e.setSharedList(t,e.groupList))})))},e.getComment=function(){r({method:"GET",url:"/api/comment/project/list/".concat(projectId,"/").concat(e.commentOption.page),params:{targetType:e.type}}).success((function(t,r){e.comments=t,e.getCommentCount()}))},e.getCommentCount=function(){r({method:"GET",url:"/api/comment/project/count/".concat(projectId),params:{targetType:e.type}}).success((function(t,r){e.commentCount=t,e.totalPages=Math.ceil(t/e.commentOption.rows);var n=Math.ceil(t/e.commentOption.rows),o=Math.ceil(e.currentPage/10),a=1===o?1:10*o-9;e.currentPage>5&&e.currentPage+5<n&&(a=e.currentPage-4),n>a+9&&(n=a+9),e.lastPage=n,e.pageList=[];for(var i=a;i<=n;i++)e.pageList.push(i)}))},e.setPage=function(t){return!(t<1)&&!(t>e.totalPages)&&(e.beforePage=e.commentOption.page,e.commentOption.page=t,e.currentPage=t,void(e.beforePage!=t&&e.getComment()))},e.prevPageGroup=function(){var t=e.currentPage;if(t||(t=1),!(t>10))return!1;e.currentPage-=10,e.setPage(e.currentPage)},e.nextPageGroup=function(){var t=e.currentPage;t||(t=1);var r=Math.ceil(e.commentCount/e.commentOption.rows);if(!(e.pageList[0]+9<r))return!1;e.currentPage+=10,e.setPage(e.currentPage)},e.hoverSocial=function(t){e.currentSocial=t},e.getCVServer=function(){var e=c(o.a.mark((function e(t){var r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i()({method:"GET",url:"/api/cloudVariable/".concat(t)});case 3:return r=e.sent,n=r.data,e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),console.warn(e.t0);case 11:return e.abrupt("return",{});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),e.injectProject=c(o.a.mark((function n(){var a,i,s,u,p,l,d,g,f,h,v,y,_,w;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.authenticated&&(a="/api/project/mylike/".concat(e.project._id),i={targetSubject:"project",targetType:e.type},r({method:"GET",url:a,params:i}).then((function(t){t.data&&(e.isLikeThis=!0)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)}))),s=document.getElementById("entryProjectView"),(u=document.createElement("div")).className="modal",u.style.position="absolute",u.style.zIndex=101,u.style.overflow="hidden",s.appendChild(u),p=new EntryTool.ModalProgress({container:u,isShow:!1,theme:"entry"}),n.prev=9,Entry.init(s,{type:"minimize",fonts:EntryStatic.fonts,libDir:"/lib",useWebGL:window.useWebGL}),n.next=13,e.getCVServer(e.project._id);case 13:if(l=n.sent,Entry.cloudVariable.setServerInfo(l),!e.project.hasRealTimeVariable){n.next=19;break}return Entry.cloudVariable.setDefaultData(e.project.realTimeVariable),n.next=19,Entry.cloudVariable.connect();case 19:(d=Entry.addEventListener.bind(Entry))("showVideoLoadingScreen",(function(){p.show({type:"loading",mode:"minimize",title:Lang.Msgs.ai_utilize_video_loading})})),d("hideLoadingScreen",(function(){p.hide()})),n.next=27;break;case 24:n.prev=24,n.t0=n.catch(9),"webgl not supported"==n.t0.message?entrylms.alert(Lang.Menus.gl_not_supported).on("hide",(function(){m.put("use_webgl","0"),document.location.reload()})):console.warn(n.t0);case 27:for(y in Entry.loadProject(e.project),g=Entry.container.objects_,f=0,h=0,v=0,g)_=g[y],f+=_.pictures.length,h+=_.sounds.length,v+=_.script.getBlockList(!0).length;b((function(){e.numberOfPictures=f,e.numberOfSounds=h,e.numberOfBlocks=v})),w=Entry.Utils.getUsedFonts(e.project),Entry.Utils.waitForWebfonts(w,(function(){window.fontloaded=!0,Entry.dispatchEvent("fontLoaded"),Entry.stage.updateForce()})),Entry.addEventListener("run",c(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.toggleEntryStop(!1);case 1:case"end":return t.stop()}}),t)})))),Entry.addEventListener("stop",(function(){e.toggleEntryStop(!0)})),Entry.addEventListener("dispatchEventDidToggleStop",e.handleSaveVariable),e.numberOfBlocks=0,e.numberOfPictures=0,e.numberOfSounds=0;case 42:case"end":return n.stop()}}),n,null,[[9,24]])}))),e.handleSaveVariable=function(){var n=e.project._id;if(n){var o=Entry.exportProject().variables;r({method:"POST",url:"/api/project/variable/".concat(n),headers:{"csrf-token":t.csrfToken()},data:{variables:o.filter((function(e){return e.isCloud}))}})}},e.openProject=function(){var t="workspace";e.project.isPracticalCourse&&(t="practical_course"),location.href="/ws/".concat(e.project._id,"?type=").concat(t)},e.toggleEntryStop=function(t){e.$apply((function(){e.isEntryStop=t}))},e.likeProject=function(){if(e.currentUser&&!e.isEditLike&&"student"!=e.currentUser.role)if(e.isEditLike=!0,e.isLikeThis){var n="/api/project/unlike/".concat(e.project._id),o={targetSubject:"project",targetType:e.type};r({method:"DELETE",url:n,params:o,headers:{"csrf-token":t.csrfToken()}}).then((function(t){200===t.status?(e.isLikeThis=!1,e.isEditLike=!1,e.project.likeCnt>0&&e.project.likeCnt--,e.project.like=[],e.getLikes()):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)}))}else n="/api/project/like/".concat(e.project._id),o={targetSubject:"project",targetType:e.type},r({method:"POST",url:n,data:o,headers:{"csrf-token":t.csrfToken()}}).then((function(t){200===t.status?(e.project.like||(e.project.like=[]),e.project.like=[],e.getLikes(),e.isLikeThis=!0,e.isEditLike=!1,e.project.likeCnt++):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)}))},e.interestProject=function(){if(e.currentUser&&!e.isEditInterest&&"student"!=e.currentUser.role){var n=e.project.interest.map((function(t){return t.target==e.project._id}));if(!e.project.isopen&&n.indexOf(!0)<=-1)entrylms.alert(Lang.Menus.cannnot_mark_favorite);else{e.isEditInterest=!0;var o="/api/project/favorite/".concat(e.project._id),a={targetSubject:"project",targetType:e.type,rows:e.interestShown};e.isInterestThis?r({method:"DELETE",url:o,params:a,headers:{"csrf-token":t.csrfToken()}}).then((function(t){e.project.interest=[],200===t.status?(e.isInterestThis=!1,e.isEditInterest=!1,a={targetSubject:"project",targetType:e.type,rows:e.interestShown},r.get("/api/project/favorites/".concat(e.project._id),{params:a}).success((function(t,r){e.project.interestCnt=t.total,e.project.interest=t.favorites}))):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)})):r({method:"POST",url:o,data:a,headers:{"csrf-token":t.csrfToken()}}).then((function(t){200===t.status?(e.isInterestThis=!0,e.isEditInterest=!1,e.project.interest=[],a={targetSubject:"project",targetType:e.type,rows:e.interestShown},r.get("/api/project/favorites/".concat(e.project._id),{params:a}).success((function(t,r){e.project.interestCnt=t.total,e.project.interest=t.favorites}))):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)}))}}},e.commentUpload=function(){Entry.Utils.blur();var e=$(".commentText").eq(0).val().trim();if(!e)return entrylms.alert(Lang.Menus.content_required),!1;r.post("/api/user/checkfiltercontent",{content:e},{headers:{"csrf-token":t.csrfToken()}}).success((function(r){r.ok?j(e):t.setBadUser((function(){j(t.getRandomReplaceWord())}))})).error((function(t){j(e)}))},e.editedCommentUpload=function(e){e.content.trim()?r.post("/api/user/checkfiltercontent",{content:e.content},{headers:{"csrf-token":t.csrfToken()}}).success((function(r){r.ok?E(e):t.setBadUser((function(){e.content=t.getRandomReplaceWord(),E(e)}))})).error((function(t){E(e)})):entrylms.alert("내용을 입력해 주세요.")},e.editComment=function(e){e.editing=!0},e.deleteComment=function(n){var o={target:e.project._id,targetSubject:"project",targetType:e.type};r.delete("/api/comment/".concat(n._id),{params:o,headers:{"csrf-token":t.csrfToken()}}).success((function(){e.getComment()}))},e.shareFB=function(){var t="http://www.facebook.com/sharer/sharer.php?s=100&p[url]=".concat(e.shortenUrl,"&p[images][0]=https://playentry.org").concat(e.project.thumb,"&p[summary]=엔트리 ").concat(e.project.name);window.open(t,"fb","width=600px, height=450px")},e.shareTW=function(){var t=encodeURIComponent(e.project.name),r=encodeURIComponent("엔트리"),n="".concat("https://twitter.com/intent/tweet","?hashtags=").concat(r,"&original_referer=").concat(encodeURIComponent("https://playentry.org"),"&source=tweetbutton&text=").concat(t,"&url=").concat(e.shortenUrl);window.open(n,"tweet","width=600px, height=250px")},e.popupReport=function(t,r,n){var o={};o.project=e.project,o.type=t,o.discuss=r,o.comment=n,$.event.trigger($.Event("popupReport",{info:o}))},e.getProjectCategory=function(e){switch(e){case"애니메이션":return Lang.EntryStatic.category_animation;case"게임":return Lang.EntryStatic.category_game;case"미디어아트":return Lang.EntryStatic.category_media_art;case"피지컬":return Lang.EntryStatic.category_physical;default:return Lang.EntryStatic.category_etc}},e.agreeConfirm=function(){!e.isEditing||e.sharedAreaObj.private?e.setEditing(!1):function(){for(var t in e.personalAgree){if(1!=e.personalAgree[t])return e.isAgreeProjectTermAll=!0,void(e.isAgreeProjectTerm=!1);e.isAgreeProjectTermAll=!1,e.isAgreeProjectTerm=!0}e.setEditing(!1)}()},e.setEditing=function(n){var o=!1;for(var a in 1==e.sharedAreaObj.publicProject?e.project.isopen=!0:(e.project.isopen&&(o=!0),e.project.isopen=!1),e.project.group=[],e.sharedAreaObj){var i=e.sharedAreaObj[a];"publicProject"!=a&&"private"!=a&&"group"!=a&&i&&e.project.group.push(a)}e.isEditing=n,n||(o?entrylms.confirm(Lang.Menus.lesson_share_cancel_alert,Lang.Menus.popup_notice).then((function(n){n&&r.put("/api/project/".concat(e.project._id),{category:e.project.category,name:e.project.name,isopen:e.project.isopen,description:e.project.description,group:e.project.group,parent:e.project.parent},{headers:{"csrf-token":t.csrfToken()}}).then((function(t){200===t.status&&t.data?e.setBeforeProject(e.project):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)}))})):r.put("/api/project/".concat(e.project._id),{category:e.project.category,name:e.project.name,isopen:e.project.isopen,description:e.project.description,group:e.project.group,parent:e.project.parent},{headers:{"csrf-token":t.csrfToken()}}).then((function(t){200===t.status&&t.data?e.setBeforeProject(e.project):entrylms.alert(Lang.Msgs.error_occured)}),(function(e){entrylms.alert(Lang.Msgs.error_occured)}))),e.getProjectCategory(e.project.category),e.setBeforeShared(e.project)},e.cancelEditing=function(){!function(t,r){t.category=r.category,t.description=r.description,t.isopen=r.isopen,t.name=r.name,t.group=r.group,e.setSharedList(t,e.groupList)}(e.project,e.beforeUpdateProject),e.sharedAreaObj=e.deepSharedArea,e.isEditing=!1},e.toggleProjectOpen=function(){e.project.isopen=!e.project.isopen},e.setCategory=function(t){e.project.category=t,$.each(e.status,(function(t,r){e.status[t]=!1}))},e.setIsopen=function(t){e.project.isopen=t,e.setIsOpenButton()},e.setIsOpenButton=function(){e.isOpenButton=!e.isOpenButton},e.removeProject=function(){entrylms.confirm(Lang.Menus.remove_project).then((function(n){!0===n&&r({method:"DELETE",headers:{"csrf-token":t.csrfToken()},url:"/api/project/".concat(e.project._id)}).then((function(t){window.location.href="/".concat(e.currentUser.username)}))}))},e.toggleOpen=function(){e.toggle=!e.toggle},e.showLockImg=function(){return void 0!==e.global&&void 0!==e.project&&e.project.user.username==e.global.user.username},e.hasMore=function(t){var r=e.project;return!(!r||!r.like)&&("like"==t?r.likeCnt>e.likeShown:"interest"==t?r.interestCnt>e.interestShown:void 0)},e.seeMore=function(t){"like"==t?(e.likeShown+=10,e.getLikes()):"interest"==t&&(e.interestShown+=10,e.getInterests())},e.setBeforeProject=function(t){e.beforeUpdateProject=JSON.parse(JSON.stringify(t))},e.togglePersonal=function(t){var r=e.personalAgree;"all"===t?r.all?k(!1):(e.isAgreeProjectTerm=!1,e.isAgreeProjectTermAll=!1,k(!0)):(r[t]=!r[t],r.open&&r.use&&r.edit&&(r.all=!0)),r[t]||(r.all=!1)},e.viewHelp=function(){window.open("/#!/terms/project","_blank")},e.setSharedList=function(t,r){var n=window.user.role;if(e.sharedgroupList=[],r.forEach((function(t){var r=t;t.group&&(r=t.group),r.student&&r.student.user?"confirmed"==r.student.status&&e.sharedgroupList.push(r):"confirmed"==t.status&&e.sharedgroupList.push(r)})),e.sharedAreaObj.group=!0,t.group&&r)if("teacher"===n)for(var o in r){for(var a=0;a<t.group.length;a++)(s=t.group[a])==r[o]._id&&(e.sharedAreaObj[s]=!0,e.sharedAreaObj.private=!1);e.sharedAreaObj[r[o]._id]||(e.sharedAreaObj[r[o]._id]=!1,e.sharedAreaObj.group=!1)}else for(var a in r){for(var i in t.group){var s;(s=t.group[i])===r[a]._id&&"pending"!==r[a].status&&s&&(e.sharedAreaObj[s]=!0)}e.sharedAreaObj[r[a]._id]||(e.sharedAreaObj[r[a]._id]=!1,e.sharedAreaObj.group=!1)}e.sharedAreaObj.publicProject=t.isopen,e.sharedAreaObj.private=!t.isopen&&e.getEnableGroupId()},e.generateSharedList=function(){var t=[],r=e.sharedAreaObj;r.publicProject&&t.push(Lang.EntryStatic.publicProject);var n=[];if(e.groupList&&(n=e.groupList.filter((function(e){return!e.student||!e.student.user||"confirmed"==e.student.status}))),e.sharedgroupList=n,n.length>0)for(var o in n){var a=n[o];r[a._id]&&t.push(a.name)}return r.private&&t.push(Lang.EntryStatic.private),t.length?t.join(", "):Lang.Menus.select_share_area},e.selectShared=function(t){switch(e.sharedSelected=!0,e.sharedAreaObj[t]=!e.sharedAreaObj[t],t){case"private":if(e.sharedAreaObj[t]){for(var r in e.sharedAreaObj)e.sharedAreaObj[r]=!1;for(var n in e.sharedAreaObj.private=!0,e.personalAgree)e.personalAgree[n]=!1}break;case"publicProject":e.sharedAreaObj[t]&&(e.sharedAreaObj.private=!1);break;case"group":for(var r in e.sharedAreaObj)"publicProject"!=r&&"private"!==r&&(e.sharedAreaObj[r]=e.sharedAreaObj.group);e.sharedAreaObj[t]||e.sharedAreaObj.publicProject?e.sharedAreaObj.private=!1:e.sharedAreaObj.private=!0;break;default:var o=!1;if(e.sharedAreaObj[t]){e.sharedAreaObj.private=!1;var a=["publicProject","private","group"];for(var n in e.sharedAreaObj){var i=e.sharedAreaObj[n];if(!_.includes(a,n)&&!i){o=!0;break}}e.sharedAreaObj.group=!o}else e.sharedAreaObj.group=!1}!e.sharedAreaObj.publicProject&&e.getEnableGroupId()&&(e.sharedAreaObj.private=!0)},e.getEnableGroupId=function(){var t=["publicProject","private","group"];for(var r in e.sharedAreaObj){var n=e.sharedAreaObj[r];if(!_.includes(t,r)&&n)return!1}return!0},e.isSharedChecked=function(t){return e.sharedAreaObj[t]},e.setBeforeShared=function(t){e.deepSharedArea=JSON.parse(JSON.stringify(e.sharedAreaObj))},e.list=function(){returnUrl&&"undefined"!=returnUrl?location.href=decodeURIComponent(returnUrl):location.href="/all"}}])},1358:function(e,t){angular.module("mean.arts.list").controller("GroupMainController",["$scope","$routeParams","$location","$q","Global","$http","$rootScope","$cookies",function(e,t,r,n,o,a,i,s){e.global=o,e.title=Lang.Menus.my_group,e.user=window.user,e.imageList=["/img/assets/lms/covers/1.png","/img/assets/lms/covers/2.png","/img/assets/lms/covers/3.png","/img/assets/lms/covers/4.png","/img/assets/lms/covers/5.png","/img/assets/lms/covers/6.png","/img/assets/lms/covers/7.png"],e.terms=!1,e.studentTerm=!1,e.isTeacher=o.isTeacher(),e.isMember=o.isMember(),e.isStudent=o.isStudent(),e.page=1,document.title=Lang.Menus.my_page_entry+" "+Lang.Menus.my_classGroup_title+" - "+Lang.Menus.my_classGroup_title_view,e.init=function(){window.user?o.user&&o.user.username!=owner?window.location.href="/"+window.user.username+window.location.hash:($(window).off("scroll"),r.path().indexOf("/group/invite")>-1&&d(),function(){for(var t in e.grades=[],EntryStatic.lectureGrades){var r={};r.name=EntryStatic.lectureGrades[t],r.val=Lang.EntryStatic[EntryStatic.lectureGrades[t]],e.grades.push(r)}var n={name:"init",val:Lang.Menus.select_grade};e.grades.splice(0,0,n)}(),e.initSelectedGroup(),e.tab=t.tab?t.tab:"my",e.isTeacher||(e.tab="my"),e.page=t.page?Number(t.page):1,window.location.hash.indexOf("?registered")>0&&entrylms.alert(Lang.Menus.group_already_registered),e.find()):e.showPopup("notLoginedUser","showLogin")},e.showLogin=function(){e.hidePopup(),$.event.trigger({type:"showLogin"})},e.find=function(){"my"==e.tab?c():u()};var c=function t(){var r="/api/group/find/"+window.user._id+"?page="+e.page;a({method:"GET",url:r}).success((function(r,n){e.groupList=r,e.groupCount>0&&0==r.length&&1!=e.page&&(e.page,t()),p()})).error((function(t,r){e.groupList=[],e.status=r}))};e.setName=function(t,r){e.selectedGroup[r]=$("#"+t).val()};var u=function(){var t="/api/group/findByMember/"+e.global.user._id+"?page="+e.page;a({method:"GET",url:t}).success((function(t,r){"my"!==e.tab?(e.groupList=t,1==e.page&&!window.user.primaryGroup&&t[0]&&t[0].student&&"confirmed"===t[0].student.status&&(o.user.primaryGroup=t[0]._id,e.setPrimaryGroup(t[0])),p()):e.joinGroupList=t})).error((function(t,r){e.status=r}))},p=function(){var t=window.user._id;if(t){var r="/api/group/countByMember/"+t;"my"==e.tab&&(r="/api/group/count/"+t),a({method:"GET",url:r}).success((function(t,r){e.groupCount=t.count,e.generateGroupPageList(),i.$broadcast("changePrimaryGroup")})).error((function(t,r){e.status=r}))}else e.groupCount=0};function l(e,t){0==e?jQuery(t).css("border-color","red"):jQuery(t).css("border-color","#808080")}function d(){window.user.studentTerm?a({method:"GET",url:"/api/group/"+t.groupId}).success((function(t,r){e.targetGroup=t,e.showPopup("inviteSignupPopup","acceptInviteSignupPopup",t)})):(e.hidePopup(),e.showPopup("agreeTermBox","studentTermByUrl"))}e.generateGroupPageList=function(){var t=Number(e.page),r=Number(e.groupCount);e.isTeacher&&r>=12&&(r+=1);var n=Math.ceil(r/12),o=Math.ceil(r/12),a=Math.ceil(t/10),i=1===a?1:10*a-9;t>Math.round(5)&&t+Math.round(5)<o&&(i=t-(Math.round(5)-1)),o>i+9&&(o=i+9),e.groupLastPage=o,e.groupPageList=[];for(var s=i;s<=o;s++)e.groupPageList.push(s);e.hasPrev=i>1,e.groupPageList.length>0&&e.groupPageList[0]+10<n?e.hasNext=!0:e.hasNext=!1},e.setGroupPage=function(t){e.page=t,window.location.hash="#!/group/"+e.tab+"/"+e.page},e.setPrimaryGroup=function(t){t||(e.groupList&&e.groupList.length>0?t=e.groupList[0]:(a.post("/api/users/setMemPrimaryGroup",null,{headers:{"csrf-token":o.csrfToken()}}),location.reload()));var r=t._id;a.post("/api/users/setMemPrimaryGroup",{userId:o.user._id,primaryGroup:r},{headers:{"csrf-token":o.csrfToken()}}).success((function(e,t){location.reload()})).error((function(e,t){console.log(e)}))},e.isPending=function(e){return!(!e.student||"pending"!==e.student.status)},e.isConfirmed=function(e){return!((!e.student||"confirmed"!==e.student.status)&&e.student)},e.isPrimaryGroup=function(e){return!!window.user&&window.user.primaryGroup==String(e._id)},e.prevGroupPage=function(){e.hasPrev&&(e.page-10>0?e.page=e.page-10:e.page=1,window.location.hash="#!/group/"+e.tab+"/"+e.page)},e.nextGroupPage=function(){e.hasNext&&(e.page+10<=e.groupLastPage?e.page=e.page+10:e.page=e.groupLastPage,window.location.hash="#!/group/"+e.tab+"/"+e.page)},e.uploadGroupImage=function(t){var r=new FormData;if(e.uploadFile=document.getElementById("uploadGroupImage"+t).files[0],r.append("uploadGroupImage",e.uploadFile),!e.uploadFile)return!1;var n=/^image\//.test(e.uploadFile.type),a=/^image\/gif/.test(e.uploadFile.type);return!n||a?(entrylms.alert(Lang.Workspace.upload_not_supported_file_msg),!1):e.uploadFile.size>10485760?(entrylms.alert(Lang.Menus.file_upload_max_size),!1):void $.ajax({url:"/rest/picture/group_upload",data:r,cache:!1,contentType:!1,processData:!1,type:"POST",headers:{"csrf-token":o.csrfToken()},success:function(t){e.selectedGroup.image=t.url,e.userUploadImage=!0,$(".imageUploadBox").css("backgroundImage","url('"+t.url+"')"),$(".imageUploadBox").css("background-position","inherit"),$(".imageUploadBox").css("background-size","70px 70px"),$(".imageUploadBox").addClass("selected"),$(".imageBox").removeClass("selected")},error:function(e,t){entrylms.alert(Lang.Msgs.upload_error_content,Lang.Msgs.upload_error_title)}})},e.setGroupImage=function(t){e.userUploadImage&&$(".imageUploadBox").removeAttr("style"),e.group&&(e.group.image=t),e.groupImage=t},e.initSelectedGroup=function(){e.selectedGroup={name:"",description:"",grade:e.grades[0],image:e.imageList[0],isPrimary:!1},delete e.groupImage},e.saveGroup=function(){var t=e.selectedGroup;if(document.getElementById("selectedGroup").checked&&(t.isPrimary=!0),t.name=$("#createGroupName")[0].value,!t||""==t.name)return entrylms.alert(Lang.Menus.type_class_name).on("hide",(function(){$("#createGroupName")[0].focus()})),!1;if(!t.grade||"init"==t.grade.name)return entrylms.alert(Lang.Menus.enter_grade).on("hide",(function(){$(".groupGradeSelect")[0].focus()})),!1;for(var r=0,n=0;n<e.grades.length;n++)e.grades[n].name==t.grade.name&&(r=n);return t.image&&""!=t.image?(t.description=$("#groupDescription")[0].value,t.description&&""!=t.description?(t.grade=r,void a.post("/api/group",t,{headers:{"csrf-token":o.csrfToken()}}).success((function(r,n){t.isPrimary&&(o.user.primaryGroup=r._id,e.setPrimaryGroup(r)),e.find(),e.showPopup("groupCreateConfirm")})).error((function(e,t){console.log("group upload error occured")}))):(entrylms.alert(Lang.Menus.enter_class_info).on("hide",(function(){$("#groupDescription")[0].focus()})),!1)):(entrylms.alert(Lang.Menus.select_class_image),!1)},e.removeGroup=function(t){var r="/api/group/"+t._id;a({method:"DELETE",url:r,headers:{"csrf-token":o.csrfToken()}}).success((function(r,n){if(t._id==window.user.primaryGroup){for(var o=0;o<e.groupList.length;o++)String(e.groupList[o]._id)==String(t._id)&&e.groupList.splice(o,1);var a=e.groupList;if(a.length>1){var i=!1;for(o=0;o<a.length;o++)if("엔트리초등학교 1-A반"!=a[o].name){e.setPrimaryGroup(a[o]),i=!0;break}i||e.setPrimaryGroup(a[0])}else 1==a.length?e.setPrimaryGroup(a[0]):e.find()}else e.find(),e.setGroupPage(1)})).error((function(e,t){console.log(e)}))},e.discardGroup=function(t){a.put("/api/student/discard/"+t.student._id,null,{headers:{"csrf-token":o.csrfToken()}}).success((function(r){t.student.status="discard",e.find()}))},e.signoutGroup=function(t){var r="/api/student/"+t.student._id;a.delete(r,{headers:{"csrf-token":o.csrfToken()}}).success((function(r){if(t._id==window.user.primaryGroup){for(var n=0;n<e.groupList.length;n++)String(e.groupList[n]._id)==String(t._id)&&e.groupList.splice(n,1);if(e.groupList.length>0)e.setPrimaryGroup(e.groupList[0]);else{var o="/api/group/find/"+window.user._id+"?page="+e.page;a({method:"GET",url:o}).success((function(t,r){t&&t.length>0?(window.user.primaryGroup=t[0]._id,e.setPrimaryGroup(t[0])):e.setPrimaryGroup()}))}}e.find()}))},e.acceptGroup=function(t){if(e.group=t,window.user.studentTerm||e.studentTerm){var r="/api/student/accept/"+t.student._id;a.put(r,null,{headers:{"csrf-token":o.csrfToken()}}).success((function(r){t.student.status="confirmed",window.user.primaryGroup||e.setPrimaryGroup(t),e.showPopup("acceptGroupConfirm"),e.find()}))}else e.hidePopup(),e.showPopup("agreeTermBox","studentTermByAccept",t)},e.addGroupId=function(){var t=$(".addGroupId"),r=$(".addGroupPassword");if(l(!0,t),l(!0,r),!t.val())return entrylms.alert(Lang.Menus.enter_group_id),void l(!1,t);if(!r.val())return entrylms.alert(Lang.Menus.enter_group_pwd),void l(!1,r);var n={username:t.val(),password:r.val()};a.put("/api/student/user/"+o.user._id,n,{headers:{"csrf-token":o.csrfToken()}}).success((function(n,i){a.get("/api/user/studentTerm/"+o.user.username).success((function(o){t.val(""),r.val(""),e.hidePopup(),window.user.primaryGroup||a.get("/api/group/"+n.group).success((function(t){e.setPrimaryGroup(t)})),e.find()}))})).error((function(n,o){404==o&&(entrylms.alert(Lang.Menus.class_id_not_exist),l(!1,t)),500==o&&(entrylms.alert(Lang.Menus.incorrect_password),l(!1,r)),501==o&&(entrylms.alert(Lang.Menus.already_exist_group),l(!1,r)),502==o&&(entrylms.alert(Lang.Menus.error_try_again),l(!1,r)),504==o&&(e.tempGroupId=t.val(),e.tempGroupPw=r.val(),e.showPopup("agreeTermBox","studentTermByGroupId"))}))},e.acceptCodeSignupPopup=function(){var t="/api/group/code/"+e.inviteCode;a.get(t).success((function(t){e.codeSignupError=null,e.targetGroup=t,window.user.studentTerm||e.studentTerm?e.showPopup("accessJoinCondition","acceptInviteSignupPopup",t):(e.hidePopup(),e.showPopup("agreeTermBox","studentTermByCode"))})).error((function(t){e.codeSignupError=Lang.Menus.code_not_available}))},e.acceptInviteSignupPopup=function(){e.inviteCode=null;var t=e.targetGroup;if(t){var r="/api/student/makeInvite/"+t._id+"/"+window.user._id;a.post(r,{username:e.inviteUser.name},{headers:{"csrf-token":o.csrfToken()}}).success((function(r){e.inviteUser.name="",window.user.primaryGroup||e.setPrimaryGroup(t),e.showPopup("inviteSignupOKPopup"),e.find()})).error((function(t){e.showPopup("inviteSignNOPopup")}))}},e.reverseTerms=function(){e.terms=!e.terms},e.studentTermByGroupId=function(){e.updateStudentTerm(),function(){var t={username:e.tempGroupId,password:e.tempGroupPw};a.get("/api/user/studentTerm/"+o.user.username).success((function(r){a.put("/api/student/user/"+o.user._id,t,{headers:{"csrf-token":o.csrfToken()}}).success((function(t,r){e.hidePopup(),window.user.primaryGroup||a.get("/api/group/"+t.group).success((function(t){e.setPrimaryGroup(t)})),e.find()}))}))}()},e.studentTermByUrl=function(){e.updateStudentTerm(),d()},e.studentTermByCode=function(){e.updateStudentTerm(),e.acceptCodeSignupPopup()},e.studentTermByAccept=function(t){e.updateStudentTerm(),e.acceptGroup(t)},e.updateStudentTerm=function(){e.terms?(e.studentTerm=!0,e.hidePopup(),a.put("/api/user/updateStudentTerm",{email:o.user.username},{headers:{"csrf-token":o.csrfToken()}}).success((function(e){}),(function(e){}))):entrylms.alert(Lang.Menus.agree_class_policy)},e.isPending=function(e){return!(!e.student||"pending"!==e.student.status)},e.isConfirmed=function(e){return!((!e.student||"confirmed"!==e.student.status)&&e.student)},e.showPopup=function(t,r,n){if(e.popupMode={},n&&n.teacher){var o=a.get("/api/group/getTeacherName/".concat(n.teacher));o.success((function(o){e.popupMode.params=n,e.popupMode.params.teacherName=o.username,e.popupMode.show=t,e.popupMode.hide=r})),o.error((function(n){e.popupMode.show=t,e.popupMode.hide=r}))}else e.popupMode.show=t,e.popupMode.hide=r},e.confirmPopup=function(t){var r=e.popupMode.params;e.popupMode.hide&&e[e.popupMode.hide](r),t||(e.popupMode={})},e.hidePopup=function(){e.popupMode={}},e.groupDetail=function(t){location.href="#!/group/"+e.tab+"/detail/"+t},e.reloadIndex=function(){window.location.href="/"},e.isLang=function(e){return s.get("lang")==e}}])},1359:function(e,t){angular.module("mean.arts.list").controller("GroupDetailController",["$scope","$routeParams","$location","$q","Global","$http","$rootScope","$cookies",function(e,t,r,n,o,a,i,s){var c=[];e.sutdent={},e.groupProgress={};var u=Lang.Menus;e.testData=[{type:"LECTURE_INDICATOR",content:[{type:"BASIC"},{type:"PROGRESS"},{type:"COMPLETED"},{type:"BASIC"},{type:"PROGRESS"},{type:"COMPLETED"},{type:"BASIC"},{type:"PROGRESS"},{type:"COMPLETED"},{type:"BASIC"}]}],e.isSticky=!1,document.title="".concat(Lang.Menus.my_page_entry," ").concat(Lang.Menus.my_classGroup_title," - ").concat(Lang.Menus.my_classGroup_title_view),$(window).scroll((function(){var t=$("#sticky-anchor");$(window).scrollTop()>t.offset().top?(e.isSticky=!0,$("#sticky").addClass("stick"),$("#stickyRight").addClass("stick"),t.height($("#sticky").outerHeight())):($("#sticky").removeClass("stick"),$("#stickyRight").removeClass("stick"),t.height(0),e.isSticky=!1)})),e.priorityStatus={BASIC:0,PROGRESS:1,COMPLETED:2,SUBMITTED:3,RESOLVED:4},e.showLoading=!1,e.getProgress=function(){var t=[{value:"586a0978d0e2293856c1acc1",status:"COMPLETED"}];return e.currentTargetData.map((function(e){t.map((function(t){return e._id===t._id?String(t.status).toUpperCase():"BASIC"}))}))},e.reloadIndex=function(){window.location.href="/"},e.user=window.user?window.user:null,e.testFunction=function(){console.log(arguments)},e.imageList=["/img/assets/lms/covers/1.png","/img/assets/lms/covers/2.png","/img/assets/lms/covers/3.png","/img/assets/lms/covers/4.png","/img/assets/lms/covers/5.png","/img/assets/lms/covers/6.png","/img/assets/lms/covers/7.png"],e.hwStatus={empty:Lang.Menus.lms_hw_ready,progress:Lang.Menus.lms_hw_progress,complete:Lang.Menus.hw_submit,over:Lang.Menus.submission_closed},e.global=o,e.diff=0,e.title=Lang.Menus.my_group,e.groupId=t.groupId,e.isTeacher=o.isTeacher(),e.isMember=o.isMember(),e.isStudent=o.isStudent(),e.init=function(){window.user?(p(),function(t){var r="/api/student/group/".concat(e.groupId);a({method:"GET",url:r}).success((function(r,n){e.currentStudent=r,e.studentList=r,t&&t()})).error((function(e,t){console.log("error",t)}))}((function(){e.loadGroup(e.groupId)})),function(){for(var t in e.grades=[],EntryStatic.lectureGrades){var r={};r.name=EntryStatic.lectureGrades[t],r.val=Lang.EntryStatic[EntryStatic.lectureGrades[t]],e.grades.push(r)}var n={name:"init",val:Lang.Menus.select_grade};e.grades.splice(0,0,n)}(),e.tab=t.tab?t.tab:"my",e.page=t.page?Number(t.page):1):e.showPopup("notLoginedUser","showLogin")};var p=function(){a({method:"GET",url:"/api/getGroupList"}).then((function(t){for(var r=!1,n=t.data,o=0;o<n.length;o++)n[o]._id==e.groupId&&(r=!0);r||(window.location.href="/")}))};function l(){var t=e.group.info;t&&0!==t.length||(e.noSearchDataAll=!0)}function d(t){e.isGroupOwner?a.get("/api/student/list/".concat(e.groupId)).success((function(r){e.studentListAll=r,t&&t()})):e.isStudent||(e.studentListAll=e.studentList,t&&t())}e.showLogin=function(){e.hidePopup(),$.event.trigger({type:"showLogin"})},e.loadGroup=function(t){var r=0,n=0;e.group&&e.group.lectures&&(r=e.group.lectures.length),e.group&&e.group.curriculums&&(n=e.group.curriculums.length),a({method:"GET",url:"/api/groupProgress/".concat(t,"?count=").concat(r+n)}).then((function(r){var n=r.data.lectures,i=r.data.curriculums,s=[];e.lectures=n,e.lecturesAll=n,e.curriculums=i,e.curriculumsAll=i,i.forEach((function(e){var t=e.lectures||[];s=s.concat(t)}));var c=$.extend(!0,[],n.concat(s));c=c.filter((function(e){var t=e.curriculumTitle||"";return t&&(t+=" -> "),e.title=t+e.title,e.hasQuiz})),e.quiz=c,e.quizAll=c,a({method:"GET",url:"/api/group/".concat(t)}).success((function(t,r){e.isGroupOwner=o.isGroupOwner(t),d(),e.groupDetail(t)}))}),(function(){a({method:"GET",url:"/api/group/".concat(t)}).success((function(t,r){e.isGroupOwner=o.isGroupOwner(t),d(),e.groupDetail(t)}))}))},e.getStudentList=function(t){if(e.isGroupOwner){var r="/api/student/list/".concat(e.groupId,"?").concat(f());a.get(r).success((function(r){e.studentList=r,e.currentTargetData=e[e.currentTarget],t&&t()}))}},e.groupDetail=function(t){c=t.info,e.selectedView="group",e.groupSubTab="all",e.group=t,e.selectedGroup=t,e.selectedGrade=e.grades[t.grade],e.homeworkList=t.homeworks.sort((function(e,t){return new Date(t.created).getTime()-new Date(e.created).getTime()})),e.homeworkListByCreated=e.homeworkList,e.studentHomeworkList=e.homeworkList,e.isStudent||e.isGroupOwner||a.get("/api/student/group/".concat(e.groupId)).success((function(t){e.studentList=[t],e.currentStudent=t,M()})).error((function(e,t){console.log(" error",t)})),t.invite&&Number(new Date(t.invite.expired).getTime())-Number((new Date).getTime())<0&&e.generateCode(),e.homeworkListByCreated=t.homeworks.filter((function(t){return!e.isOverDue(t)})),e.homeworkListByCreated=e.homeworkListByCreated.sort((function(e,t){return new Date(t.created).getTime()-new Date(e.created).getTime()})),function(){var t=e.homeworkListByCreated,r=new Date,n=[];for(var o in t){var a=y(r,new Date(String(t[o].due)));a<7&&(t[o].dayDiff=a,n.push(t[o]))}n=n.sort((function(e,t){return e.dayDiff-t.dayDiff})),e.homeworkListByDue=n.splice(0,4)}(),e.homeworkListByCreated=e.homeworkListByCreated.splice(0,4);var r="/api/project/count?blamed=false&option=list&".concat(f());a({method:"GET",url:r}).success((function(t,r){e.projectsLength=t.count}));var n=new Clipboard(document.getElementById("copyInviteUrl"));n.on("success",(function(e){entrylms.alert(Lang.Menus.aftercopy)})),n.on("error",(function(e){e.clearSelection(),prompt(Lang.Menus.copy_text,e.text)})),!t.info||t.info.length<=0?e.search():(S(t.info),c=t.info,e.searchData=t.info,v(),l()),M(),e.isGroupOwner&&o.isTeacher()?(e.getStudentList((function(){g()})),e.studentCreating=!1):g(),e.getStudentCount(t)},e.showGroupProgress=function(){e.changeGroupMainTab("groupProgress"),e.setOption({name:"rows",value:"20"}),e.groupStudyTab="lectures",0!==e.studentCount?(e.studentListAll&&e.studentListAll.length===e.studentCount||d(),e.currentTarget="lectures",e.setGroupStudyTab("lectures")):e.sortingType="studentList"};var g=function(){var t=r.search(),n=Object.keys(t)[0];n?e[n](t[n],!0):e.changeGroupMainTab("viewAll")},f=function(){for(var t="",r=0,n=e.conditions.length;r<n;r++){var o=e.conditions[r];o.value&&""!=o.value&&(t+="".concat(o.name,"=").concat(o.value),r<n-1&&(t+="&"))}return t};function m(){("studentHomeworkList"!==e.groupStudyTab||e.isGroupOwner)&&(e.isGroupOwner?e.toggle(-1):e.toggle(0,e.currentStudent))}e.changeGroupMainTab=function(t,n){e.groupMainTab=t,n||("groupProgress"===t?r.search({setGroupStudyTab:"lectures"}):r.search({changeGroupMainTab:t}))},e.setGroupStudyTab=function(t,n){e.changeGroupMainTab("groupProgress",!0);var o="quiz"===t;e.isQuiz=o,e.groupStudyTab=t,e.changeProgSort(),n||r.search({setGroupStudyTab:e.groupStudyTab})},e.$on("$locationChangeSuccess",(function(t){var n=r.search(),o=Object.keys(n)[0],a=r.url();o?e[o](n[o],!0):"/group"!=a&&"/group/joined"!=a&&e.changeSubTab("all",!0)})),e.generateCode=function(){a.get("/api/group/invite/generateCode/".concat(e.group._id)).success((function(t){e.group.invite=t}))},e.checkInviteState=function(e){return!(!e||Number(new Date(e.expired).getTime())-Number((new Date).getTime())<0)},e.findHomeworkStatus=function(t){var r="";return e.studentHomeworkList.some((function(n){var o=t.target===n.id;return o&&(r=e.hwStatus[n.status]),o})),r},e.getDueDateHomework=function(e){return y(new Date,new Date(String(e.due)))},e.isOverDue=function(e){if(!e.due)return!1;var t=new Date(e.due),r=new Date;return"complete"!==e.status&&t-r<0},e.getStudentCount=function(t){var r="/api/student/count/".concat(t._id);a({method:"GET",url:r}).success((function(t,r){e.studentCount=t.count,e.generatePageList(e.studentCount)})).error((function(t,r){e.status=r}))},e.generatePageList=function(t){var r=e.page,n=Number(e.getOption("rows").value),o=Math.ceil(t/n),a=Math.ceil(t/n),i=Math.ceil(r/10),s=1===i?1:10*i-9;r>Math.round(5)&&a-(s=r-(Math.round(5)-1))<9&&(s=s-(10-(a-s))+1),a>s+9&&(a=s+9),e.lastPage=a,e.pageList=[];for(var c=s;c<=a;c++)e.pageList.push(c);e.hasPrev=s>1,e.pageList.length>0&&e.pageList[0]+10<=o?e.hasNext=!0:e.hasNext=!1,e.total=t,e.rows=n};var h=function(t){for(var r in e.page=t,e.conditions){var n=e.conditions[r];if("page"===n.name){n.value=t;break}}};function v(){var t=c,r=[];if(t&&!(t.length<0)){for(var n=0;n<t.length;n++){var o=t[n],a=o.key;"Curriculum"!==a&&"Lecture"!==a&&"Discuss"!==a||("Discuss"!==a||o.groupNotice)&&r.push(o)}e.newNotice=r.splice(0,5)}}function y(e,t){var r=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.floor((n-r)/864e5)}e.setStuPage=function(t){h(t),e.groupDetail(e.group)},e.setGroupPage=function(t){var r;h(t),e.currentPage=t,e.currentTargetData=e[e.currentTarget],e.isGroupOwner&&"studentListAll"!==e.sortingType?(e.getStudentList(),r="studentList"):r=e.currentTarget,"studentList"!==r||e.studentListAll?(e.col=e["".concat(r,"All")].slice(20*(t-1),20*t),e.isGroupOwner?"studentList"!==r&&(e.currentTargetData=e.studentListAll):e.currentTargetData=e.col,e.setOption({name:"rows",value:"20"}),e.generatePageList(e.colTotal),m()):e.isGroupOwner&&d((function(){e.col=e.studentListAll.slice(20*(t-1),20*t),e.currentTargetData=e.studentListAll,m()}))},e.prevPageGroup=function(){if(e.hasPrev){var t=e.page-10;t<1&&(t=1),e.page=t,"studentList"===e.groupMainTab?e.setStuPage(e.page):e.setGroupPage(e.page)}},e.nextPageGroup=function(){if(e.hasNext){var t=Math.ceil(e.total/e.rows),r=e.page+10;r>t&&(r=t),e.page=r,"studentList"===e.groupMainTab?e.setStuPage(e.page):e.setGroupPage(e.page)}},e.getOption=function(t){for(var r=0,n=e.conditions.length;r<n;r++)if(e.conditions[r].name===t)return e.conditions[r]},e.setOption=function(t,r){for(var n in e.conditions){var o=e.conditions[n];o.name===t.name&&(o.value=t.value,o.label=t.label),r&&"page"===o.name&&(o.value=1)}},e.search=function(r,n){e.groupId||(e.groupId=t.groupId),a.get("/api/group/search/".concat(e.groupId,"?").concat(f())).then((function(t){var r=t.data;e.searchData=r,c=r,v(),S(r),l()}),(function(e){console.log(e),l()}))},e.showThumbnail=function(e){var t=e.key;return"Lecture"!==t&&"Homework"!==t||!o.isLectureStaticThumb(e)?{"background-image":"url('".concat(e.thumbnail,"')")}:o.staticLectureThumbnail(e,"L")},e.thumbnailList=["Project","Lecture","Homework"],e.hasThumbnail=function(t){return e.thumbnailList.indexOf(t)>-1},e.isLang=function(e){return s.get("lang")==e},e.conditions=[{name:"category",value:"",label:"category_all"},{name:"sort",value:"updated",label:Lang.Menus.latest},{name:"period",value:"",label:Lang.Menus.entire_period},{name:"rows",value:12},{name:"page",value:1},{name:"name",value:""},{name:"title",value:""},{name:"isOwner",value:e.isOwner},{name:"groupId",value:t.groupId},{name:"date",value:""},{name:"search",value:"lectures,curriculums,discuss,project,homeworks"}],e.calcDate=function(e,t){var r=(new Date).getTime();if("recent"===t)return(n=new Date(String(e))).setDate(n.getDate()+7),n-r>=0;var n=new Date(String(e)),o=y(new Date,n);return 0===o?"Today":"D-".concat(o)},e.initStuList=function(){e.changeGroupMainTab("studentList"),e.setOption({name:"rows",value:"12"}),e.getStudentList(),e.getStudentCount(e.group),e.page=1},e.changeGroupSubTab=function(t){e.groupSubTab=t,e.subTabNoContentsMsg=Lang.Menus.no_group_contents_each_prefix+Lang.Menus[t]+Lang.Menus.no_group_contents_each_suffix},e.changeGrade=function(){for(var t=$(".groupGradeSelect option:selected")[0].value,r=0;r<e.grades.length;r++)e.grades[r].val==t&&(e.selectedGrade=e.grades[r],e.selectedGroup.grade=r)},e.saveGroup=function(){var t=e.selectedGroup;if(!t||""==t.name)return entrylms.alert(Lang.Menus.type_class_name).on("hide",(function(){$("#createGroupName")[0].focus()})),!1;if(!t.grade||"init"==t.grade.name)return entrylms.alert(Lang.Menus.enter_grade).on("hide",(function(){$(".groupGradeSelect")[0].focus()})),!1;for(var r=0;r<e.grades.length;r++)e.grades[r].val==e.selectedGrade.val&&(t.grade=r);return t.image&&""!=t.image?t.description&&""!=t.description?void a.put("/api/group/".concat(t._id),t,{headers:{"csrf-token":o.csrfToken()}}).success((function(t,r){e.showPopup("groupUpdateConfirm"),e.loadGroup(e.groupId)})).error((function(t,r){console.log("group update error occured"),e.loadGroup(e.groupId)})):(entrylms.alert(Lang.Menus.enter_class_info).on("hide",(function(){$("#updateGroupDescription")[0].focus()})),!1):(entrylms.alert(Lang.Menus.select_class_image),!1)},e.setPrimaryGroup=function(e){a.post("/api/users/setMemPrimaryGroup",{userId:o.user._id,primaryGroup:e._id},{headers:{"csrf-token":o.csrfToken()}}).success((function(e,t){location.reload()})).error((function(e,t){console.log(e)}))},e.goDiscuss=function(){window.location.href="/ds#!/".concat(e.group._id)},e.goExhibit=function(){window.location.href="/all#!/group?groupId=".concat(e.group._id)},e.goArticle=function(){window.location.href="/tt#!/group/lecture/list/".concat(e.group._id)},e.goToDetailByTarget=function(t,r){switch(e.groupStudyTab){case"lectures":return e.goLectureView(t);case"curriculums":return e.goCurriculumView(t)}},e.goLectureView=function(t){var r=t.homeworkId,n="/tt#!/group/lecture/view/".concat(t.target||t.lecture,"/").concat(e.group._id);r&&(n+="/".concat(r)),window.location.href=n},e.goCurriculumView=function(t){window.location.href="/tt#!/group/curriculum/view/".concat(t.target||t.curriculum,"/").concat(e.group._id)},e.goProjectView=function(t){window.location.href="/".concat(t.user.username,"/").concat(t.target,"/").concat(e.group._id,"?returnUrl=").concat(o.getEncodeURI(location.href))},e.goDiscussView=function(t){window.location.href="/ds#!/".concat(e.group._id,"/").concat(t.target)},e.goHomeworkView=function(t){var r=t.lecture._id||t.lecture,n=t.target||t.id;if(e.isGroupOwner)return e.goLectureView({lecture:r,homeworkId:n});var o=e.currentStudent;e.homeworkDetail(o,t)},e.goHomeworkList=function(){window.location.href="/tt#!/group/homework/list/".concat(e.group._id)},e.goLectureWS=function(t,r,n){var o;"curriculum"in t&&t.curriculum?(t.lecture=t._id,o=(t=t.lectures[r]).isForCourse?"/course#!/group/".concat(e.groupId,"/").concat(t.lecture,"/").concat(n):"le/".concat(e.groupId,"/").concat(t.lecture,"/").concat(n)):o=t.isForCourse?"/course#!/group/".concat(e.groupId,"/").concat(t.lecture,"/").concat(n,"/").concat(r):"le/".concat(e.groupId,"/").concat(t.lecture,"/").concat(n),window.location.href=o},e.goQuizWS=function(t,r,n){var o;if(t.isForCourse){var a=t.quizIndex;o="/course#!/group/".concat(e.groupId,"/").concat(t.lecture,"/").concat(n,"/").concat(a[r]),window.location.href=o}else o="le/".concat(e.groupId,"/").concat(t.lecture,"/").concat(n),window.location.href=o},e.goToList=function(){r.path("/group")},e.makeFullGrade=function(e){var t,r;if(e>=1&&e<=6)t=Lang.Menus.elementary,r=Lang.Menus.grades;else{if(!(e>=7&&e<=9))return Lang.Menus.lms_grade_10;t=Lang.Menus.middle,r=Lang.Menus.grades,e-=6}return"".concat(t," ").concat(e).concat(r)},e.setMinimizedGroupImage=function(t){if(!e.group)return"";if(!t)return"/img/assets/group/covers/1.png";var r=e.imageList.indexOf(t);return r>-1?"/img/assets/group/covers/".concat(++r,".png"):t},e.showPopup=function(t,r,n){e.popupMode={},e.popupMode.show=t,e.popupMode.hide=r,e.popupMode.params=n},e.confirmPopup=function(t){var r=e.popupMode.params;e.popupMode.hide&&e[e.popupMode.hide](r),t||(e.popupMode={})},e.hidePopup=function(){e.popupMode={}},e.changeSubTab=function(t,n){e.groupSubTab=t,e.groupMainTab="viewAll";var o="";switch(t){case"Study":o=Lang.Menus.lecture_and_curriculum;break;case"Homework":o=Lang.Menus.assignments_singular;break;case"Discuss":o=Lang.Menus.Discuss;break;case"Project":o=Lang.Menus.project;break;default:o=Lang.Menus[t]}e.subTabNoContentsMsg=u.no_group_contents_each_prefix+o+u.no_group_contents_each_suffix,e.group.info,e.searchData=c.filter((function(e){return"all"===t||("Study"===t?"Lecture"===e.key||"Curriculum"===e.key:e.key===t)})),e.noSearchDataEach=!!_.isEmpty(e.searchData),S(e.searchData),n||r.search({changeSubTab:t})},e.goContentDetail=function(t){!("key"in t)&&"due"in t&&(t.key="Homework");var r="go".concat(t.key,"View");e[r](t)},e.studentCreateStep=1,e.studentCreateStepForward=function(){if(1==e.studentCreateStep){var t=document.getElementById("studentList").value;if(!t||""==t)return void entrylms.alert(Lang.Menus.type_stu_name);t=t.split("\n"),t=b(t),a.post("/api/student/generate/".concat(e.group._id),{names:t.join(",")},{headers:{"csrf-token":o.csrfToken()}}).success((function(t){e.studentAddList=t,e.studentCreateStep=2}))}else 2==e.studentCreateStep?function(){var t=$("input[name='studentNo[]']").map((function(){return $(this).val()})).get(),r=$("input[name='name[]']").map((function(){return $(this).val().replace(" ","")})).get(),n=$("input[name='username[]']").map((function(){return $(this).val().replace(" ","")})).get(),o=[];for(var a in t)!function(r,n,a){w(n).then((function(i){var s={studentNo:r,studentName:a,user:""};if(""!=i&&(s.username=n,s.user=i),o.push(s),t.length==o.length){var c=[];for(var u in o)o[u].user&&c.push(o[u]);c.length>0?L(c).then((function(t){if(t){entrylms.alert(t);var r=$(".studentDataUserId");for(var n in r)if(r[n].value==t){r[n].value="",r[n].focus();break}return!1}e.studentValues=o.sort((function(e,t){return e.studentNo-t.studentNo})),e.studentCreateStep=3})):(e.studentValues=o.sort((function(e,t){return e.studentNo-t.studentNo})),e.studentCreateStep=3)}}))}(t[a],n[a],r[a])}():3==e.studentCreateStep&&(e.studentCreating||(e.studentCreating=!0,a.post("/api/student/make/".concat(e.group._id),{data:e.studentValues},{headers:{"csrf-token":o.csrfToken()}}).success((function(t){e.hidePopup(),e.student={},d(),e.groupDetail(e.group)}))))},e.getUserThumb=function(e){return"/img/assets/avatar_img.png"};var b=function(e){var t=[];for(var r in e){var n=e[r].trim();""!=n&&t.push(n)}return t},w=function(e){var t=n.defer();return a.get("/api/getUserByUsername/".concat(e)).then((function(r){if(window.user._id!==r.data._id)if("student"!==r.data.role)r.data&&r.data._id&&"admin"!==r.data.role?t.resolve(r.data._id):t.resolve("");else{entrylms.alert(Lang.Menus.not_available_student);var n=$(".studentDataUserId");for(var o in n)if(n[o].value==e){n[o].value="",n[o].focus();break}}else entrylms.alert(Lang.Menus.cannot_invite_you)}),(function(e){t.resolve("")})),t.promise},L=function(t){var r=n.defer();for(var i in t)!function(n){a.post("/api/student/count/".concat(e.group._id),{userId:n.user},{headers:{"csrf-token":o.csrfToken()}}).success((function(e){Number(e.count)>0?r.resolve(n.username+Lang.Menus.student_dup):i==t.length-1&&r.resolve(!1)}))}(t[i]);return r.promise};e.showPasswordPopup=function(t){t.user&&"pending"==t.status?entrylms.alert(Lang.Menus.cannot_issue_pw):(e.student=t,e.updatePassword())},e.showPasswordAlert=function(){entrylms.alert(Lang.Menus.cannot_issue_pw)},e.updatePassword=function(){var t=Math.floor(Math.random()*(9e5+1))+99999;e.tempPassword=j(t,6),a.put("/api/student/password/".concat(e.student._id),{password:e.tempPassword},{headers:{"csrf-token":o.csrfToken()}}).success((function(){}))};var j=function(e,t){var r=e.length;if(r<t)for(var n=0;n<t-r;n++)e="0".concat(e);return String(e)};e.getPdfAll=function(){var t=e.group._id;window.open("/api/student/info/pdf/make/all/".concat(t),"_self")},e.selectStudent=function(t,r){e.studentList[t].selected=null!=r?r:!e.studentList[t].selected,e.studentList[t].value=t;var n=e.studentList[t],o=k();e.editStudent||(n=E(n)),e.editStudent&&(0!=o.length||n.selected?0!=o.length&&n.selected?n.selected&&(n=E(n)):(n.studentName=n.oldName,n.studentNo=n.oldNo,n.sex=n.oldGender):e.editCancel())},e.setUserVal=function(e){var t=$(".studentDataUserId"),r=t[e].value,n=!1;if(""===r)return!1;for(var o=0;o<t.length;o++)if(o!==e&&t[o].value===r){t[e].value="",t[e].focus(),n=!0;break}n&&entrylms.alert(Lang.Menus.duplicate_username)};var E=function(e){return e.oldName=e.studentName,e.oldNo=e.studentNo,e.oldGender=e.sex,e},k=function(){var t=e.studentList,r=[];for(var n in t)1==t[n].selected&&r.push(t[n]);return r};function T(t){for(var r=e.studentList,n=0;n<r.length;n++)e.selectStudent(n,t)}e.selectStudentAll=function(){e.studentAll?(T(!1),e.studentAll=!1):(T(!0),e.studentAll=!0)},e.isSubmitted=function(e,t){if(!t||0==t.length)return!1;for(var r=e._id,n=0;n<t.length;n++)if(String(t[n].student)==String(r)&&t[n].submitDate)return!0;return!1},e.isOngoing=function(e,t){for(var r=e._id,n=0;n<t.length;n++)if(String(t[n].student)==String(r)&&!t[n].submitDate)return!0;return!1},e.showHomework=function(e,t){var r=e.studentUser?e.studentUser._id:e._id,n=t.submissions;for(var o in n)n[o].student==r&&window.open("/ws/".concat(n[o].project),"_blank");return!1},e.editView=function(){e.selectedIndex=k(),""!=e.selectedIndex?e.editStudent=!0:e.showPopup("selectStudentAlert")},e.editDone=function(){var t=k();if(t.length<=0)e.editStudent=!1;else{for(var r in t){var n=t[r],i=n._id,s=n.studentNo,c=n.studentName;if(n.user)var u=n.user.sex;else n.studentUser&&(u=n.studentUser.sex);var p={no:s,name:c,sex:u};a.put("/api/student/".concat(i),p,{headers:{"csrf-token":o.csrfToken()}}).success((function(t){e.setStuPage(e.page)}))}e.editStudent=!1,e.studentAll=!1}},e.editCancel=function(){e.editStudent=!1,e.studentAll=!0,e.selectStudentAll()},e.removeStudentConfirm=function(){k().length>0?e.showPopup("deleteStudentConfirm"):e.showPopup("selectStudentAlert")},e.removeStudent=function(){var t=function(){var t=e.studentList,r=[];for(var n in t)1==t[n].selected&&r.push(t[n]._id);return r}().join(",");a.delete("/api/student/".concat(encodeURIComponent(t)),{headers:{"csrf-token":o.csrfToken()}}).success((function(t){d(),e.hidePopup(),e.editCancel(),e.page-1>0?e.setStuPage(e.page-1):e.setStuPage(1),e.loadGroup(e.groupId)})).error((function(e){console.log(e)}))},e.multiLineEllipsis=function(e,t){if(t){var r=$("#".concat(e)),n=$("#".concat(e,"> pre > span")),o=n.height(),a=r.css("min-height");for(a=+a.split("px")[0]||"40px",(t=t.replace(/\n/g,"")).length>102&&(t=t.substring(0,102));o>a;)t=t.substring(0,t.length-1).trim(),n.text((function(e){return"".concat(t,"...")})),o=n.height();return t}},e.shortenDescription=function(e,t){if(e&&t){var r=t;return e.length>r&&(e="".concat(e.slice(0,r-1),"...")),e}},e.makeReadableDate=function(e){var t=new Date(e),r=t.getFullYear(),n=Number(t.getMonth()+1);return e=t.getDate(),"ko"===Lang.type?"".concat(r,"년 ").concat(n,"월 ").concat(e,"일"):"".concat(n,".").concat(e,". ").concat(r)},e.changeProgSort=function(t){if(t||(t="studentList"),e[t]){e.sortingType=t;var r="studentList"==t;e.currentTarget=e.groupStudyTab,e.sortingType=r?"studentList":"studentListAll",e.currentTargetData=e[e.currentTarget],function(t,r){0===r?(e["no_".concat(t)]=!0,e.noContents=!0):(e["no_".concat(t)]=!1,e.noContents=!1)}(e.currentTarget,e.currentTargetData.length),e.isGroupOwner?e.colTotal=r?e.studentCount:e["".concat(t,"All")].length:e.colTotal=e["".concat(e.currentTarget,"All")].length,e.generatePageList(e.colTotal),e.setGroupPage(1)}},e.noContentsTextFormat=function(t){if(e.isGroupOwner)var r=Lang.Menus.no_added_group_contents_teacher;else r=Lang.Menus.no_added_group_contents_student;return P(r,Lang.Menus[t])};var P=function(e){var t=arguments;return e.replace(/\%\d/g,(function(e){var r=e.replace("%","");return t[r]}))};function S(t){if(e.searchLeftData=[],e.searchRightData=[],t&&0!=t.length){var r={Project:340,Homework:340,Lecture:340,Curriculum:163,Discuss:163};e.searchLeftData=[],e.searchRightData=[],t.forEach((function(t){var n=r[t.key];e.diff>=0||_.isEmpty(e.searchLeftData)?(e.searchLeftData.push(t),e.diff-=n):(e.searchRightData.push(t),e.diff+=n)}))}}function C(t,r,n){var i="/api/group/progress/".concat(e.groupId);e.showLoading=!0,a.post(i,r,{headers:{"csrf-token":o.csrfToken()}}).success((function(r){"studentList"===e.sortingType?function(t,r){for(var n=function(){e.basic=[];var t=[],r=e.currentTargetData;if(!(r.length<=0)){for(var n=0;n<r.length;n++){var o,a=r[n];o="lectures"===e.currentTarget?a.isForCourse?a.progressCount:1:"quiz"===e.currentTarget?a.quizIndex.length||0:a.progressCount||0,t[n]=x(a,o)}return t}}(),o=0;o<e.currentTargetData.length;o++)for(var a=e.currentTargetData[o],i=0;i<t.length;i++){var s=t[i];n[o]=O(n[o],s,a)}e.basic=n}(r):function(t,r){if("lectures"in r)n="quiz"===e.currentTarget?r.quizIndex.length||1:r.progressCount||1;else{var n,o=r;n="quiz"===e.currentTarget?o.isForCourse?o.quizIndex.length:1:o.isForCourse?o.progressCount:1}for(var a=function(t,r){var n=[];e.notStuBasic=[];for(var o=e.currentTargetData,a=0;a<o.length;a++){var i=o[a];n[a]=x(i,r)}return n}(0,n),i=e.currentTargetData,s=0;s<i.length;s++)for(var c=i[s],u=0;u<t.length;u++){var p=t[u];a[s]=I(a[s],p,c,r)}e.notStuBasic=a}(r,n),e.col[t]&&(e.col[t].isOpen=!e.isGroupOwner||!e.col[t].isOpen,e.col[t].isOpen&&!e.col[t].stateArr)&&e.col[t],e.showLoading=!1}))}function O(t,r,n){var o=e.currentTarget;if("lectures"===o&&"quiz"!==e.groupStudyTab){if(r.lecture==n.lecture)for(var a=r.studyStatus,i=0;i<a.length;i++){var s=a[i];t.content[i]=s}}else if("curriculums"===o){var c=n.lectures;for(i=0;i<c.length;i++)(n=c[i]).lecture===r.lecture&&(t.content[i]=A(r.studyStatus,n))}else if(r.lecture==n.lecture)for(var u=0;u<r.studyStatus.length;u++)"quiz"===(s=r.studyStatus[u]).category&&(t.content[u]=s);return t}function A(t,r){var n="BASIC";if(t.map((function(t){e.priorityStatus[t.status]>=1&&(n="PROGRESS")})),t.length>0){var o=t[t.length-1].status;e.priorityStatus[o]>=2&&(n="COMPLETED")}return{status:n}}function M(){var t=e.studentHomeworkList;e.isGroupOwner&&t.reverse();for(var r=window.user,n=0;n<t.length;n++){for(var o=t[n],a=o.submissions,i=0;i<a.length;i++){var s=a[i];r&&(window.user._id==s.student||e.currentStudent&&e.currentStudent._id==s.student)&&(s.submitDate?(o.status="complete",o.project=s.project):(o.status="progress",o.project=s.project))}o.status||(o.status="empty"),e.isOverDue(o)&&(o.status="over")}e.studentHomeworkList=t,e.studentHomeworkListAll=e.studentHomeworkList}function x(t,r){(t={}).type="LECTURE_INDICATOR",e.isQuiz&&(t.type="QUIZ_INDICATOR"),t.content=[];for(var n=0;n<r;n++)t.content[n]={status:"BASIC"};return t}function I(t,r,n,o){var a=!1;if(r.student==n._id)a=!0;else{var i="studentUser"in n?n.studentUser:n.user;i&&(a=r.user===i._id)}if(a)if("lectures"in o)for(var s=o.lectures,c=0;c<s.length;c++)s[c].lecture===r.lecture&&(t.content[c]=A(r.studyStatus));else if(e.isQuiz)for(u=0;u<r.studyStatus.length;u++)p=r.studyStatus[u],t.content[u]=p;else for(var u=0;u<r.studyStatus.length;u++){var p=r.studyStatus[u];t.content[u]=p}return t}e.toggle=function(t,r,n){if("studentHomeworkList"!=e.groupStudyTab){e.basic=[];for(var o=0;o<e.col.length;o++)o!==t&&(e.col[o].isOpen=!1);if(t>-1){if(e.isGroupOwner&&e.col[t].isOpen)return void(e.col[t].isOpen=!1);var a={};"quiz"===e.groupStudyTab&&(a.quiz=!0),n?("lectures"in n?a.curriculum=n.curriculum:a.lecture=n.lecture,C(t,a,n)):e.isGroupOwner?(r.user&&(a.user=r.user._id),r&&(a.student=r._id),C(t,a)):(a.user=window.user._id,1===e.studentList.length&&(a.student=e.studentList[0]._id),C(t,a))}}},e.goProgressDetail=function(t,r){var n=e.sortingType,o=e.groupStudyTab,a=t.rowindex;if(r=r,"studentList"===n){if(e.isGroupOwner&&G(a,r))return;var i,s,c=JSON.parse(t.student);i=e.currentStudent?e.currentStudent._id:c._id,s=e.currentTargetData[a]}else if("studentList"!==n){if(e.isGroupOwner&&U(a,r))return;i=(c=e.currentTargetData[a])._id,s=JSON.parse(t.lecorcur)}switch(o){case"lectures":e.goLectureWS(s,r,i);break;case"curriculums":s.lectures[r],e.goLectureWS(s,r,i);break;case"quiz":e.goQuizWS(s,r,i)}};var G=function(t,r){return"BASIC"===e.basic[t].content[r].status},U=function(t,r){return"BASIC"===e.notStuBasic[t].content[r].status};e.homeworkDetail=function(t,r){if("over"!==r.status||e.isGroupOwner){var n=t._id,o=r.id||r.target,i=r.lecture;a.get("/api/lecture/".concat(i)).then((function(t){var r=t.data;e.goHomeworkWS(r,n,o)}),(function(e){console.log("err=",e)}))}},e.goHomeworkWS=function(t,r,n){var o;if(t.isForCourse){var a=function(e){if(!(e.length<=1))for(var t=0;t<e.length;t++)if("quiz"===e[t].type)return t}(t.studies),i="";void 0!==a&&(i="/".concat(a)),o="/course#!/group/".concat(t._id,"/").concat(e.groupId,"/").concat(r,"/").concat(n,"/hw").concat(i)}else o="/le/".concat(t._id,"/").concat(e.groupId,"/").concat(r,"/").concat(n,"/hw");window.location.href=o},e.studentCreateStepBack=function(){e.studentCreateStep>1&&(e.studentCreateStep=e.studentCreateStep-1)},e.uploadGroupImage=function(t){var r=new FormData;if(e.uploadFile=document.getElementById("uploadGroupImage".concat(t)).files[0],r.append("uploadGroupImage",e.uploadFile),!e.uploadFile)return!1;var n=/^image\//.test(e.uploadFile.type),a=/^image\/gif/.test(e.uploadFile.type);return!n||a?(entrylms.alert(Lang.Workspace.upload_not_supported_file_msg),!1):e.uploadFile.size>10485760?(entrylms.alert(Lang.Menus.file_upload_max_size),!1):void $.ajax({url:"/rest/picture/group_upload",data:r,cache:!1,contentType:!1,processData:!1,type:"POST",headers:{"csrf-token":o.csrfToken()},success:function(t){e.selectedGroup.image=t.url,e.userUploadImage=!0,$(".imageUploadBox").css("backgroundImage","url('".concat(t.url,"')")),$(".imageUploadBox").css("background-position","inherit"),$(".imageUploadBox").css("background-size","70px 70px"),$(".imageUploadBox").addClass("selected"),$(".imageBox").removeClass("selected")},error:function(e,t){entrylms.alert(Lang.Msgs.upload_error_content,Lang.Msgs.upload_error_title)}})}}])},268:function(e,t,r){"use strict";var n=angular.module("mean.common");n.factory("Projects",["$resource","Global",function(e,t){return e("/api/project/:projectId",{projectId:"@_id"},{update:{method:"PUT",headers:{"csrf-token":t.csrfToken()}},remove:{method:"DELETE",headers:{"csrf-token":t.csrfToken()}},save:{method:"POST",headers:{"csrf-token":t.csrfToken()}},get:{method:"GET",cache:!1}})}]),n.service("myProject",["$rootScope",function(e){this.mode,this.modeName,this.projectName,this.setMode=function(t){this.mode=t,this.modeName="default"===t?Lang.Workspace.default_mode:Lang.Workspace.practical_course_mode,e.$broadcast("modeChange",this)},this.getMode=function(){return this.mode},this.getProjectName=function(){return this.projectName},this.setProjectName=function(e){this.projectName=e}}]),n.factory("UnloadEmitter",["$window","$rootScope",function(e,t){var r={name:"UnloaderEmitterFactory",willUnload:!1},n=function(){t.$broadcast("pageLeave"),r.willUnload=!0};return e.addEventListener("beforeunload",n),t.$on("$locationChangeStart",n),r}]),n.service("$download",["$rootScope","UnloadEmitter",function(e,t){var r,n,o={};return e.$on("pageLeave",(function(){r&&(r.onload=null)})),o.download=function(e){var t=navigator.userAgent.toLowerCase();"Netscape"==navigator.appName&&-1!=navigator.userAgent.search("Trident")||-1!=t.indexOf("msie")?(r||((r=document.createElement("iframe")).style.display="none",document.body.appendChild(r)),r.setAttribute("src",e),$(r).off("beforeunload").on("beforeunload",(function(e){e.stopPropagation()}))):(n||(n=document.createElement("a"),document.body.appendChild(n)),n.href=e,n.download=e,n.click())},o}]),n.service("$downloadPost",["$rootScope","UnloadEmitter",function(e,t){var r={download:function(e,t){var r;(r=document.getElementById("$downloadPost"))||((r=document.createElement("form")).id="$downloadPost",r.action=e,r.method="post",r.target="_self",document.body.appendChild(r)),function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(r),Object.keys(t).forEach((function(e){var n=document.createElement("input");n.type="hidden",n.name=e;var o=t[e];($.isPlainObject(o)||Array.isArray(o))&&(o=JSON.stringify(o)),n.value=o,r.appendChild(n)})),r.submit()}};return r}]),n.service("BugReporter",["$http","Projects","Global",function(e,t,r){this.report=function(n,o){o=o||"workspace bug";var a=this;(n=n||{}).preventDefault&&n.preventDefault();var i=$("#bugContent"),s=i.val().trim();if(!s)return entrylms.alert(Lang.Menus.content_required),i.val(""),void i.focus();var c=$("#bugEmail"),u=c.val().trim();if(Entry.type){(p=Entry.exportProject()).name=$("#project_name").val();var p=new t(p);e.post("/api/feedbackProject",p,{headers:{"csrf-token":r.csrfToken()}}).success(l).error((function(e,t){console.log(e),console.log(t),entrylms.alert(Lang.Menus.error_try_again)}))}else l();function l(t){var n={title:o,content:s,email:u,category:"workspace"};t&&(n.project={_id:t._id,username:"entry"}),e.post("/api/feedback",n,{headers:{"csrf-token":r.csrfToken()}}).success((function(e,t){i.val(""),c.val(""),entrylms.alert(Lang.Msgs.bug_report_alert_msg),a.hidePopup("bugReport")})).error((function(e,t){console.log(e,t);var r=Lang.Menus.error_try_again;429===t&&(r=Lang.Menus.bug_report_too_many_request),entrylms.alert(r)}))}}}]),n.service("CloudCache",["$http","Global",function(e,t){this.save=function(){var r=Entry.projectId,n=Entry.variableContainer.getVariableJSON().filter((function(e){return 1==e.isCloud}));0==t.isEmpty(n)&&e.post("/api/cloud/save",{projectId:r,variables:n},{headers:{"csrf-token":t.csrfToken()}}).success((function(e){})).error((function(e){console.error("api/cloud catch"+e)}))},this.get=function(r){var n=this;return new Promise((function(o,a){var i=r._id,s=r.variables;n.isCloud(s)?e.post("/api/cloud/get",{projectId:i,variables:s},{headers:{"csrf-token":t.csrfToken()}}).success((function(e){o(e)})).error((function(e){console.error("api/cloud catch"+e),a(e)})):o(s)}))},this.isCloud=function(e){return e.some((function(e,t,r){return e.isCloud_||e.isCloud}))}}])},269:function(e,t){angular.module("mean.common").controller("HeaderController",["$scope","Global","$http","$location","$cookies","Users","$routeParams","$uibModal","$rootScope",function(e,t,r,n,o,a,i,s,c){e.global=t,e.username_exists=!0,e.password_invalid=!1,e.headerContentShow=!1,e.isTeacher=t.isTeacher(),e.langType=Lang.type;var u=window.user;e.user=window.user,u&&(e.username=u&&u.username?u.username:null),c.$on("changePrimaryGroup",(function(t){e.init()})),e.menu={logo:{what_entry:"/#!/about",faq:"/#!/faq?all",gnb_download:"/#!/offlineEditor"},learn:{problem_solve:"/tt#!/",learning_textbook:"/study/basic/textbook",Resources:"/tt#!/basic/materials",My_lesson:"/tt#!/custom/lecture/list"},make:{make_project:"/ws#!/",practical_course:"/ws?type=practical_course#!/"},share:{project_share:"/all"},community:{Discuss:"/ds#!/qna?category=qna"}},e.userMenu={my_profile:"/"+e.username,Edit_info:"/#!/personal"},e.path={learn:["/tt"],userPage:["/"+e.username],make:["/tt#!/custom/lecture/build"],share:["/all"],community:["/ds"]},e.init=function(){u?r({method:"GET",url:"/api/getGroupList"}).then((function(n){var o=n.data;o&&0!=o.length||!window.user.primaryGroup||(r.post("/api/users/setMemPrimaryGroup",null,{headers:{"csrf-token":t.csrfToken()}}),delete window.user.primaryGroup),e.initMenus()}),(function(t){e.initMenus()})):e.initMenus()},e.initMenus=function(){var t=u&&u.primaryGroup?u.primaryGroup:"";if(e.teacher={learn:{study_lesson:"/tt#!/group/lecture/list"},make:{make_group:"/"+e.username+"#!/group"},share:{group_project_share:"/all#!/group"},community:{group_discuss:"/ds#!/"+t},userPage:{my_group:"/"+e.username+"#!/group"}},e.student={learn:{study_lesson:"/tt#!/group/lecture/list"},share:{group_project_share:"/all#!/group"},community:{group_discuss:"/ds#!/"+t},userPage:{my_group:"/"+e.username+"#!/group"}},e.member=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({userPage:{my_group:"/"+e.username+"#!/group"},learn:{study_lesson:"/tt#!/group/lecture/list"},share:{group_project_share:"/all#!/group"},community:{group_discuss:"/ds#!/"+t}},"userPage",{my_group:"/"+e.username+"#!/group"}),e.default={learn:{study_lesson:""},make:{make_open_lecture:"",make_group:""},share:{group_project_share:""},community:{group_discuss:""}},!u||u.primaryGroup||"member"!=u.role&&"teacher"!=u.role||(delete e[u.role].share.group_project_share,delete e[u.role].community.group_discuss,delete e[u.role].learn.study_lesson),u){e.role={};var n="";"student"==u.role||window.user.primaryGroup||delete e.member.learn.study_lesson,"teacher"==u.role&&(e.menu.make.make_open_lecture="/tt#!/custom/lecture/build"),"student"!=u.role&&"member"!=u.role||null==u.primaryGroup&&delete e.menu.community.group_discuss,"member"==u.role?r({method:"GET",url:"/api/groupInfo/"+window.user._id}).success((function(t,r){n=p(t)?"student":"member",e.role=e[n],e.menu.userPage=e.userMenu})):(n=u.role,e.role=e[n],e.menu.userPage=e.userMenu)}else e.role=e.default;u&&(u.language=o.get("lang"))},e.currentMenu=function(){var t=window.location.pathname;for(var r in window.location.hash,e.path)for(var n=e.path[r],o=0;o<n.length;o++)if(t==n[o])return r}(),e.go=function(t,r){if(e.headerContentShow=!1,t){var n=window.location;"group_discuss"===r&&(t="/ds#!/"+window.user.primaryGroup),n.href=t,n.pathname+n.hash===t&&window.location.reload()}else{for(var o in e.default){var a=Object.keys(e.default[o]);for(var i in a)if(a[i]===r){var s=o;break}if(s)break}var c=Object.keys(e.member);e.showPopup(),c.indexOf(s)>-1?e.menuAlertMessage=Lang.Menus.login_needed:e.menuAlertMessage=Lang.Menus.login_as_teacher}},e.getGroups=function(){var e="/api/group/find/"+u._id;r({method:"GET",url:e}).success((function(e,t){if(e.primary)return e.group._id}))},e.showSignUp=function(){$.event.trigger({type:"showSignUp"})},e.showLogin=function(e){$.event.trigger({type:"showLogin"})},e.updateUser=function(){a.update(e.global.user._id)},e.setLanguage=function(t){e.global.user.language=t;var r=n.absUrl();window.location.href=r+"?lang="+t};var p=function(e){if(e.length<=0)return!1;for(var t=0;t<e.length;t++)if(e[t].primary&&e[t].group)return!0;return!1};e.goContents=function(r){return"/#!/"===r&&"/"===window.location.pathname?window.location.hash="#!/":!!e.headerContentShow&&("/out"==r&&t.resetCpartySession(),void(window.location.href=r))},e.hidePopup=function(t){e.menuAlertPopup=!1;var r=$(".headerPopupWrapper");$("body").eq(0),r.css("display","none"),$.event.trigger({type:"hidePopup"}),t&&e.showLogin()},e.showPopup=function(){e.menuAlertPopup=!0;var t=$(".headerPopupWrapper"),r=$("body").eq(0);t.css("top",r.scrollTop()+"px"),t.css("display","block")},e.goIndex=function(){window.location.href="/"},e.signout=function(){t.resetUserWorkspace(),window.location.href="/"}}])},292:function(e,t,r){"use strict";angular.module("mean.common").factory("Feedback",["$resource","Global",function(e,t){return e("/api/feedback/:feedbackId",{feedbackId:"@_id"},{query:{method:"GET",headers:{"csrf-token":t.csrfToken()}},update:{method:"PUT",headers:{"csrf-token":t.csrfToken()}},save:{method:"POST",headers:{"csrf-token":t.csrfToken()}},remove:{method:"DELETE",headers:{"csrf-token":t.csrfToken()}}})}]),angular.module("mean.common").factory("FeedbackPaged",["$resource","Global",function(e,t){return e("/api/feedbackPaged/:page",{page:"@page"},{query:{method:"GET",headers:{"csrf-token":t.csrfToken()}}})}])},293:function(e,t,r){"use strict";angular.module("mean.common").controller("ReportController",["$scope","Global","$http","$location","$cookies","Users","Feedback","$route",function(e,t,r,n,o,a,i,s){e.global=t,e.report={},s.current,e.init=function(){$(document).on("popupReport",e.popupReport)},e.goProjectTerm=function(){var e=o.get("lang")?o.get("lang"):"";window.location.href="/#!/terms/project/".concat(e)},e.isLang=t.isLang,e.popupReport=function(t){e.info=t.info;var n=e.info.commentId||e.info.comment;n&&(e.info.commentId=n,r.get("/api/comment/".concat(n)).success((function(t,r){e.original=t})));var o=$("#reportProject"),a=$("body").eq(0),i=$(document);"".concat(i.scrollTop(),"px"),o.css("display","block"),a.css("overflow","scroll")},e.hideReport=function(){var t=$("#reportProject"),r=$("body");t.css("display","none"),r.css("overflow","auto"),$(".reportCause").prop("checked",!1),e.report={}},e.saveReport=function(){e.report.cause="";var t=$(".reportCause"),r=[];for(var n in t){if(t[n].checked&&(r.push(t[n].value),"기타"==t[n].value&&!$(".etcTextArea").val()))return void entrylms.alert(Lang.Menus.enter_content);n++}if(e.report.cause=r.join(", "),e.report.cause){var o=null;e.info.project&&(o={_id:e.info.project._id,username:e.info.project.user.username,group:e.info.group});var a=null;e.info.lecture&&(a={_id:e.info.lecture._id,username:e.info.lecture.user.username});var s=new i({title:e.report.cause,cause:e.report.cause,content:e.report.content,email:e.report.email,category:e.info.type,project:o,lecture:a,course:e.info.course,discuss:e.info.discuss,comment:e.info.commentId,study:e.info.study,url:window.location.href});e.original&&(s.original=e.original.content),s.$save((function(){e.hideSuccessReport(),e.hideReport();var t=$("#reportProjectSuccessWrapper"),r=.2*$(window).height();t.css("display","block"),t.children().css("top",r)}),(function(e){403==e.status?entrylms.alert(Lang.Msgs.feedback_duplicated):entrylms.alert(Lang.Msgs.feedback_too_many_post)}))}else entrylms.alert(Lang.Menus.check_one_more)},e.hideSuccessReport=function(){$("#reportProjectSuccessWrapper").css("display","none"),$("body").css("overflow","auto")},e.isCauseChecked=function(e){return $(".reportCause")[e].checked},e.causeCheckbox=function(e){var t=$(".reportCause")[e];t.checked?t.checked=!1:t.checked=!0}}])},294:function(e,t){e.exports='<div style="margin:-30px 0 -20px 0;overflow:hidden"> <p> <span>엔트리 사용자 여러분.</span> <span>여러분은 엔트리뿐 아니라 아름다운 인터넷 세상을 만드는 주인공이자 디지털 시민입니다.</span> <span></span> <span>여러분의 사랑으로 엔트리는 이제 여러 나라의 많은 사용자가 함께하는 서비스가 되었습니다.</span> <span>엔트리 사용자 모두가 인터넷 윤리를 지키고 다른 나라, 다른 문화를 배려하는 회원이 되기 위해</span> <span>아직 작품/게시물 공유 원칙을 잘 모르는 엔트리 사용자가 있다면 다음의 원칙을 친절하게 알려주세요.</span> </p><div style="margin:-15px 0 0 10px"> <span>● 다른 사용자를 비방하거나 인터넷 윤리에 어긋나는 작품, 게시글 올리지 않기</span> <span>● 저작권과 초상권 뿐 아니라 다른 사용자의 개인정보도 소중하게 여기기</span> <span>● 여러 다른 나라, 다른 문화의 사용자도 배려하는 엔트리 사용자 되기</span> </div> <span>자세한 작품, 게시물 공유 원칙은 다음을 확인하세요.</span> <span></span> <span>1. 윤리지침</span> <div style="margin:-15px 0 0 10px"> <span>1.1. 범죄 행위를 조장하는 경우</span> <span>1.2. 폭력, 잔혹물, 혐오물, 학대, 선정적인 게시물</span> <span>1.3. 음주, 흡연을 조장하거나 폭음, 불법 약물 복용 행위 등을 묘사하는 경우</span> <span>1.4. 불법 무기를 현실적으로 묘사하거나 이러한 무기의 사용을 조장하는 경우</span> <span>1.5. 스팸, 피싱 등을 목적으로 하는 경우</span> <span>1.6. 해킹, 바이러스, 악성코드 게시물</span> <span>1.7. 살인, 총기 및 도검류로 사람이나 동물에 대한 위해 행위를 실제 사진을 통해 묘사하는 경우</span> <span>1.8. 특정 국적 소유자, 인물, 법인, 집단에 대한 비방이나, 폄훼, 공격으로 해석될 수 있는 경우</span> <span>1.9. 특정 국가와 분쟁 중이거나 가능성이 있는 민감 사안이 포함된 경우 (역사, 지리 등의 분쟁 사안)</span> <span>1.10. 특정 국적 소유자, 종교, 문화, 집단에 대한 공격으로 해석되거나 이들에게 불쾌감을 유발할 소지가 있는 경우</span> <span>1.11. 과도하게 공격적이거나 저속한 이미지가 포함된 경우</span> <span>1.12. 사용자에게 혐오감을 유발하도록 제작된 경우</span> <span>1.13. 사용자의 비밀번호나 기타 개인 데이터 수집을 시도하는 경우</span> <span>1.14. 자살, 자해, 약물 남용 등을 조장하는 경우</span> <span>1.15. 왕따 행위를 유발 또는 조장하는 경우</span> <span>1.16. 차별을 조장하거나 조장할 소지가 있는 경우에도</span> <span>1.17. 청소년 가출, 자살을 부추기는 게시물</span> <span>1.18. 학교폭력을 미화하거나 조장하는 내용이 포함된 게시물</span> <span>1.19. 미성년자 구입 불가 제품에 대한 구매정보가 포함된 게시물</span> <span>1.20. 청소년 범죄정보가 포함된 게시물</span> <span>1.21. 미성년자 출입금지 업소 관련 게시물</span> <span>1.22. 기타 타인에게 불안감을 조성할 수 있는 반사회적 내용을 묘사하는 경우</span> </div> <span>2. 사업, 광고 및 기타 가이드라인</span> <div style="margin:-15px 0 0 10px"> <span>2.1. 특정 제품, 서비스에 대한 근거 없는 비방 및 악의적인 게시물</span> </div> <span>3. 권리 및 법적 가이드라인</span> <div style="margin:-15px 0 0 10px"> <span>1. 저작권 보호</span> <span>사람의 생각이나 감정을 표현한 창작물을 저작물이라고 하며</span> <span>자신이 창작한 저작물에 대해서 갖는 권리를 저작권이라고 합니다.</span> <span>​2. 개인정보 보호</span> <span>생존하는 개인에 관한 정보로 특정한 개인을 알아볼 수 있는 부호, 문자, 음성, 음향 및 영상등의 정보를 말합니다.</span> <span>해당 정보만으로는 특정 개인을 알아볼 수 없어도 다른 정보와 쉽게 결합하여 알아볼 수 있는 경우 개인정보에 해당합니다.</span> <span>인터넷상에 공개된 개인정보는 위/변조, 오남용이 쉽고 확산이 빠르며 사생활 침해, 협박 등문제를 발생시킬 수 있습니다.</span> <span></span> <span>3.1. 제3자의 상표권, 저작권, 특허권을 침해하거나 제3자의 사용조건을 위배하는 이미지를 사용하는 경우</span> <span>3.2. 저작권 소유자가 명확하지 않은 콘텐츠를 사용하는 경우</span> <span>3.3. 타인의 초상권을 침해하는 경우(예: 캐리커처, 상대방의 동의 없이 촬영한 얼굴 사진 등)</span> <span>3.4. 저작권 소유자가 사용을 명시적으로 허가하지 않은 내용이 포함된 경우</span> <span>3.5. 엔트리 서비스가 제공되는 지역의 법을 준수하지 않거나 제3자의 권리 또는 이익을 침해하는 경우</span> <span>3.6. 특정 개인 또는 제3자의 정보를 공개하거나 공개할 가능성이 있는 경우</span> </div> <span>엔트리는 상기 가이드라인에 해당하지 않는 경우에도, 부적절하다고 판단되는 작품, 게시물의 게시를 제한, 중단, 변경, 종료할 수 있습니다.</span> <span>또한 계속된 위반이 발견될 경우 해당 사용자에 대한 사용 정지, IP 차단등의 제재가 이뤄질수도 있습니다.</span> <span>이는 엔트리에 신고 문의가 들어와 엔트리가 부적절하다고 판단한 작품, 게시물도 동일합니다.</span> <span></span> <span>적용일 : 2019년 11월 28일</span> <p></p> </div>'},295:function(e,t){e.exports='<div style="margin:-30px 0 -30px 0;overflow:hidden"> <p> <span>Dear Entry user.</span> <span>You are not only for Entry but a hero and a digital citizen for a beautiful Internet world.</span> <span>With your love, Entry is now a service with many users from many countries.</span> <span></span> <span>To ensure that all of our Entry users are members of the Internet ethic and consider other countries and cultures, if you have an entry user who is not yet familiar with the principles of sharing projects/posts,</span> <span>please kindly share the following principles:</span> </p><div style="margin:-15px 0 0 10px"> <span>● Not posting anything that slander others or violates your internet ethics.</span> <span>● Valuing other users\' personal information as well as copyright and portrait rights.</span> <span>● Becoming an Entry user who considers users from different countries and cultures.</span> </div> <span>Check out the following for details how to share projects and posts:</span> <span></span> <span>1. Ethical Guidelines</span> <div style="margin:-15px 0 0 10px"> <span>1.1. Encourage criminal activity</span> <span>1.2. Violence, Cruelty, Hate, Abuse, Sexual Posts</span> <span>1.3. Portrays drinking, smoking, binge drinking, illegal drug use, etc.</span> <span>1.4. Realistically depicts illegal weapons or encourages their use</span> <span>1.5. For the purpose of spam, phishing, etc.</span> <span>1.6. Hacking, Virus, Malware Posts</span> <span>1.7. Real-life photos depicting harm to a person or animal with murder, firearms and swords</span> <span>1.8. When it can be interpreted as slander, vandalism or attack on a specific nationality owner, person, corporation or group</span> <span>1.9. Conflicts with, or potential to include, specific countries (conflicts of history, geography, etc.)</span> <span>1.10. Interpreted as an attack on a specific nationality owner, religion, culture or group, or that may be offensive to them</span> <span>1.11. Contains excessively aggressive or vulgar images</span> <span>1.12. If it\'s designed to disgust users</span> <span>1.13. Attempt to collect a user\'s password or other personal data</span> <span>1.14. Promotes suicide, self-harm, drug abuse, etc.</span> <span>1.15. Triggers or encourages bullying</span> <span>1.16. If there is or is likely to encourage discrimination</span> <span>1.17. Juvenile Runaway, Suicidal Posts</span> <span>1.18. Posts that glorify or promote school violence</span> <span>1.19. Posts with purchase information for products not available for purchase by minors</span> <span>1.20. Posts containing youth crime information</span> <span>1.21. Posts related to minors</span> <span>1.22. Describes other antisocial content that may create anxiety for others</span> </div> <span>2. Business, Advertising and Other Guidelines</span> <div style="margin:-15px 0 0 10px"> <span>2.1. Unfounded slurs and malicious posts about certain products or services</span> </div> <span>3. Rights and Legal Guidelines</span> <div style="margin:-15px 0 0 10px"> <span>1. Copyright</span> <span>A work that expresses a person\'s thoughts or feelings is called a work.</span> <span>The rights you have for a work you create are called copyrights.</span> <span>​2. Privacy</span> <span>Information about a surviving individual, such as code, text, voice, sound, and video that identifies a specific individual.</span> <span>If the information alone does not identify a particular individual, but can be easily combined with other information, this is personal information.</span> <span>Personal information disclosed on the Internet can be easily forged, altered, misused, spread quickly, and cause problems such as invasion of privacy and intimidation.</span> <span></span> <span>3.1. If you use an image that infringes on a third party\'s trademark, copyright, patent, or violates the third party\'s terms of use</span> <span>3.2. If the copyright owner uses unclear content</span> <span>3.3. Infringes on the portrait rights of others (e.g., caricatures, photographs of faces taken without their consent)</span> <span>3.4. Contains content that the copyright owner has not explicitly authorized for use</span> <span>3.5. Does not comply with the laws of the region where the Entry service is provided or violates the rights or interests of</span> <span>3.6. When we may or may disclose information about a specific person or third party</span> </div> <span>Entry may restrict, suspend, change, or terminate the publication of projects or posts that are deemed inappropriate, even if they do not fall within the above guidelines.</span> <span>In addition, in the event of continued violations, sanctions may be imposed against the user, such as blocking the IP.</span> <span>This is the same for projects and posts where a report inquiry is made to an Entry and Entry is considered inappropriate.</span> <span></span> <span>Applicable date: November 28, 2019</span> <p></p> </div>'},321:function(e,t,r){var n=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),i=new P(n||[]);return a._invoke=function(e,t,r){var n=p;return function(o,a){if(n===d)throw new Error("Generator is already running");if(n===g){if("throw"===o)throw a;return C()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=E(i,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===p)throw n=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var c=u(e,t,r);if("normal"===c.type){if(n=r.done?g:l,c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=g,r.method="throw",r.arg=c.arg)}}}(e,r,i),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p="suspendedStart",l="suspendedYield",d="executing",g="completed",f={};function m(){}function h(){}function v(){}var y={};y[a]=function(){return this};var _=Object.getPrototypeOf,b=_&&_(_(S([])));b&&b!==r&&n.call(b,a)&&(y=b);var w=v.prototype=m.prototype=Object.create(y);function L(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function j(e){var t;this._invoke=function(r,o){function a(){return new Promise((function(t,a){!function t(r,o,a,i){var s=u(e[r],e,o);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==typeof p&&n.call(p,"__await")?Promise.resolve(p.__await).then((function(e){t("next",e,a,i)}),(function(e){t("throw",e,a,i)})):Promise.resolve(p).then((function(e){c.value=e,a(c)}),(function(e){return t("throw",e,a,i)}))}i(s.arg)}(r,o,t,a)}))}return t=t?t.then(a,a):a()}}function E(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method))return f;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var o=u(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,f;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function S(e){if(e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}return{next:C}}function C(){return{value:t,done:!0}}return h.prototype=w.constructor=v,v.constructor=h,v[s]=h.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},L(j.prototype),j.prototype[i]=function(){return this},e.AsyncIterator=j,e.async=function(t,r,n,o){var a=new j(c(t,r,n,o));return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},L(w),w[s]="Generator",w[a]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:S(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),f}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},322:function(e,t,r){"use strict";angular.module("mean.common").factory("Comments",["$resource","Global",function(e,t){return e("/api/comment/:commentId",{commentId:"@_id"},{update:{method:"PUT",headers:{"csrf-token":t.csrfToken()}},save:{method:"POST",headers:{"csrf-token":t.csrfToken()}},remove:{method:"DELETE",headers:{"csrf-token":t.csrfToken()}}})}])},501:function(e,t,r){"use strict";angular.module("mean.common").factory("Sprites",["$resource","Global",function(e,t){return e("/api/sprite/:spriteId",{spriteId:"@_id"},{update:{method:"PUT",headers:{"csrf-token":t.csrfToken()}},save:{method:"POST",headers:{"csrf-token":t.csrfToken()}},remove:{method:"DELETE",headers:{"csrf-token":t.csrfToken()}},query:{method:"GET",isArray:!0}})}])},502:function(e,t){angular.module("mean.entry").controller("SpriteController",["$scope","$uibModalInstance","$routeParams","Global","$http","parent","$filter","$q",function(e,t,r,n,o,a,i,s){e.global=n,e.parent=a,e.systemSprites=[],e.uploadPictures=[],e.showCount=24,e.cursor=0,e.fonts=Entry.fonts,e.status={isFontOpen:!1},e.fontData={font:e.fonts[0],bold:!1,underLine:!1,italic:!1,strike:!1,colour:"#000000",background:"#ffffff",lineBreak:!1},e.foreground=!1,e.background=!1,e.fgColor={"background-color":"#000000"},e.bgColor={"background-color":"#ffffff"},e.linebreak=!1,e.main_menu="entrybot_friends",e.menu="",e.searchWord="",e.applyOriginal=!1,e.toggleApplyOriginal=function(){e.applyOriginal=!e.applyOriginal,e.selectedPictures.forEach(p)};var c=function(){e.showCount=Math.max(6*(parseInt($(".tab-right").height()/148)+1),24)};function u(t){var r=_.find(e.selectedSprites||[],{_id:t._id});return t.selected=r?"boxOuter selected":"boxOuter",t}function p(t){var r=!e.applyOriginal&&t.trimmed?t.trimmed:t.origin;return _.isObject(r)&&(t.filename=r.filename,t.dimension.width=r.width,t.dimension.height=r.height),t}e.init=function(){!_.isObject(a)||a.dataLoadCallback&&_.isFunction(a.dataLoadCallback)||(a.dataLoadCallback=null),e.includeContentLoadedQ=s.defer(),e.dataLoadDoneQ=s.defer(),s.all([e.includeContentLoadedQ.promise,e.dataLoadDoneQ.promise]).then(e.applyDataLoadCallback),r.type="default",r.main="entrybot_friends",e.collapse(1),c(),$.isPlainObject(a)&&a.id?e.findSpriteById(a.id,(function(t){e.systemSprites=[t],t.selected="boxOuter selected",e.selectSprite(t),e.dataLoadDoneQ.resolve()})):e.systemSprites=e.findSprites(r.type,r.main,r.sub),e.$on("$includeContentLoaded",_.debounce(e.includeContentLoadedQ.resolve,200)),e.uploadSprite={name:"",type:"user",pictures:[],sounds:[]}},e.applyDataLoadCallback=function(){window.vivid=e,a.dataLoadCallback&&(e.applyDataLoadCallback=_.identity,setTimeout((function(){a.dataLoadCallback(),Entry.dispatchEvent("windowResized")}),200))},e.findSpriteById=function(t,r){o.get("/api/sprite/".concat(t)).then((function(t){var n=t.data;n.selected="boxOuter",e.collapse(0),e.main_menu="",r&&r(n)})).catch((function(e){console.error(e)}))},e.findSprites=function(t,r,n){c();var a=["/api/sprite/browse/".concat(t||"default")];r&&(e.main_menu=r,a.push(encodeURIComponent(r)),n?(e.menu=n,a.push(encodeURIComponent(n))):e.menu=""),o({method:"GET",url:a.join("/")}).success((function(t,r){e.systemSprites=t.map(u).filter((function(e){return!e.hasSvg}))})).error((function(t,r){e.status=r}))},e.search=function(){if(c(),e.searchWord=$("#searchWord").val().replace(/[\{\}\/?.,;:|\)*~`!^\-_+<>@\#$%&\\\=\(\'\"]/gi,""),_.isEmpty(e.searchWord))return entrylms.alert(Lang.Menus.searchword_required),!1;o.get("/api/sprite/search/".concat(encodeURIComponent(e.searchWord.trim()[0]))).then((function(t){e.systemSprites=Entry.Utils.fuzzy.filter(e.searchWord,t.data,{extract:function(e){return e.label&&e.label[window.lang]?e.label[window.lang]:e.name}}).map((function(e){return u(e.original)})),e.collapse(0),e.main_menu=""}))},e.upload=function(){var t=document.getElementById("uploadFile").files;if(!t)return entrylms.alert(Lang.Menus.file_required),!1;if(t.length>10)return entrylms.alert(Lang.Menus.file_upload_max_count),!1;for(var r=[],n=[],o=0,a=t.length;o<a;o++){var i=t[o],s=/^image\//.test(i.type),c=/^image\/gif/.test(i.type),u=/\.eo$/.test(i.name);if(!u&&(!s||c))return entrylms.alert(Lang.Workspace.upload_not_supported_file_msg),document.getElementById("uploadFile").value="",!1;if(i.size>10485760)return entrylms.alert(Lang.Menus.file_upload_max_size),document.getElementById("uploadFile").value="",!1;u?n.push(i):r.push(i)}t.length>0&&e.$apply((function(){e.isUploading=!0}));var p=null,l=null;for(o=0,a=r.length;o<a;o++)i=r[o],p||(p=new FormData).append("type","user"),p.append("uploadFile".concat(o),i);for(o=0,a=n.length;o<a;o++)i=n[o],l||(l=new FormData),l.append("objects",i);e.uploadPictureFile(p,l)},e.uploadPictureFile=function(t,r){var a=s((function(e,r){if(!t)return e({data:[]});o({method:"POST",url:"/rest/picture/upload",data:t,headers:{"Content-Type":void 0,"csrf-token":n.csrfToken()}}).then(e).catch(r)})),i=s((function(e,t){if(!r)return e({data:[]});o({method:"POST",url:"/rest/object/upload",data:r,headers:{"Content-Type":void 0,"csrf-token":n.csrfToken()}}).then(e).catch(t)}));s.all([a,i]).then((function(t){var r=t[0].data,n=t[1].data||[];e.isUploading=!1,e.uploadPictures||(e.uploadPictures=[]),r.forEach((function(t){e.uploadPictures.push(t)})),n.forEach((function(t){t.objects.forEach((function(r){var n=r.objectType;if("textBox"===n){var o=r.text,a=r.entity||{},i=r.name,s=a.font;_.findIndex(e.fonts,(function(e){var t=e.family;return s.indexOf(t)>-1})),s.indexOf("bold"),s.indexOf("italic"),r.selectedPicture={name:i,text:o,objectType:n,options:a,_id:Entry.generateHash(),sprite:t,fileurl:"/img/assets/text_icon.png"}}else r.selectedPicture.sprite=t;e.uploadPictures.push(r.selectedPicture)}))})),document.getElementById("uploadFile").value=""})).catch((function(t){e.isUploading=!1,entrylms.alert(Lang.Msgs.error_occured),document.getElementById("uploadFile").value=""}))},e.collapse=function(t){for(var r=1;r<=12;r++)e["isCollapsed".concat(r)]=!0;t>0&&(e["isCollapsed".concat(t)]=!1,$("#searchWord").val(""))},e.colours=Entry.getColourCodes(),e.currentTab="sprite",e.selectedSprites=[],e.selectedPictures=[],e.selectedColour="#000000",e.applySprite=function(r){r.name=i("nameFilter")(r),e.selectedSprites=[],e.selectedSprites.push(r),t.close({target:e.currentTab,data:e.currentSelected()})},e.selectSprite=function(t){var r=!1;for(var n in e.selectedSprites)e.selectedSprites[n]._id===t._id&&(e.selectedSprites.splice(n,1),r=!0);r?(jQuery(".boxOuter").each((function(){var e=jQuery(this);e.attr("id")===t._id&&e.attr("class","boxOuter")})),e.moveContainer("right")):(e.selectedSprites.push(t),jQuery(".boxOuter").each((function(){var e=jQuery(this);e.attr("id")===t._id&&e.attr("class","boxOuter selected")})),e.moveContainer("left"))},e.moveContainer=function(t){var r=e.selectedSprites;if("upload"==e.currentTab&&(r=e.selectedPictures),!("left"==t&&(r.length-1<5||e.cursor==r.length-1)||"right"==t&&(0==e.cursor||r.length<5&&e.cursor>r.length))){var n=jQuery(".modal_selected_container_moving").eq(0),o=parseInt(n.css("margin-left"));"left"==t?(n.css("margin-left","".concat(o-106,"px")),e.cursor=e.cursor+1):(n.css("margin-left","".concat(o+106,"px")),e.cursor=e.cursor-1)}},e.applyPicture=function(r){r=p(r),o.put("/api/picture/".concat(r._id),r,{headers:{"csrf-token":n.csrfToken()}}).success((function(a,i){o.delete("/api/picture/delete/".concat(r._id),{headers:{"csrf-token":n.csrfToken()}}),e.selectedPictures=[r],t.close({target:e.currentTab,data:e.currentSelected()})}))},e.selectObject=function(t){for(var r in e.selectedPictures)e.selectedPictures[r]._id===t._id&&e.selectedPictures.splice(r,1)},e.selectPicture=function(t){var r=t._id,n=_.findIndex(e.selectedPictures,(function(e){return r===e._id})),o="#".concat(r,".boxOuter");~n?($(o).attr("class","boxOuter"),e.selectedPictures.splice(n,1),e.moveContainer("right")):(e.selectedPictures.push(p(t)),$(o).attr("class","boxOuter selected"),e.moveContainer("left"))},e.changeTab=function(t){jQuery(".modal_selected_container_moving").eq(0).css("margin-left",0),e.currentTab=t},e.tabs=[{title:"Workspace.select_library",category:"sprite",partial:"/views/workspace/modal/sprite_library.html",active:!0},{title:"Workspace.upload",category:"upload",partial:"/views/workspace/modal/sprite_upload.html"},{title:"Workspace.draw_new",category:"newSprite",partial:"/views/workspace/modal/sprite_draw_new.html"},{title:"Workspace.textbox",category:"textBox",partial:"/views/workspace/modal/sprite_text.html"}],e.currentSelected=function(){var t=i("nameFilter");return"sprite"===e.currentTab?(e.selectedSprites.forEach((function(e){e.name=t(e)})),e.selectedSprites):"upload"===e.currentTab?(e.selectedPictures.forEach((function(e){e.name=t(e)})),e.selectedPictures):"textBox"===e.currentTab?"1":null},e.showChoosen=function(){return!_.includes(["textBox","newSprite"],e.currentTab)},e.changeTextColour=function(t){e.fontData.colour=t,e.fgColor={"background-color":t},e.foreground=!1},e.changeBackgroundColour=function(t){e.fontData.background=t,e.bgColor={"background-color":t},e.background=!1},e.changeTextFont=function(t){l(t.family)?(e.fontData.font=t,$.each(e.status,(function(t,r){e.status[t]=!1}))):entrylms.alert(Lang.Menus.not_supported_text)},e.checkInputText=function(t){var r=e.fontData.font;if(!l(r.family))return e.changeTextFont(e.fonts[0]),void entrylms.alert(Lang.Menus.not_supported_text)};var l=function(t){if("Nanum Pen Script"==t||"Jeju Hallasan"==t){var r=jQuery(".modal_textBox").eq(0).val();if(e.linebreak&&(r=jQuery(".modal_textBox").eq(1).val()),null!==/[\u4E00-\u9FFF]/.exec(r))return!1}return!0};e.toggleFontOption=function(t){e.fontData[t]=!e.fontData[t]},e.setFontOption=function(t,r){e.fontData[t]=r},e.getFontOption=function(t){return"/img/assets/text_button_".concat(t,"_").concat(e.fontData[t],".png")},e.getBackgroundColor=function(t){return"/img/assets/text_button_background_".concat(e.background,".png")},e.toggleColorChooser=function(t){"foreground"===t?(e.foreground=!e.foreground,e.foreground&&(e.background=!1)):"background"===t&&(e.background=!e.background,e.background&&(e.foreground=!1))},e.setLinebreak=function(t){if(e.linebreak!=t){e.linebreak=t,e.fontData.lineBreak=t;var r=t?[1,0]:[0,1],n=$(".modal_textBox");n.eq(r.shift()).val(n.eq(r.shift()).val())}},e.ok=function(){e.currentSelected()?1==e.currentSelected()?t.close({target:e.currentTab,data:jQuery(".modal_textBox").eq(e.linebreak?1:0).val(),options:e.fontData}):("upload"==e.currentTab&&e.selectedPictures.forEach((function(e){if(!("sprite"in e)){var t=e._id,r={_id:t,filename:e.filename,origin:e.origin,trimmed:e.trimmed};o.put("/api/picture/".concat(t),r,{headers:{"csrf-token":n.csrfToken()}}).success((function(e,r){o.delete("/api/picture/delete/".concat(t),{headers:{"csrf-token":n.csrfToken()}})}))}})),t.close({target:e.currentTab,data:e.currentSelected()})):entrylms.alert(Lang.Workspace.select_sprite)},e.cancel=function(){t.dismiss("cancel")},e.addNewSprite=function(){t.close({target:"newSprite"})},e.loadMore=function(){e.showCount<e.systemSprites.length&&(e.showCount+=6)},e.dict={WORKSPACE_ADD_OBJECT:Lang.Workspace.add_object,MENUS_APPLY_ORIGINAL_IMAGE:Lang.Menus.apply_original_image,BUTTONS_APPLY:Lang.Buttons.apply,BUTTONS_CANCEL:Lang.Buttons.cancel,MENUS_PICTURE_UPLOAD_WARN_1:Lang.Menus.picture_upload_warn_1}}])},503:function(e,t){angular.module("mean.entry").controller("PictureController",["$scope","$uibModalInstance","$routeParams","Global","$http","parent","$filter","$q",function(e,t,r,n,o,a,i,s){e.global=n,e.parent=a,e.tabs=[{title:"Workspace.select_picture",category:"system",partial:"/views/workspace/modal/picture_library.html",active:!0},{title:"Workspace.upload",category:"upload",partial:"/views/workspace/modal/picture_upload.html"},{title:"Workspace.draw_new",category:"newPicture",partial:"/views/workspace/modal/picture_draw_new.html"}],e.systemPictures=[],e.uploadPictures=[],e.showCount=24,e.cursor=0,e.main_menu="entrybot_friends",e.menu="",e.searchWord="",e.applyOriginal=!1,e.toggleApplyOriginal=function(){e.applyOriginal=!e.applyOriginal;for(var t=e.selectedUpload,r=0,n=t.length;r<n;r++){var o=t[r];!e.applyOriginal&&o.trimmed?(o.filename=o.trimmed.filename,o.dimension.width=o.trimmed.width,o.dimension.height=o.trimmed.height):(o.filename=o.origin.filename,o.dimension.width=o.origin.width,o.dimension.height=o.origin.height)}};var c=function(){var t=$(".tab-right").height(),r=parseInt(t/148);e.showCount=6*(r+1),e.showCount<24&&(e.showCount=24)};function u(t){var r=_.find(e.selectedPictures||[],{_id:t._id});return t.selected=r?"boxOuter selected":"boxOuter",t}e.init=function(){!_.isObject(a)||a.dataLoadCallback&&_.isFunction(a.dataLoadCallback)||(a.dataLoadCallback=null),e.includeContentLoadedQ=s.defer(),e.dataLoadDoneQ=s.defer(),s.all([e.includeContentLoadedQ.promise,e.dataLoadDoneQ.promise]).then(e.applyDataLoadCallback),r.type="default",r.main="entrybot_friends",e.collapse(1),c(),$.isPlainObject(a)&&a.id?e.findPictureById(a.id,(function(t){t.selected="boxOuter selected",e.selectSystem(t),e.dataLoadDoneQ.resolve()})):e.findPictures(r.type,r.main,r.sub)},e.$on("$includeContentLoaded",_.debounce((function(){e.includeContentLoadedQ.resolve()}),200)),e.applyDataLoadCallback=function(){var e=!1;return function(){e||a.dataLoadCallback&&(e=!0,setTimeout((function(){a.dataLoadCallback(),Entry.dispatchEvent("windowResized")}),200))}}(),e.findPictureById=function(t,r){o.get("/api/picture/".concat(t)).then((function(t){var n=t.data;n.selected="boxOuter",e.systemPictures.push(n),e.collapse(0),e.main_menu="",r&&r(n)})).catch((function(e){console.error(e)}))},e.findPictures=function(t,r,n){c();var a="/api/picture/browse";t||(t="default"),a+="/".concat(t),r&&(e.main_menu=r,a+="/".concat(encodeURIComponent(r)),n?(e.menu=n,a+="/".concat(encodeURIComponent(n))):e.menu=""),o({method:"GET",url:a}).success((function(t,r){e.systemPictures=t.map(u).filter((function(e){return"svg"!==e.imageType}))})).error((function(t,r){e.status=r}))},e.search=function(){if(c(),e.searchWord=$("#searchWord").val().replace(/[\{\}\/?.,;:|\)*~`!^\-_+<>@\#$%&\\\=\(\'\"]/gi,""),_.isEmpty(e.searchWord))return entrylms.alert(Lang.Menus.searchword_required),!1;o.get("/api/picture/search/".concat(encodeURIComponent(e.searchWord.trim()[0]))).then((function(t){e.systemPictures=Entry.Utils.fuzzy.filter(e.searchWord,t.data,{extract:function(e){return e.label&&e.label[window.lang]?e.label[window.lang]:e.name}}).map((function(e){return u(e.original)})),e.collapse(0),e.main_menu=""}))},e.upload=function(){var t=document.getElementById("uploadFile").files;if(!t||0===t.length)return entrylms.alert(Lang.Menus.file_required),!1;if(t.length>10)return entrylms.alert(Lang.Menus.file_upload_max_count),!1;for(var r=0,n=t.length;r<n;r++){var o=t[r],a=/^image\//.test(o.type),i=/^image\/gif/.test(o.type);if(!a||i)return entrylms.alert(Lang.Workspace.upload_not_supported_file_msg),document.getElementById("uploadFile").value="",!1;if(o.size>10485760)return entrylms.alert(Lang.Menus.file_upload_max_size),document.getElementById("uploadFile").value="",!1}e.$apply((function(){e.isUploading=!0}));var s=new FormData;for(s.append("type","user"),r=0,n=t.length;r<n;r++)o=t[r],s.append("uploadFile".concat(r),o);e.uploadPictureFile(s)},e.uploadPictureFile=function(t){var r=document.querySelector('meta[name="csrf-token"]').getAttribute("content");$.ajax({url:"/rest/picture/upload",data:t,cache:!1,contentType:!1,processData:!1,type:"POST",headers:{"csrf-token":r},success:function(t){var r=t.uploads;r&&r.length>0&&e.$apply((function(){e.isUploading=!1,e.uploadPictures||(e.uploadPictures=[]),r.forEach((function(t){e.uploadPictures.push(t)}))}))},error:function(){e.$apply((function(){e.isUploading=!1,entrylms.alert(Lang.Msgs.error_occured)}))}})},e.collapse=function(t){for(var r=1;r<=12;r++)e["isCollapsed".concat(r)]=!0;t>0&&(e["isCollapsed".concat(t)]=!1,$("#searchWord").val(""))},e.currentTab="system",e.selectedPictures=[],e.selectedUpload=[],e.applySystem=function(r){e.selectedPictures=[],e.selectedPictures.push(r),t.close({target:e.currentTab,data:e.currentSelected()})},e.selectSystem=function(t){var r=!1;for(var n in e.selectedPictures)e.selectedPictures[n]._id===t._id&&(e.selectedPictures.splice(n,1),r=!0);r?(jQuery(".boxOuter").each((function(){var e=jQuery(this);e.attr("id")===t._id&&e.attr("class","boxOuter")})),e.moveContainer("right")):(e.selectedPictures.push(t),jQuery(".boxOuter").each((function(){var e=jQuery(this);e.attr("id")===t._id&&e.attr("class","boxOuter selected")})),e.moveContainer("left"))},e.applyUpload=function(r){!e.applyOriginal&&r.trimmed?(r.filename=r.trimmed.filename,r.dimension.width=r.trimmed.width,r.dimension.height=r.trimmed.height):(r.filename=r.origin.filename,r.dimension.width=r.origin.width,r.dimension.height=r.origin.height),o.put("/api/picture/".concat(r._id),r,{headers:{"csrf-token":n.csrfToken()}}).success((function(a,i){o.delete("/api/picture/delete/".concat(r._id),{headers:{"csrf-token":n.csrfToken()}}),e.selectedUpload=[],e.selectedUpload.push(r),t.close({target:e.currentTab,data:e.currentSelected()})}))},e.selectUpload=function(t){var r=!1;for(var n in e.selectedUpload)e.selectedUpload[n]._id===t._id&&(e.selectedUpload.splice(n,1),r=!0);if(r)jQuery(".boxOuter").each((function(){var e=jQuery(this);e.attr("id")===t._id&&e.attr("class","boxOuter")})),e.moveContainer("right");else{var o=JSON.parse(JSON.stringify(t));e.applyOriginal&&(o.filename=o.origin.filename,o.dimension.width=o.origin.width,o.dimension.height=o.origin.height),e.selectedUpload.push(o),jQuery(".boxOuter").each((function(){var e=jQuery(this);e.attr("id")===t._id&&e.attr("class","boxOuter selected")})),e.moveContainer("left")}},e.changeTab=function(t){jQuery(".modal_selected_container_moving").eq(0).css("margin-left",0),e.currentTab=t},e.moveContainer=function(t){var r=e.selectedPictures;if("upload"==e.currentTab&&(r=e.selectedUpload),!("left"==t&&(e.cursor==r.length-1||r.length-1<5)||"right"==t&&(0==e.cursor||r.length<5&&e.cursor>r.length))){var n=jQuery(".modal_selected_container_moving").eq(0),o=parseInt(n.css("margin-left"));"left"==t?(n.css("margin-left","".concat(o-106,"px")),e.cursor=e.cursor+1):(n.css("margin-left","".concat(o+106,"px")),e.cursor=e.cursor-1)}},e.currentSelected=function(){return"system"===e.currentTab?(e.selectedPictures.forEach((function(e){e.name=i("nameFilter")(e)})),e.selectedPictures):"upload"===e.currentTab?e.selectedUpload:"textBox"===e.currentTab?"textBox":null},e.showChoosen=function(){return"newPicture"!=e.currentTab},e.ok=function(){if(e.currentSelected()){for(var r=e.currentSelected(),a=0,i=r.length;a<i;a++){var s=r[a];s.trimmed&&o.put("/api/picture/".concat(s._id),s,{headers:{"csrf-token":n.csrfToken()}}).success((function(e,t){o.delete("/api/picture/delete/".concat(s._id),{headers:{"csrf-token":n.csrfToken()}})}))}t.close({target:e.currentTab,data:e.currentSelected()})}else entrylms.alert(Lang.Workspace.select_sprite)},e.cancel=function(){t.dismiss("cancel")},e.addNewPicture=function(){t.close({target:"new"})},e.loadMore=function(){e.showCount<e.systemPictures.length&&(e.showCount+=6)},e.dict={WORKSPACE_ADD_PICTURE:Lang.Workspace.add_picture,MENUS_APPLY_ORIGINAL_IMAGE:Lang.Menus.apply_original_image,WORKSPACE_ALL:Lang.Workspace.all,CATEGORY_ANIMAL:Lang.Category.animal,CATEGORY_ANIMAL_FLYING:Lang.Category.animal_flying,CATEGORY_ANIMAL_LAND:Lang.Category.animal_land,CATEGORY_ANIMAL_WATER:Lang.Category.animal_water,CATEGORY_ANIMAL_OTHERS:Lang.Category.animal_others,CATEGORY_ENTRYBOT_FRIENDS:Lang.Category.entrybot_friends,CATEGORY_PEOPLE:Lang.Category.people,CATEGORY_PLANT:Lang.Category.plant,CATEGORY_PLANT_FLOWER:Lang.Category.plant_flower,CATEGORY_PLANT_TREE:Lang.Category.plant_tree,CATEGORY_PLANT_GRASS:Lang.Category.plant_grass,CATEGORY_PLANT_OTHERS:Lang.Category.plant_others,CATEGORY_VEHICLES:Lang.Category.vehicles,CATEGORY_VEHICLES_FLYING:Lang.Category.vehicles_flying,CATEGORY_VEHICLES_LAND:Lang.Category.vehicles_land,CATEGORY_VEHICLES_WATER:Lang.Category.vehicles_water,CATEGORY_VEHICLES_OTHERS:Lang.Category.vehicles_others,CATEGORY_ARCHITECT:Lang.Category.architect,CATEGORY_ARCHITECT_BUILDING:Lang.Category.architect_building,CATEGORY_ARCHITECT_MONUMENT:Lang.Category.architect_monument,CATEGORY_ARCHITECT_OTHERS:Lang.Category.architect_others,CATEGORY_FOOD:Lang.Category.food,CATEGORY_FOOD_VEGETABLES:Lang.Category.food_vegetables,CATEGORY_FOOD_MEAT:Lang.Category.food_meat,CATEGORY_FOOD_DRINK:Lang.Category.food_drink,CATEGORY_FOOD_OTHERS:Lang.Category.food_others,CATEGORY_ENVIRONMENT_NATURE:Lang.Category.environment_nature,CATEGORY_ENVIRONMENT_SPACE:Lang.Category.environment_space,CATEGORY_ENVIRONMENT_OTHERS:Lang.Category.environment_others,CATEGORY_ENVIRONMENT:Lang.Category.environment,CATEGORY_STUFF:Lang.Category.stuff,CATEGORY_STUFF_LIVING:Lang.Category.stuff_living,CATEGORY_STUFF_HOBBY:Lang.Category.stuff_hobby,CATEGORY_STUFF_OTHERS:Lang.Category.stuff_others,CATEGORY_FANTASY:Lang.Category.fantasy,CATEGORY_INTERFACE:Lang.Category.interface,CATEGORY_INTERFACE_WEBSITE:Lang.Category.interface_website,CATEGORY_INTERFACE_GAME:Lang.Category.interface_game,CATEGORY_INTERFACE_OTHERS:Lang.Category.interface_others,CATEGORY_BACKGROUND:Lang.Category.background,CATEGORY_BACKGROUND_OUTDOOR:Lang.Category.background_outdoor,CATEGORY_BACKGROUND_INDOOR:Lang.Category.background_indoor,CATEGORY_BACKGROUND_NATURE:Lang.Category.background_nature,CATEGORY_BACKGROUND_OTHERS:Lang.Category.background_others,MENUS_DRAW_NEW_GO:Lang.Menus.draw_new_go,MENUS_DRAW_NEW_STAY:Lang.Menus.draw_new_stay,MENUS_FILE_UPLOAD_DESC_2:Lang.Menus.file_upload_desc_2,MENUS_FILE_UPLOAD_DESC_3:Lang.Menus.file_upload_desc_3,MENUS_FILE_UPLOAD_DESC_4:Lang.Menus.file_upload_desc_4,MENUS_FILE_UPLOAD_DESC_5:Lang.Menus.file_upload_desc_5,WORKSPACE_UPLOAD_ADDFILE:Lang.Workspace.upload_addfile,MENUS_PICTURE_UPLOAD_WARN_1:Lang.Menus.picture_upload_warn_1}}])},504:function(e,t){function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}angular.module("mean.entry").controller("SoundController",["$scope","$uibModalInstance","$routeParams","Global","$http","parent","$filter",function(e,t,n,o,a,i,s){var c;function u(t){var r=t._id,n=t.filename,o="/uploads/".concat(n.substring(0,2),"/").concat(n.substring(2,4),"/").concat(n).concat(t.ext);Entry.soundQueue.loadFile({id:t._id,src:o,type:createjs.LoadQueue.SOUND});var a=_.find(e.selectedSystem,(function(e){return r===e._id}));return t.selected=a?"boxOuter selected":"boxOuter",t}e.global=o,e.parent=i,e.systemSounds=[],e.uploadSounds=[],e.isCollapsed1=!1,e.isCollapsed2=!0,e.isCollapsed3=!0,e.isCollapsed4=!0,e.isCollapsed5=!0,e.isCollapsed6=!0,e.main_menu="사람",e.menu="",e.searchWord="",e.cursor=0,e.init=function(){n.type="default",n.main="사람",$.isPlainObject(i)&&i.id?e.findSoundById(i.id,(function(t){t.selected="boxOuter selected",e.selectSystem(t),e.applyDataLoadCallback()})):e.findSounds(n.type,n.main,n.sub)},e.applyDataLoadCallback=function(){var e=!1;return function(){e||i.dataLoadCallback&&_.isFunction(i.dataLoadCallback)&&(e=!0,setTimeout((function(){i.dataLoadCallback(),Entry.dispatchEvent("windowResized")}),200))}}(),e.findSoundById=function(t,r){a.get("/api/sound/".concat(t)).then((function(t){var n=t.data,o="/uploads/".concat(n.filename.substring(0,2),"/").concat(n.filename.substring(2,4),"/").concat(n.filename).concat(n.ext);Entry.soundQueue.loadFile({id:n._id,src:o,type:createjs.LoadQueue.SOUND}),n.selected="boxOuter",n.name=s("nameFilter")(n),e.systemSounds.push(n),e.collapse(0),e.main_menu="",r&&r(n)})).catch((function(e){console.error(e)}))},e.findSounds=function(t,r,n){var o="/api/sound/browse";t||(t="default"),o+="/".concat(t),r&&(e.main_menu=r,o+="/".concat(encodeURIComponent(r)),n?(e.menu=n,o+="/".concat(encodeURIComponent(n))):e.menu=""),a({method:"GET",url:o}).success((function(t,r){e.systemSounds=t.map(u)})).error((function(t,r){e.status=r}))},e.search=function(){if(e.searchWord=$("#searchWord").val().replace(/[\{\}\/?.,;:|\)*~`!^\-_+<>@\#$%&\\\=\(\'\"]/gi,""),_.isEmpty(e.searchWord))return entrylms.alert(Lang.Menus.searchword_required),!1;a.get("/api/sound/search/".concat(encodeURIComponent(e.searchWord.trim()[0]))).then((function(t){e.systemSounds=Entry.Utils.fuzzy.filter(e.searchWord,t.data,{extract:function(e){return e.label&&e.label[window.lang]?e.label[window.lang]:e.name}}).map((function(e){return u(e.original)})),e.collapse(0),e.main_menu=""}))},e.upload=function(){var t=document.getElementById("uploadFile").files;if(!document.getElementById("uploadFile").value)return!1;if(!t)return entrylms.alert(Lang.Menus.file_required),!1;if(t.length>10)return entrylms.alert(Lang.Menus.file_upload_max_count),!1;for(var r=0,n=t.length;r<n;r++){if((a=t[r]).name.toLowerCase().indexOf(".mp3")<0)return entrylms.alert(Lang.Workspace.check_audio_msg),document.getElementById("uploadFile").value="",!1;if(a.size>10485760)return entrylms.alert(Lang.Menus.file_upload_max_size),document.getElementById("uploadFile").value="",!1}e.$apply((function(){e.isUploading=!0}));var o=new FormData;for(o.append("type","user"),r=0,n=t.length;r<n;r++){var a=t[r];o.append("uploadFile".concat(r),a)}e.uploadSoundFile(o)},e.uploadSoundFile=function(t){var r=document.querySelector('meta[name="csrf-token"]').getAttribute("content");$.ajax({url:"/rest/sound/upload",data:t,cache:!1,contentType:!1,processData:!1,type:"POST",headers:{"csrf-token":r},success:function(t){e.$apply((function(){e.isUploading=!1,t.forEach((function(t){var r="/uploads/".concat(t.filename.substring(0,2),"/").concat(t.filename.substring(2,4),"/").concat(t.filename).concat(t.ext);Entry.soundQueue.loadFile({id:t._id,src:r,type:createjs.LoadQueue.SOUND}),e.uploadSounds.push(t)}))}))},error:function(t){e.$apply((function(){e.isUploading=!1,entrylms.alert(Lang.Workspace.check_audio_msg)}))}})},e.collapse=function(t){for(var r=1;r<10;r++)e["isCollapsed".concat(r)]=!0;t>0&&(e["isCollapsed".concat(t)]=!1,$("#searchWord").val(""))},e.currentTab="system",e.selectedSystem=[],e.selectedUpload=[],e.selectSystem=function(t){var r=t._id,n=_.findIndex(e.selectedSystem,(function(e){return r===e._id})),o="#".concat(r,".boxOuter");~n?(e.selectedSystem.splice(n,1),createjs.Sound.stop(),jQuery(o).attr("class","boxOuter"),e.moveContainer("right")):(createjs.Sound.play(t._id),e.selectedSystem.push(t),jQuery(o).attr("class","boxOuter selected"),e.moveContainer("left"))},e.moveContainer=function(t){var r=jQuery(".modal_selected_container_moving").eq(0),n=e.selectedSystem;if("upload"==e.currentTab&&(n=e.selectedUpload),!("left"==t&&(n.length-1<5||e.cursor==n.length-1)||"right"==t&&(0==e.cursor||n.length<5&&e.cursor>n.length))){var o=parseInt(r.css("margin-left"));"left"==t?(r.css("margin-left","".concat(o-106,"px")),e.cursor=e.cursor+1):(r.css("margin-left","".concat(o+106,"px")),e.cursor=e.cursor-1)}},e.applySystem=function(r){e.selectedSystem=[],e.selectedSystem.push(r),t.close({target:e.currentTab,data:e.currentSelected()})},e.selectUpload=function(t){"/uploads/".concat(t.filename.substring(0,2),"/").concat(t.filename.substring(2,4),"/").concat(t.filename).concat(t.ext);var r=!0;for(var n in e.selectedUpload)e.selectedUpload[n]._id===t._id&&(e.selectedUpload.splice(n,1),r=!1);r?(e.selectedUpload.push(t),createjs.Sound.play(t._id),jQuery(".boxOuter").each((function(){var e=jQuery(this);e.attr("id")===t._id&&e.attr("class","boxOuter selected")}))):(createjs.Sound.stop(),jQuery(".boxOuter").each((function(){var e=jQuery(this);e.attr("id")===t._id&&e.attr("class","boxOuter")})))},e.applyUpload=function(r){e.selectedUpload=[],e.selectedUpload.push(r),t.close({target:e.currentTab,data:e.currentSelected()})},e.changeTab=function(t){jQuery(".modal_selected_container_moving").eq(0).css("margin-left",0),e.currentTab=t},e.currentSelected=function(){if(e.currentTab,"system"===e.currentTab){var t=s("nameFilter");return e.selectedSystem.forEach((function(e){e.name=t(e)})),e.selectedSystem}return"upload"===e.currentTab?e.selectedUpload:"textBox"===e.currentTab?"textBox":null},e.ok=function(){e.currentSelected()?t.close({target:e.currentTab,data:e.currentSelected()}):entrylms.alert(Lang.Workspace.select_sprite),createjs.Sound.stop()},e.cancel=function(){t.dismiss("cancel"),createjs.Sound.stop()},e.dict=(r(c={WORKSPACE_SOUND_ADD:Lang.Workspace.sound_add,WORKSPACE_SELECT_SOUND:Lang.Workspace.select_sound,MENUS_PEOPLE:Lang.Menus.people,MENUS_ALL:Lang.Menus.all,MENUS_LIFE:Lang.Menus.life,MENUS_ANIMAL_INSECT:Lang.Menus.animal_insect,MENUS_INSTRUMENT:Lang.Menus.instrument,MENUS_THINGS:Lang.Menus.things,MENUS_VEHICLES:Lang.Menus.vehicles,MENUS_OTHERS:Lang.Menus.others,MENUS_FANTASY:Lang.Menus.fantasy},"MENUS_INSTRUMENT",Lang.Menus.instrument),r(c,"MENUS_PIANO",Lang.Menus.piano),r(c,"MENUS_MARIMBA",Lang.Menus.marimba),r(c,"MENUS_DRUM",Lang.Menus.drum),r(c,"MENUS_JANGGU",Lang.Menus.janggu),r(c,"MENUS_SOUND_EFFECT",Lang.Menus.sound_effect),r(c,"MENUS_OTHERS_INSTRUMENT",Lang.Menus.others_instrument),r(c,"WORKSPACE_UPLOAD",Lang.Workspace.upload),r(c,"WORKSPACE_UPLOAD_ADDFILE",Lang.Workspace.upload_addfile),r(c,"BUTTONS_APPLY",Lang.Buttons.apply),r(c,"BUTTONS_CANCEL",Lang.Buttons.cancel),r(c,"MENUS_SOUND_UPLOAD_WARN_1",Lang.Menus.sound_upload_warn_1),c)}])},505:function(e,t,r){e.exports=r(666)},510:function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},511:function(e,t,r){"use strict";var n=r(8);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var a;if(r)a=r(t);else if(n.isURLSearchParams(t))a=t.toString();else{var i=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),i.push(o(t)+"="+o(e))})))})),a=i.join("&")}if(a){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}},512:function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},513:function(e,t,r){"use strict";(function(t){var n=r(8),o=r(671),a={"Content-Type":"application/x-www-form-urlencoded"};function i(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s={adapter:function(){var e;return"undefined"!=typeof XMLHttpRequest?e=r(514):void 0!==t&&"[object process]"===Object.prototype.toString.call(t)&&(e=r(514)),e}(),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(i(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(i(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(e){s.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){s.headers[e]=n.merge(a)})),e.exports=s}).call(this,r(581))},514:function(e,t,r){"use strict";var n=r(8),o=r(672),a=r(511),i=r(674),s=r(677),c=r(678),u=r(515);e.exports=function(e){return new Promise((function(t,p){var l=e.data,d=e.headers;n.isFormData(l)&&delete d["Content-Type"];var g=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",m=e.auth.password||"";d.Authorization="Basic "+btoa(f+":"+m)}var h=i(e.baseURL,e.url);if(g.open(e.method.toUpperCase(),a(h,e.params,e.paramsSerializer),!0),g.timeout=e.timeout,g.onreadystatechange=function(){if(g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in g?s(g.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:r,config:e,request:g};o(t,p,n),g=null}},g.onabort=function(){g&&(p(u("Request aborted",e,"ECONNABORTED",g)),g=null)},g.onerror=function(){p(u("Network Error",e,null,g)),g=null},g.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),p(u(t,e,"ECONNABORTED",g)),g=null},n.isStandardBrowserEnv()){var v=r(679),y=(e.withCredentials||c(h))&&e.xsrfCookieName?v.read(e.xsrfCookieName):void 0;y&&(d[e.xsrfHeaderName]=y)}if("setRequestHeader"in g&&n.forEach(d,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete d[t]:g.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(g.withCredentials=!!e.withCredentials),e.responseType)try{g.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&g.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&g.upload&&g.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){g&&(g.abort(),p(e),g=null)})),void 0===l&&(l=null),g.send(l)}))}},515:function(e,t,r){"use strict";var n=r(673);e.exports=function(e,t,r,o,a){var i=new Error(e);return n(i,t,r,o,a)}},516:function(e,t,r){"use strict";var n=r(8);e.exports=function(e,t){t=t||{};var r={},o=["url","method","params","data"],a=["headers","auth","proxy"],i=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];n.forEach(o,(function(e){void 0!==t[e]&&(r[e]=t[e])})),n.forEach(a,(function(o){n.isObject(t[o])?r[o]=n.deepMerge(e[o],t[o]):void 0!==t[o]?r[o]=t[o]:n.isObject(e[o])?r[o]=n.deepMerge(e[o]):void 0!==e[o]&&(r[o]=e[o])})),n.forEach(i,(function(n){void 0!==t[n]?r[n]=t[n]:void 0!==e[n]&&(r[n]=e[n])}));var s=o.concat(a).concat(i),c=Object.keys(t).filter((function(e){return-1===s.indexOf(e)}));return n.forEach(c,(function(n){void 0!==t[n]?r[n]=t[n]:void 0!==e[n]&&(r[n]=e[n])})),r}},517:function(e,t,r){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},581:function(e,t){var r,n,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var c,u=[],p=!1,l=-1;function d(){p&&c&&(p=!1,c.length?u=c.concat(u):l=-1,u.length&&g())}function g(){if(!p){var e=s(d);p=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,p=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new f(e,t)),1!==u.length||p||s(g)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},6:function(e,t,r){e.exports=r(321)},659:function(e,t){jQuery.fn.fadeSlideShow=function(e){return this.each((function(){settings=jQuery.extend({width:640,height:480,speed:"slow",interval:3e3,PlayPauseElement:"fssPlayPause",PlayText:"Play",PauseText:"Pause",NextElement:"fssNext",NextElementText:"Next >",PrevElement:"fssPrev",PrevElementText:"< Prev",ListElement:"fssList",ListLi:"fssLi",ListLiActive:"fssActive",addListToId:!1,allowKeyboardCtrl:!0,autoplay:!0},e),jQuery(this).css({width:settings.width,height:settings.height,position:"relative",overflow:"hidden"}),jQuery("> *",this).css({position:"absolute",width:settings.width,height:settings.height});var t=jQuery("> *",this).length,r=t-=1,n=jQuery("> *",this),o=this,a=!1,i=function(){a=setInterval((function(){if(n.eq(r).fadeOut(settings.speed),settings.ListElement){var e=t-r+1;e>t&&(e=0),jQuery("#"+settings.ListElement+" li").removeClass(settings.ListLiActive),jQuery("#"+settings.ListElement+" li").eq(e).addClass(settings.ListLiActive)}r<=0?(n.fadeIn(settings.speed),r=t):r-=1}),settings.interval),settings.PlayPauseElement&&jQuery("#"+settings.PlayPauseElement).html(settings.PauseText)},s=function(){clearInterval(a),a=!1,settings.PlayPauseElement&&jQuery("#"+settings.PlayPauseElement).html(settings.PlayText)},c=function(e){e<0?e=t:e>t&&(e=0),e>=r?jQuery("> *:lt("+(e+1)+")",o).fadeIn(settings.speed):e<=r&&jQuery("> *:gt("+e+")",o).fadeOut(settings.speed),r=e,settings.ListElement&&(jQuery("#"+settings.ListElement+" li").removeClass(settings.ListLiActive),jQuery("#"+settings.ListElement+" li").eq(t-e).addClass(settings.ListLiActive))};if(settings.ListElement){for(var u=0,p="";u<=t;)p=0==u?p+'<li class="'+settings.ListLi+u+" "+settings.ListLiActive+'"><a href="#"></a></li>':p+'<li class="'+settings.ListLi+u+'"><a href="#"></a></li>',u++;var l='<ul id="'+settings.ListElement+'">'+p+"</ul>";settings.addListToId?jQuery("#"+settings.addListToId).append(l):jQuery(this).after(l),jQuery("#"+settings.ListElement+" a").bind("click",(function(){var e=jQuery("#"+settings.ListElement+" a").index(this);return s(),c(t-e),!1}))}settings.PlayPauseElement&&(jQuery("#"+settings.PlayPauseElement).css("display")||jQuery(this).after('<a href="#" id="'+settings.PlayPauseElement+'"></a>'),settings.autoplay?jQuery("#"+settings.PlayPauseElement).html(settings.PauseText):jQuery("#"+settings.PlayPauseElement).html(settings.PlayText),jQuery("#"+settings.PlayPauseElement).bind("click",(function(){return a?s():i(),!1}))),settings.NextElement&&(jQuery("#"+settings.NextElement).css("display")||jQuery(this).after('<a href="#" id="'+settings.NextElement+'">'+settings.NextElementText+"</a>"),jQuery("#"+settings.NextElement).bind("click",(function(){return nextSlide=r-1,s(),c(nextSlide),!1}))),settings.PrevElement&&(jQuery("#"+settings.PrevElement).css("display")||jQuery(this).after('<a href="#" id="'+settings.PrevElement+'">'+settings.PrevElementText+"</a>"),jQuery("#"+settings.PrevElement).bind("click",(function(){return prevSlide=r+1,s(),c(prevSlide),!1}))),settings.allowKeyboardCtrl&&jQuery(document).bind("keydown",(function(e){if(39==e.which){var t=r-1;s(),c(t)}else if(37==e.which){var n=r+1;s(),c(n)}else 32==e.which&&(a?s():i())})),settings.autoplay?i():a=!1}))}},663:function(e,t,r){"use strict";r.r(t);var n=r(6),o=r.n(n);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}angular.module("mean.workspace").controller("WorkspaceController",["$scope","$rootScope","$route","$routeParams","$uibModal","$http","$location","$log","$filter","Global","Sprites","myProject","Projects","$download","$downloadPost","$cookies","CloudCache",function(e,t,r,n,c,u,p,l,d,g,f,m,h,v,y,b,w){var L="localStorageProject",j="localStorageProjectReload";e.isChanged=!0,e.isSaving=!1;var E,k=!1,T={},P=[],S=void 0===window.localStorage?void 0:window.localStorage,C=!(void 0===S||void 0===window.JSON),O=_.debounce(q,200);function A(t){Entry.loadProject(t),e.project||(e.project=t),e.project.likeCnt=0,e.project.visit=0,e.project.isopen=!1,e.project.parent=t._id,e.project.user=g.user._id,Y(),z("".concat(t.name," ").concat(Lang.Workspace.project_copied)),Entry.cloudSavable=!1}function M(){x();var r=n.projectId,a=n.groupId;if(r)h.get({projectId:r},function(){var r=function(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){s(a,n,o,i,c,"next",e)}function c(e){s(a,n,o,i,c,"throw",e)}i(void 0)}))}}(o.a.mark((function r(n){var i;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:U(),e.project=n,t.$broadcast("projectLoaded",{id:n._id}),n.user._id==g.user._id||"admin"===g.user.role?(e.project=n,Entry.loadProject(n),z(n.name),setTimeout((function(){u.get("/uploads/thumb/".concat(n._id.toString().substring(0,4),"/").concat(n._id,".png")).error((function(){u.post("/rest/project/thumbnail/".concat(n._id),{thumbnail:X()},{headers:{"csrf-token":g.csrfToken()}})}))}),100)):n.isopen?(e.project=n,A(n)):a?(i=g.user._id,u({method:"GET",url:"/api/getGroupList"}).success((function(t){t&&null!=t||(t=[]),u({method:"GET",url:"/api/group/findByMember/".concat(i)}).success((function(r){var o=!1;null!=r&&r.length>0&&(t=t.concat(r));for(var i=0;i<t.length;i++){var s=t[i];if(String(s._id)==a){o=!0,e.project=n,A(n);break}}o||entrylms.alert(Lang.Workspace.cannot_open_private_project).on("hide",(function(){window.location.href="/"}))})).error((function(){entrylms.alert(Lang.Workspace.cannot_open_private_project).on("hide",(function(){window.location.href="/"}))}))})).error((function(){entrylms.alert(Lang.Workspace.cannot_open_private_project).on("hide",(function(){window.location.href="/"}))}))):entrylms.alert(Lang.Workspace.cannot_open_private_project).on("hide",(function(){window.location.href="/"}));case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());else{U();var i=Entry.getStartProject(Entry.mediaFilePath);i.objects[0]=H(i.objects[0]),i=Entry.loadProject(i),e.project=new h(i);var c=Math.floor(Math.random()*Lang.Workspace.PROJECTDEFAULTNAME.length);z("".concat(Lang.Workspace.PROJECTDEFAULTNAME[c]," ").concat(Lang.Workspace.project))}}function x(){var t=!1,r=!0===EntryStatic.isPracticalCourse,n=r?"practicalCourseNotice":"workspaceTutorialPopup",o=g.user||{};if(o._id){var a=o.checkPopupList||[];_.includes(a,n)||(t=!0,a.push(n),u.post("/api/users/update",{checkPopupList:a},{headers:{"csrf-token":g.csrfToken()}}))}else n+="Session",b.getObject(n)||(t=!0,b.putObject(n,!0));t&&(r&&(e.practicalTooltip||(e.practicalTooltip=new Entry.Tooltip([{content:Lang.Workspace.practical_course_tooltip,target:$(".modeLabel"),direction:"down"}],{dimmed:!1,indicator:!0})),setTimeout((function(){e.practicalTooltip.alignTooltips()}),800)),I())}function I(){var e="practicalCourseNotice";!0!==EntryStatic.isPracticalCourse&&(e+=" workspaceTutorialPopup"),ne(e)}function G(e){x(),S.removeItem("lang"),oe(e),S.removeItem(j),q()}function U(){S.removeItem(L);var e=g.getUserId();e&&S.removeItem(e),k&&K()}function D(e){var t=e.script.getBlockList(),r=Entry.variableContainer.getObjectVariables(t);r.objects=[e.toJSON()],u({method:"POST",url:"/project/exportObject",headers:{"csrf-token":g.csrfToken()},data:r}).then((function(t){var r=t.data||{};if(!r.objectId)throw new Error("Not Found Object Id");W("/project/downloadObject/".concat(r.objectId,"/").concat(g.safeFilename(e.name)))})).catch((function(){entrylms.alert(Lang.Msgs.error_occured)}))}function B(){c.open({templateUrl:"/views/study/custom/lecture/modal/projects.html",controller:"ProjectsModalController",resolve:{parent:function(){return"workspace"}},backdrop:!1,keyboard:!1}).result.then((function(e){u({method:"GET",url:"/api/project/".concat(e.selectedItem._id,"?like=true")}).success((function(e){G(e)}))}))}function N(){new entrylms.Modal([{type:"LIST_IMPORT",theme:"BLUE"}]).on("click",(function(e,t){switch(e){case"save":if(1===t.length&&""===t[0])entrylms.alert(Lang.Menus.nothing_to_import);else{var r=Entry.variableContainer.selectedList;r.array_=t.map((function(e){return{data:e}})),Entry.do("listChangeLength",r.id_,r.array_.length)}}})).show()}function R(t){if(e.project.name=g.htmlencode($("#project_name").val()),!e.project.name){var r=Math.floor(Math.random()*Lang.Workspace.PROJECTDEFAULTNAME.length);e.project.name="".concat(Lang.Workspace.PROJECTDEFAULTNAME[r]," ").concat(Lang.Workspace.project)}var n=Entry.getMainWS();if(n)try{n.syncCode&&n.syncCode()}catch(e){if(n.vimBoard._parser._onError)return void entrylms.alert(Lang.TextCoding[Entry.TextCodingError.ALERT_NO_SAVE_ON_ERROR])}e.doPopupControl({type:"spinner",msg:Lang.Workspace.saving_msg}),e.isSaving=!0,e.project||(e.project=new h({})),Entry.stage.handle.setVisible(!1),Entry.stage.update();var o=Entry.exportProject(e.project);if(e.project.isPracticalCourse=!!EntryStatic.isPracticalCourse,!o)return re({customMessage:Lang.Workspace.object_not_exist_error});g.user&&g.user._id||"export"!==t?(e.project._id?e.project.$update():e.project.$save()).then((function(e){ee(e,{tag:t})}),re):u.post("/project/pack",{projectData:e.project},{headers:{"api-token":window.accessToken}}).then((function(t){var r=(t.data||{}).tempId,n=encodeURIComponent(g.safeFilename(e.project.name));W("/project/download/".concat(r,"/").concat(n)),e.doPopupControl({type:"hide"}),e.isSaving=!1,K(!0)})).catch((function(t){501===t.status?entrylms.alert(t.data):entrylms.alert(Lang.Msgs.error_occured),e.doPopupControl({type:"hide"}),e.isSaving=!1}))}function W(e){v.download(e)}function F(){var t=Entry.getMainWS();if(t)try{t.syncCode()}catch(e){if(t.vimBoard._parser._onError)return void entrylms.alert(Lang.TextCoding[Entry.TextCodingError.ALERT_NO_SAVE_ON_ERROR])}e.doPopupControl({type:"spinner",msg:Lang.Workspace.saving_msg}),e.isSaving=!0,e.project.parent=e.project._id,Y(),e.project.likeCnt=0,e.project.visit=0,e.project.isopen=!1,e.project.user=g.user._id,e.project||(e.project=new h({}));var r=m.getProjectName();r&&r!==e.project.name?e.project.name=r:e.project.name+=" ".concat(Lang.Workspace.project_copied);var n=Entry.exportProject(e.project);if(e.project.isPracticalCourse=!!EntryStatic.isPracticalCourse,!n)return re({customMessage:Lang.Workspace.object_not_exist_error});e.project.$save().then(ee,re)}$(document).on("touchend",(function(e){$(e.target).closest(".dropdown").length||$("body").click()})),e.initWorkspace=function(){e.global=g,K(!0),$(window).on("beforeunload",Z);var r=!0;!0===EntryStatic.isPracticalCourse?($("html").addClass("practical_course_mode"),m.setMode("practical_course"),T=EntryStatic.initOptions,P=EntryStatic.hwCategoryList,r=!1):($("html").addClass("default_mode"),m.setMode("default"));var o=window.platform.type?"tablet":null,a=window.hashId||Entry.generateHash(),i={type:"workspace",fonts:EntryStatic.fonts,libDir:"/lib",device:o,textCodingEnable:r,hashId:a},s={loadInterface:!!n.loadInterface};$.extend(i,T,s),Entry.init(document.getElementById("workspace"),i),e.injectWorkspace();var c=Entry.addEventListener.bind(Entry);c("hwChanged",e.hwChanged),c("hwDownload",e.hwDownload),c("saveWorkspace",e.saveWorkspace),c("saveAsWorkspace",e.saveAsWorkspace),c("openSpriteManager",e.openSpriteManager),c("openPictureManager",e.openPictureManager),c("openSoundManager",e.openSoundManager),c("openExpansionBlockManager",e.openExpansionBlockManager),c("saveCanvasImage",e.saveCanvasData),c("openPictureImport",e.openPictureImport),c("projectReload",G),c("workspaceBindUnload",J),c("workspaceUnbindUnload",K),c("startTutorial",I),c("exportObject",D),c("openProjectModal",B),c("openImportListModal",N),c("openExportListModal",(function(e,t){return function(e,t){new entrylms.Modal([{type:"LIST_EXPORT",theme:"BLUE",content:e}]).on("click",(function(e,r){switch(e){case"copied":entrylms.alert(Lang.Menus.content_copied);break;case"excel":var n="",o='<input type="hidden" name="_csrf" value="'.concat(document.querySelector('meta[name="csrf-token"]').getAttribute("content"),'" />'),a='<input type="hidden" name="name" value="'.concat(t,'" />');_.forEach(r,(function(e){n+='<input type="hidden" name="list" value="'.concat(e,'" />')})),$('<form action="/api/commons/excel" method="post">'.concat(n).concat(o).concat(a,"</form>")).appendTo("body").submit().remove()}})).show()}(e,t)})),Entry.creationChangedEvent||(Entry.creationChangedEvent=new Entry.Event(window)),Entry.creationChangedEvent.attach(this,q),c("doPopupControl",e.doPopupControl),c("removeLocalStorage",U),C&&c("saveLocalStorageProject",O),t.$broadcast("workspaceControllerInited"),t.$on("attemptLogin",(function(){e._restoreFromNotAuth&&(K(!0),Q({restoreForce:!0}))}))},e.hwChanged=function(){var e=Entry.hw;if(!(e.connected&&e.hwModule&&E===e.hwModule.name||!EntryStatic.isPracticalCourse)){var t=Entry.playground.blockMenu;if(e.connected&&e.hwModule){var r=e.hwModule.name;_.contains(EntryStatic.hwMiniSupportList,r)?(P.forEach((function(e){t.unbanCategory(e)})),t.banCategory("arduino"),t.banCategory("hw_robot")):(P.forEach((function(e){t.banCategory(e)})),t.banCategory("hw_robot"),t.unbanCategory("arduino")),E=r}else P.forEach((function(e){t.banCategory(e)})),t.banCategory("arduino"),t.unbanCategory("hw_robot"),E=void 0}},e.injectWorkspace=function(){e.getWorkspace()},e.getWorkspace=function(){e.confirmed=!1;var t=S.getItem(j),r=S.getItem(L),n=g.user&&g.user._id;!r&&n&&(r=S.getItem(n)),t?G(JSON.parse(t)):r?function(t,r){e.tempProject=t,r?(x(),S.removeItem("lang"),oe()):e.global.getUserId()&&/"restoreForce"\s*:\s*true/.test(t)?oe():ne("projectLoadController"),U()}(r,S.getItem("lang")):M()},e.doPopupControl=function(t){if(t)switch(t.type){case"spinner":var r=ne("workspaceSpinner");r&&$(r).find(".workspaceSpinnerTitle").text(t.msg);break;case"fail":var n=ne("workspaceFailed");n&&$(n).find(".workspaceFailedTitle").html(t.msg);break;case"hide":e.popupHelper.hide()}},e.hwDownload=function(e){if("hardware"===e){var t=navigator.platform;u.get("/api/admin/getListForApps?rows=1&category=hardware").success((function(e){var r=(e[0]||{}).apps;if(r){var n;(n="MacIntel"===t?r.darwin:r.win32_x86)&&W("https://www.playentry.org/apps/".concat(n.filename))}}))}else"manual"===e?EntryStatic.isPracticalCourse?W("https://www.playentry.org/data/%5B%EB%A7%A4%EB%89%B4%EC%96%BC%5D%EC%97%94%ED%8A%B8%EB%A6%AC%EB%A1%9C%EB%B4%87%EC%97%B0%EA%B2%B0.zip"):W("https://www.playentry.org/data/hardware_manual.zip"):"ino"===e&&W("https://github.com/entrylabs/entry-hw/releases/download/v1.6.10/board.ino")},e.saveWorkspace=function(t){if(!e.isSaving)return g.user&&g.user._id||"export"===t?void(Entry.playground.painter.file.modified?entrylms.confirm(Lang.Workspace.SaveWithPicture).then((function(e){!0===e?Entry.playground.painter.file_save({cmd:"save",tag:t}):R(t)})):R(t)):$.event.trigger({type:"showLogin"})},e.saveAsWorkspace=function(){e.project&&e.project._id?Entry.playground.painter.file.modified?entrylms.confirm(Lang.Workspace.SaveWithPicture).then((function(e){!0===e?Entry.playground.painter.file_save({cmd:"saveas"}):F()})):F():e.saveWorkspace()},e.openSpriteManager=function(){if(!Entry.engine.isState("stop"))return entrylms.alert(Lang.Workspace.cannot_add_object),!1;c.open({templateUrl:"/views/workspace/modal/sprite.html",controller:"SpriteController",backdrop:!1,keyboard:!1,resolve:{parent:function(){return"workspace"}}}).result.then((function(e){var t=e.target;if("newSprite"===t){var r={id:Entry.generateHash(),objectType:"sprite",sprite:{}};r.sprite.name=Lang.Workspace.new_object+(Entry.container.getAllObjects().length+1),r.sprite.pictures=[],r.sprite.pictures.push({dimension:{width:960,height:540},fileurl:"".concat(Entry.mediaFilePath,"_1x1.png"),name:Lang.Painter.new_picture,type:"_system_"}),r.sprite.sounds=[],r.sprite.category={},r.sprite.category.main="new",r=Entry.container.addObject(r,0),Entry.playground.changeViewMode("picture")}else if("sprite"===t)e.data.forEach((function(e){var t={id:Entry.generateHash(),objectType:"sprite",sprite:V(e)};t=Entry.container.addObject(t,0)}));else if("upload"===t)e.data.forEach((function(e){if("sprite"in e){var t=e.sprite,r=t.objects,n=t.functions,o=t.messages,a=t.variables;if(!(Entry.getMainWS().mode!==Entry.Workspace.MODE_VIMBOARD||Entry.TextCodingUtil.canUsePythonVariables(a)&&Entry.TextCodingUtil.canUsePythonFunctions(n)))return entrylms.alert(Lang.Menus.object_import_syntax_error);var s={};a.forEach((function(e){var t=e.object;if(t){var r=e.id,n=s[t];e.id=Entry.generateHash(),n?(e.object=n.objectId,n.variableOriginId.push(r),n.variableId.push(e.id)):(e.object=Entry.generateHash(),s[t]={objectId:e.object,variableOriginId:[r],variableId:[e.id]})}})),Entry.variableContainer.appendMessages(o),Entry.variableContainer.appendVariables(a),Entry.variableContainer.appendFunctions(n),r.forEach((function(t){var r=s[t.id];if(r){newId=r.objectId;var n=t.script;r.variableOriginId.forEach((function(e,t){var o=new RegExp(e,"gi");n=n.replace(o,r.variableId[t])})),t.script=n,t.id=r.objectId}else Entry.container.getObject(t.id)&&(t.id=Entry.generateHash());if("textBox"===e.objectType){var o=e.text?e.text:Lang.Blocks.TEXT,a=e.options;t.objectType="textBox",i(t,{text:o,options:a,name:Lang.Workspace.textbox})}else t.objectType="sprite";Entry.container.addObject(t,0)}))}else{e.id||(e.id=Entry.generateHash());var c={id:Entry.generateHash(),objectType:"sprite",sprite:{name:e.name,pictures:[e],sounds:[],category:{}}};Entry.container.addObject(c,0)}}));else if("textBox"===t){var n=e.data?e.data:Lang.Blocks.TEXT,o=e.options,a={id:Entry.generateHash(),name:Lang.Workspace.textbox,text:n,options:o,objectType:"textBox",sprite:{sounds:[],pictures:[]}};Entry.container.addObject(a,0)}else console.log("no sprite found")}))},e.openPictureManager=function(){if(!Entry.engine.isState("stop"))return entrylms.alert(Lang.Workspace.cannot_add_picture),!1;c.open({templateUrl:"../views/workspace/modal/picture.html",controller:"PictureController",backdrop:!1,keyboard:!1,resolve:{parent:function(){return"workspace"}}}).result.then((function(e){var t=e.target;if("new"===t){var r={id:Entry.generateHash(),dimension:{height:1,width:1},fileurl:"".concat(Entry.mediaFilePath,"_1x1.png"),name:Lang.Painter.new_picture};Entry.playground.addPicture(r,!0)}else"system"===t?e.data.forEach((function(e){e.id=Entry.generateHash(),e.name=d("nameFilter")(e),Entry.playground.addPicture(e,!0)})):e.data.forEach((function(e){e.id=Entry.generateHash(),Entry.playground.addPicture(e,!0)}))}))},e.openSoundManager=function(){if(!Entry.engine.isState("stop"))return entrylms.alert(Lang.Workspace.cannot_add_sound_in_run),!1;c.open({templateUrl:"../views/workspace/modal/sound.html",controller:"SoundController",backdrop:!1,keyboard:!1,resolve:{parent:function(){return"workspace"}}}).result.then((function(e){e.data.forEach((function(e){e.id=Entry.generateHash(),Entry.playground.addSound(e,!0,!0)}))}))},e.openExpansionBlockManager=function(){c.open({templateUrl:"../views/workspace/modal/expansion_block.html",controller:"ExpansionBlockController",backdrop:!1,keyboard:!1,resolve:{parent:function(){return"workspace"}}}).result.then((function(e){e.data.forEach((function(e){e.id=Entry.generateHash(),Entry.playground.addExpansionBlock(e,!0,!0)}))}))},e.saveCanvasData=function(t){if(e.isSavingCanvasData)entrylms.alert(Lang.Msgs.save_canvas_alert);else{e.isSavingCanvasData=!0;var r=t.file,n=new FormData;n.append("data",t.image),$.ajax({url:"/rest/picture/canvas",data:n,cache:!1,contentType:!1,processData:!1,type:"POST",headers:{"csrf-token":g.csrfToken()},success:function(t){var n=Entry.playground,o=Entry.container;"new"===r.mode?(t.name=Lang.Painter.new_picture,n.addPicture(t,!0)):(t.id=r.id,t.name=r.name,t.objectId=r.objectId,n.setPicture(t));var a=new Image,i=t.filename;a.onload=function(){var r=n.object.entity.id;if(t.objectId){var i=o.getObject(t.objectId);i&&i.entity&&(r=i.entity.id)}o.cachePicture(t.id+r,a),n.painter.file.id===t.id?n.selectPicture(t):n.object&&t.objectId!==n.object.id&&o.selectPicture(t.id,t.objectId),e.isSavingCanvasData=!1},a.src="/uploads/".concat(i.substring(0,2),"/").concat(i.substring(2,4),"/image/").concat(i,".png")},error:function(t){console.log("error data:",t),e.isSavingCanvasData=!1}}).always((function(){e.isSavingCanvasData=!1}))}},e.openPictureImport=function(){c.open({templateUrl:"../views/workspace/modal/picture_import.html",controller:"PictureImportController",backdrop:!1,keyboard:!1}).result.then((function(e){e.data.forEach((function(e){e.id=Entry.generateHash(),Entry.dispatchEvent("pictureImport",e)}))}))};var V=function(e){if(e.name=d("nameFilter")(e),e.pictures&&e.pictures.length>0)for(var t=0,r=e.pictures.length;t<r;t++)e.pictures[t].name=d("nameFilter")(e.pictures[t]);if(e.sounds&&e.sounds.length>0)for(var n=0,o=e.sounds.length;n<o;n++)e.sounds[n].name=d("nameFilter")(e.sounds[n]);return e},H=function(e){if(e.name=d("nameFilter")(e),e.sprite){if(e.sprite.pictures&&e.sprite.pictures.length>0)for(var t=0,r=e.sprite.pictures.length;t<r;t++)e.sprite.pictures[t].name=d("nameFilter")(e.sprite.pictures[t]);if(e.sprite.sounds&&e.sprite.sounds.length>0)for(var n=0,o=e.sprite.sounds.length;n<o;n++)e.sprite.sounds[n].name=d("nameFilter")(e.sprite.sounds[n])}return e};function q(e){if(C){if(void 0===e)return O(!1);var t=Entry.engine;t&&t.isState("run")||(!k&&J(),Q())}}function Q(t){var r=Entry.exportProject({});if(r){r.name=g.htmlencode($("#project_name").val());var n=e.project;n&&(r.parent=n.parent,r._id=n._id);var o=g.getUserId();r.user=o,t&&"object"===a(t)||(t={}),_.extend(r,t),S.setItem(o||L,JSON.stringify(r))}}function z(e){e=g.htmldecode(e);var t=document.getElementById("project_name");t?t.value=e:setTimeout((function(){z(e)}),500)}function Y(){delete e.project._id,delete e.project.created,delete e.project.updated,delete e.project.comment,delete e.project.like,delete e.project.shortenUrl,delete e.project.staffPicked,delete e.project.commentGroup,delete e.project.likeCnt,delete e.project.likeCntGroup,delete e.project.visit,delete e.project.visitGroup,delete e.project.group,delete e.project.shortenUrlGroup,delete e.project.childCnt,delete e.project.recent,delete e.project.recentGroup,delete e.project.favoritGroup,delete e.project.openArea,delete e.project.isForLecture}function J(e){k&&!e||(K(!0),k=!0,$(window).on("beforeunload",Z))}function K(e){(k||e)&&(k=!1,$(window).off("beforeunload",Z))}function X(){var e=document.getElementById("entryCanvas"),t=document.getElementById("tmpCanvas");t||(t=document.createElement("canvas"));var r=t.getContext("2d");return r.width=313,r.height=176,r.drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),t.toDataURL("image/png").replace(/^data:image\/\w+;base64,/,"")}e.loadGuide=function(){var e,t;q(!0),C=!1,!0===EntryStatic.isPracticalCourse?(e="5a13d9a4ce153b11457ec019",t="purpleWS"):(e="5a13c5998e5d983cdd0e1aa9",t="blueWS","jp"===lang&&(e="5bb30a70901f6f7b1610c2d9")),u.get("/api/lecture/detail/".concat(e)).success((function(e){if(e){var r=_.first(e.studies);r.asService=!0,r.isLastStudy=!0,r.isRestrictorCloseable=!0,entrylms.init({mode:"guide",target:"entrylms",data:r,theme:t}),entrylms.on("ExitStudy",(function(){K(!0),window.location.reload()}))}else console.log("no lecture found check db")}))};var Z=function(e){var t=Entry.getMainWS();if(t&&t.syncCode&&t.syncCode(),function(){var e=g.user||{};return!(!C||!(S.getItem(L)||e._id&&S.getItem(e._id)))}()){var r=Entry.creationChangedEvent;return r&&r.notify(!0),""}delete e.returnValue},ee=function(t,r){var n=(r=r||{}).tag,o=t.objects,a=e.project;o&&o.length&&a.objects.length===o.length?(a._id=t._id,u.post("/rest/project/thumbnail/".concat(t._id),{thumbnail:X()},{headers:{"csrf-token":g.csrfToken()}}).then((function(){U(),"export"===n?u.post("/project/pack",{projectId:t._id},{headers:{"api-token":window.accessToken}}).then((function(r){var n=(r.data||{}).tempId;e.doPopupControl({type:"hide"}),e.isSaving=!1;var o=encodeURIComponent(g.safeFilename(t.name));W("/project/download/".concat(n,"/").concat(o)),p.path(t._id)})).catch((function(){entrylms.alert(Lang.Msgs.error_occured),e.doPopupControl({type:"hide"}),e.isSaving=!1})):(p.path(t._id),e.doPopupControl({type:"hide"}),e.isSaving=!1),te(a.variables)&&u.post("/api/cloud/save",{variables:a.variables,projectId:a._id},{headers:{"csrf-token":g.csrfToken()}}).then((function(e){console.log("api/cloud then".concat(e))})).catch((function(e){console.log("api/cloud catch".concat(e))})),Entry.toast.success(Lang.Workspace.saved,"".concat(a.name," ").concat(Lang.Workspace.saved_msg))}),(function(){entrylms.alert(Lang.Msgs.error_occured),e.doPopupControl({type:"hide"}),e.isSaving=!1})),Entry.getMainWS().setMode(Entry.Workspace.MODE_BOARD,void 0,!0)):entrylms.alert(Lang.Msgs.error_occured)},te=function(e){return e.map((function(e){return e.isCloud||e.isCloud_})).some((function(e,t,r){return 1==e}))},re=function(t){t=t||{},e.doPopupControl({type:"hide"}),e.isSaving=!1,403===t.status?entrylms.alert(Lang.Msgs.error_forbidden):entrylms.alert(t.customMessage||Lang.Msgs.error_occured)};function ne(t){var r=e.popupHelper;return r||(e.popupHelper=window.popupHelper||new Entry.popupHelper(!0),r=e.popupHelper),r.hasPopup(t)||r.addPopup(t,function(t){return{projectLoadController:{type:"confirm",title:Lang.Workspace.confirm_load_header,setPopupLayout:function(t){var r=Entry.Dom("div",{class:"contentArea"}),n=Entry.Dom("div",{class:"projectLoadText",parent:r}),o=Entry.Dom("div",{classes:["projectLoadCancelBtn","projectLoadButton"],parent:r}),a=Entry.Dom("div",{classes:["projectLoadOkBtn","projectLoadButton"],parent:r});n.text(Lang.Workspace.confirm_load_temporary),o.text(Lang.Buttons.cancel),a.text(Lang.Buttons.save),r.bindOnClick(".projectLoadButton",(function(t){$(this).hasClass("projectLoadOkBtn")?(x(),oe(),e.global.getUserId()||(e._restoreFromNotAuth=!0)):(e.confirmed=!1,M()),e.popupHelper.remove("projectLoadController")})),t.append(r)},closeEvent:function(t){e.confirmed=!1,M(),e.popupHelper.remove("projectLoadController")}},workspaceSpinner:{type:"spinner",setPopupLayout:function(e){var t=Entry.Dom("div",{class:"contentArea"}),r=Entry.Dom("div",{class:"workspaceSpinnerTitle",parent:t}),n=Entry.Dom("div",{class:"workspaceSpinnerCircle",parent:t});Entry.Dom("div",{class:"inner1",parent:n}),Entry.Dom("div",{class:"inner2",parent:n}),Entry.Dom("div",{class:"inner3",parent:n}),Entry.Dom("div",{class:"workspaceSpinnerCharacter",parent:n}),r.text(Lang.Workspace.uploading_msg),e.append(t)}},workspaceFailed:{setPopupLayout:function(e){var t=Entry.Dom("div",{class:"contentArea"}),r=Entry.Dom("div",{class:"workspaceFailedTitle",parent:t}),n=Entry.Dom("div",{class:"workspaceFailedCloseBtn",parent:t}),o=Entry.Dom("div",{class:"workspaceFailedSubTitle",parent:t});r.html(Lang.Workspace.upload_fail_msg),o.html(Lang.Workspace.fail_contact_msg),n.bindOnClick(popupHelper.hide.bind(popupHelper)),e.append(t)}},practicalCourseNotice:{type:"normal",closeEvent:function(){e.practicalTooltip&&(e.practicalTooltip.dispose(),delete e.practicalTooltip),e.popupHelper.remove("practicalCourseNotice")},setPopupLayout:function(t){var r=Entry.Dom("div",{class:"contentArea"});Entry.Dom("div",{class:"contentText",parent:r}).html(Lang.Workspace.practical_course_desc),Entry.Dom("div",{class:"contentText2",parent:r}).html(Lang.Workspace.practical_course_desc2);var n=Entry.Dom("button",{class:"confirmBtn",parent:r});n.html(Lang.Workspace.follow),t.append(r),n.on("click",(function(){e.practicalTooltip&&(e.practicalTooltip.dispose(),delete e.practicalTooltip),e.popupHelper.remove("practicalCourseNotice"),e.loadGuide()}))}},"practicalCourseNotice workspaceTutorialPopup":{type:"normal",setPopupLayout:function(t){var r=Entry.Dom("div",{class:"contentArea"});Entry.Dom("div",{class:"contentText",parent:r}).html(Lang.Workspace.workspace_tutorial_popup_desc);var n=Entry.Dom("button",{class:"confirmBtn",parent:r});n.html(Lang.Workspace.follow),t.append(r),n.on("click",(function(){e.popupHelper.remove("practicalCourseNotice workspaceTutorialPopup"),e.loadGuide()}))}}}[t]}(t)),r.show(t),(r.popupList||[])[t]}function oe(t){e.confirmed=!0,t?Entry.clearProject():t=$.parseJSON(e.tempProject),e.project=new h(t),Entry.loadProject(e.project),z(t.name)}}])},664:function(t,r){angular.module("mean.workspace").controller("HeaderController",["$scope","$rootScope","$window","Global","$uibModal","$http","$location","$cookies","$route","myProject","Projects","BugReporter",function(t,r,n,o,a,i,s,c,u,p,l,d){t.global=o,t.programmingMode=o.programmingMode||0,t.PracticalModeName="",void 0===g||window.JSON;var g=void 0===window.localStorage?void 0:window.localStorage,f=null,m=!1;function h(){f&&f.destroy();var e=Entry.getMainWS();e&&e.changeEvent?(f=e.changeEvent.attach(this,t.changeProgrammingMode),m=!0,t.changeProgrammingMode(),m=!1):setTimeout((function(){h()}),250)}t.programmingModeLang=[Lang.Menus.block_coding,Lang.Menus.python_coding],Entry.Vim.MAZE_MODE=1,Entry.Vim.WORKSPACE_MODE=2,Entry.Workspace.MODE_BOARD=0,Entry.Workspace.MODE_VIMBOARD=1,Entry.Workspace.MODE_OVERLAYBOARD=2,Entry.Vim.TEXT_TYPE_JS=0,Entry.Vim.TEXT_TYPE_PY=1,t.init=function(){t.PracticalModeName=p.modeName,t.PracticalMode=p.mode,t.isPracticalCourse=EntryStatic.isPracticalCourse,$(".uib-dropdown-menu").find("form").click((function(e){e.stopPropagation()})),r.$on("projectLoaded",(function(e,t){p.id=t.id})),r.$on("workspaceControllerInited",(function(e,t){h()})),r.$on("modeChange",(function(e,r){t.PracticalModeName=r.modeName,t.PracticalMode=r.mode})),t.global.user||(t.global.user={}),t.global.user.language=window.lang||"ko",t.language=window.lang||"ko",t.device=window.platform.type?"tablet":null,$(".page-header").find("a").on("touchstart",(function(t){var r=$(this);if(r.attr("class").indexOf("uib-dropdown-toggle")>-1)"none"!=r.next("ul.uib-dropdown-menu").css("display")?r.next("ul.uib-dropdown-menu").css("display","none"):r.next("ul.uib-dropdown-menu").css("display","block");else{var n=r.attr("href");n&&""!=n&&(window.location.href=r.attr("href"))}e.stopPropagation()})),h()},t.saveWorkspace=function(e){Entry.dispatchEvent("saveWorkspace",e)},t.saveAsWorkspace=function(){Entry.dispatchEvent("saveAsWorkspace")},t.showBlockHelper=function(){Entry.dispatchEvent("showBlockHelper")},t.stopPropagation=function(e){e.stopPropagation()},t.project=new l({}),t.loadWorkspace=function(){a.open({templateUrl:"../views/workspace/modal/load.html",controller:v,backdrop:!1,keyboard:!1}).result.then((function(e){}))};var v=function(e,t){e.projects=[],i({method:"GET",url:"/api/project/browse"}).success((function(t,r){e.projects=t})).error((function(t,r){e.status=r})),e.ok=function(e){t.close(e)},e.cancel=function(){t.dismiss("cancel")}};v.$inject=["$scope","$uibModalInstance"],t.blockHelperOn=function(){Entry.helper.blockHelperOn()},t.showLogin=function(e){$.event.trigger({type:"showLogin"})},t.signout=function(){o.resetUserWorkspace(),window.location.href="/out"},t.showPopup=function(e){var t=$("#"+e);$("body").eq(0).css("overflow","hidden"),t.css("display","block"),t.css("top",$(document).scrollTop()+"px")},t.hidePopup=function(e){var t=$("#"+e);$("body").eq(0).css("overflow","auto"),t.css("display","none")},t.sendBug=function(e){d.report.bind(t)(e,"workspace bug")},t.showSignUp=function(){$.event.trigger({type:"showSignUp"})},t.changeProgrammingMode=function(){var e=Number(Entry.getMainWS().mode);switch(e){case Entry.Workspace.MODE_BOARD:case Entry.Workspace.MODE_OVERLAYBOARD:e=Entry.Workspace.MODE_BOARD;break;case Entry.Workspace.MODE_VIMBOARD:e=Entry.Workspace.MODE_VIMBOARD,function(){var e=o.user;if(e&&e._id){var r=e.checkPopupList||[];_.includes(e.checkPopupList,"pythonManual")||(t.showPythonTooltip(),r.push("pythonManual"),i.post("/api/users/update",{checkPopupList:r},{headers:{"csrf-token":o.csrfToken()}}))}else{c.getObject("pythonManualSession")||(t.showPythonTooltip(),c.putObject("pythonManualSession",!0))}}()}t.programmingMode!==e&&(t.programmingMode=e,m||(t.$apply(),m=!1))},t.setMode=function(e){m=!0,t._setMode(e),m=!1},t._setMode=function(e){var t=e;e={},0==t?(e.boardType=Entry.Workspace.MODE_BOARD,e.textType=-1):1==t?(e.boardType=Entry.Workspace.MODE_VIMBOARD,e.textType=Entry.Vim.TEXT_TYPE_PY,e.runType=Entry.Vim.WORKSPACE_MODE):2==t&&(e.boardType=Entry.Workspace.MODE_VIMBOARD,e.textType=Entry.Vim.TEXT_TYPE_JS,e.runType=Entry.Vim.MAZE_MODE),Entry.getMainWS()&&Entry.getMainWS().setMode(e)},t.printws=function(){if(Entry.container.objects_.length){var e=Entry.exportProject();e.thumb=document.getElementById("entryCanvas").toDataURL("image/png"),e.name=$("#project_name").val(),e.id=p.id;var t="/wsprint#!/";e.id&&(t+=e.id),localStorage.setItem("wsPrintProject",JSON.stringify(e)),window.open(t,"_blank")}else alert(Lang.Workspace.add_object_alert_msg)},t.getHardwareGuide=function(){var e;e=EntryStatic.isPracticalCourse?"https://www.playentry.org/data/%5B%E1%84%86%E1%85%A2%E1%84%82%E1%85%B2%E1%84%8B%E1%85%A5%E1%86%AF%5D%E1%84%8B%E1%85%A6%E1%86%AB%E1%84%90%E1%85%B3%E1%84%85%E1%85%B5%E1%84%85%E1%85%A9%E1%84%87%E1%85%A9%E1%86%BA%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%80%E1%85%A7%E1%86%AF.zip":"https://www.playentry.org/data/%EC%97%94%ED%8A%B8%EB%A6%AC%20%ED%95%98%EB%93%9C%EC%9B%A8%EC%96%B4%20%EC%97%B0%EA%B2%B0%20%EB%A7%A4%EB%89%B4%EC%96%BC(%EC%98%A8%EB%9D%BC%EC%9D%B8%EC%9A%A9).zip",window.open(e,"download")},t.getPythonGuide=function(){window.open("https://www.playentry.org/data/Python.Guide.zip","download")},t.showPythonTooltip=function(){new Entry.Tooltip([{content:Lang.Workspace.textcoding_tooltip1,target:$(".workspaceModeSelector"),direction:"left",style:"edge_up"},{content:Lang.Workspace.textcoding_tooltip2,target:$(".propertyTabconsole"),direction:"right"},{content:Lang.Workspace.textcoding_tooltip3,target:$("#helpBtn"),direction:"down"}],{dimmed:!0})},t.getQueryParameters=function(e){var t=e||n.location.search;return t.length?t.replace(/(^\?)/,"").split("&").map(function(e){return this[(e=e.split("="))[0]]=e[1],this}.bind({}))[0]:{}},t.setWorkspaceMode=function(e){var r=t.getQueryParameters();if(EntryStatic.isPracticalCourse?"workspace"===e:"workspace"!==e){r.type=e;var o="?"+encodeURI($.param(r));n.location.search=o}},t.setLanguage=function(e){var r=t.getQueryParameters();r.lang=e,r.type=void 0,n.location.search="?"+encodeURI($.param(r))},t.setNewProject=function(){var e=t.getQueryParameters();n.location.href="/ws?"+encodeURI($.param(e))},t.goPath=function(e){n.location.href="/"+e},t.$watch("project.name",(function(e){p.setProjectName(e)}),!0),t.$watch("project.name",(function(e){p.setProjectName(e)}),!0),t.startTutorial=function(){Entry.dispatchEvent("startTutorial")},t.openProjectModal=function(){Entry.dispatchEvent("openProjectModal")}}]).directive("importProject",(function(){return{restrict:"A",link:function(e,t){t.bind("click",(function(e){if(Entry.stateManager.isSaved()){if("ios"===window.platform.name.toLowerCase())return alert(Lang.Menus.not_supported_function),$("body").click(),!1;angular.element(e.target).siblings("#inputImportProject").trigger("click")}else entrylms.confirm(Lang.Menus.save_dismiss).then((function(t){if(t){if("ios"===window.platform.name.toLowerCase())return alert(Lang.Menus.not_supported_function),$("body").click(),!1;angular.element(e.target).siblings("#inputImportProject").trigger("click")}}))}))}}})).directive("inputImportProject",["$http","$location","$window","Global",function(e,t,r,n){return{restrict:"A",link:function(n,o,a){o.bind("change",(function(){if(o.val())if(popupHelper.show("workspaceSpinner"),Entry.dispatchEvent("doPopupControl",{type:"spinner",msg:Lang.Workspace.uploading_msg}),-1==o.val().toLowerCase().indexOf(".ent"))Entry.dispatchEvent("doPopupControl",{type:"fail",msg:Lang.Workspace.upload_not_supported_msg});else{Entry.dispatchEvent("removeLocalStorage");var a=new FormData;a.append("projects",o[0].files[0]),e.post("/project/importProject",a,{transformRequest:angular.identity,headers:{"api-token":window.accessToken,"Content-Type":void 0}}).then((function(e){o.val(""),Entry.dispatchEvent("doPopupControl",{type:"hide"});var a=e.data;if(!EntryStatic.isPracticalCourse!=!a.isPracticalCourse){var i=r.location.protocol+"//"+r.location.host+r.location.pathname,s=n.getQueryParameters;s.type=a.isPracticalCourse?"practical_course":"workspace",i+="?"+encodeURI($.param(s)),a._id&&(i+="#!/"+a._id),localStorage.setItem("localStorageProjectReload",JSON.stringify(a)),r.location.href=i}else a._id?t.path(a._id):a&&!$.isEmptyObject(a)?(Entry.dispatchEvent("projectReload",a,!0),Entry.dispatchEvent("doPopupControl",{type:"hide"})):(Entry.dispatchEvent("doPopupControl",{type:"hide"}),Entry.dispatchEvent("doPopupControl",{type:"fail",msg:Lang.Workspace.upload_fail_msg}))})).catch((function(e){o.val(""),Entry.dispatchEvent("doPopupControl",{type:"hide"}),Entry.dispatchEvent("doPopupControl",{type:"fail",msg:Lang.Workspace.upload_fail_msg})}))}}))}}}])},666:function(e,t,r){"use strict";var n=r(8),o=r(510),a=r(667),i=r(516);function s(e){var t=new a(e),r=o(a.prototype.request,t);return n.extend(r,a.prototype,t),n.extend(r,t),r}var c=s(r(513));c.Axios=a,c.create=function(e){return s(i(c.defaults,e))},c.Cancel=r(517),c.CancelToken=r(680),c.isCancel=r(512),c.all=function(e){return Promise.all(e)},c.spread=r(681),e.exports=c,e.exports.default=c},667:function(e,t,r){"use strict";var n=r(8),o=r(511),a=r(668),i=r(669),s=r(516);function c(e){this.defaults=e,this.interceptors={request:new a,response:new a}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[i,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},c.prototype.getUri=function(e){return e=s(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,r){return this.request(n.merge(r||{},{method:e,url:t}))}})),n.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,r,o){return this.request(n.merge(o||{},{method:e,url:t,data:r}))}})),e.exports=c},668:function(e,t,r){"use strict";var n=r(8);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},669:function(e,t,r){"use strict";var n=r(8),o=r(670),a=r(512),i=r(513);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||i.adapter)(e).then((function(t){return s(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function(t){return a(t)||(s(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},670:function(e,t,r){"use strict";var n=r(8);e.exports=function(e,t,r){return n.forEach(r,(function(r){e=r(e,t)})),e}},671:function(e,t,r){"use strict";var n=r(8);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},672:function(e,t,r){"use strict";var n=r(515);e.exports=function(e,t,r){var o=r.config.validateStatus;!o||o(r.status)?e(r):t(n("Request failed with status code "+r.status,r.config,null,r.request,r))}},673:function(e,t,r){"use strict";e.exports=function(e,t,r,n,o){return e.config=t,r&&(e.code=r),e.request=n,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},674:function(e,t,r){"use strict";var n=r(675),o=r(676);e.exports=function(e,t){return e&&!n(t)?o(e,t):t}},675:function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},676:function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},677:function(e,t,r){"use strict";var n=r(8),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,a,i={};return e?(n.forEach(e.split("\n"),(function(e){if(a=e.indexOf(":"),t=n.trim(e.substr(0,a)).toLowerCase(),r=n.trim(e.substr(a+1)),t){if(i[t]&&o.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([r]):i[t]?i[t]+", "+r:r}})),i):i}},678:function(e,t,r){"use strict";var n=r(8);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function o(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=o(window.location.href),function(t){var r=n.isString(t)?o(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},679:function(e,t,r){"use strict";var n=r(8);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,o,a,i){var s=[];s.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(o)&&s.push("path="+o),n.isString(a)&&s.push("domain="+a),!0===i&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},680:function(e,t,r){"use strict";var n=r(517);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},681:function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},8:function(e,t,r){"use strict";var n=r(510),o=Object.prototype.toString;function a(e){return"[object Array]"===o.call(e)}function i(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===o.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),a(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:function(e){return null!==e&&!i(e)&&null!==e.constructor&&!i(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:i,isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]=r}for(var n=0,o=arguments.length;n<o;n++)u(arguments[n],r);return t},deepMerge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]="object"==typeof r?e({},r):r}for(var n=0,o=arguments.length;n<o;n++)u(arguments[n],r);return t},extend:function(e,t,r){return u(t,(function(t,o){e[o]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}}});